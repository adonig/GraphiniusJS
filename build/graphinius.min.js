!function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){(function(e){var n=r(1),i=r(2),s=r(4),o=r(13),a=r(18),u=r(19),h=r(20),p=r(7),l=r(9),c=r(11),d=r(10),f=r(21),g=r(3),y=r(17),v=r(8),m=r(49),_=r(12),b=r(50),x=r(51),E=r(52),w=r(53),S=r(54),k=r(55),N=r(57),T="undefined"!=typeof window?window:e;T.$G={core:{BaseEdge:n.BaseEdge,BaseNode:i.BaseNode,BaseGraph:s.BaseGraph,GraphMode:s.GraphMode},centralities:{Degree:E,Closeness:w,Betweenness:S,PageRankGauss:k,PageRankRandWalk:N},input:{CSVInput:o.CSVInput,JSONInput:u.JSONInput},output:{CSVOutput:a.CSVOutput,JSONOutput:h.JSONOutput},search:{BFS:p.BFS,prepareBFSStandardConfig:p.prepareBFSStandardConfig,DFS:l.DFS,DFSVisit:l.DFSVisit,prepareDFSStandardConfig:l.prepareDFSStandardConfig,prepareDFSVisitStandardConfig:l.prepareDFSVisitStandardConfig,PFS:c.PFS,preparePFSStandardConfig:c.preparePFSStandardConfig,BellmanFord:d,FloydWarshall:f},mincut:{MCMFBoykov:x.MCMFBoykov},utils:{struct:g,remote:y,callback:v,randgen:m},datastructs:{BinaryHeap:_.BinaryHeap},perturbation:{SimplePerturber:b.SimplePerturber}},t.exports=T.$G}).call(e,function(){return this}())},function(t,e,r){"use strict";var n=r(2),i=function(){function t(t,e,r,i){if(this._id=t,this._node_a=e,this._node_b=r,!(e instanceof n.BaseNode&&r instanceof n.BaseNode))throw new Error("cannot instantiate edge without two valid node objects");i=i||{},this._directed=i.directed||!1,this._weighted=i.weighted||!1,this._weight=this._weighted?isNaN(i.weight)?1:i.weight:void 0,this._label=i.label||this._id}return t.prototype.getID=function(){return this._id},t.prototype.getLabel=function(){return this._label},t.prototype.setLabel=function(t){this._label=t},t.prototype.isDirected=function(){return this._directed},t.prototype.isWeighted=function(){return this._weighted},t.prototype.getWeight=function(){return this._weight},t.prototype.setWeight=function(t){if(!this._weighted)throw new Error("Cannot set weight on unweighted edge.");this._weight=t},t.prototype.getNodes=function(){return{a:this._node_a,b:this._node_b}},t.prototype.clone=function(e,r){if(!(e instanceof n.BaseNode&&r instanceof n.BaseNode))throw new Error("refusing to clone edge if any new node is invalid");return new t(this._id,e,r,{directed:this._directed,weighted:this._weighted,weight:this._weight,label:this._label})},t}();e.BaseEdge=i},function(t,e,r){"use strict";var n=r(3),i=function(){function t(t,e){this._id=t,this._in_degree=0,this._out_degree=0,this._und_degree=0,this._in_edges={},this._out_edges={},this._und_edges={},this._features="undefined"!=typeof e?n.clone(e):{},this._label=this._features.label||this._id}return t.prototype.getID=function(){return this._id},t.prototype.getLabel=function(){return this._label},t.prototype.setLabel=function(t){this._label=t},t.prototype.getFeatures=function(){return this._features},t.prototype.getFeature=function(t){return this._features[t]},t.prototype.setFeatures=function(t){this._features=n.clone(t)},t.prototype.setFeature=function(t,e){this._features[t]=e},t.prototype.deleteFeature=function(t){var e=this._features[t];return delete this._features[t],e},t.prototype.clearFeatures=function(){this._features={}},t.prototype.inDegree=function(){return this._in_degree},t.prototype.outDegree=function(){return this._out_degree},t.prototype.degree=function(){return this._und_degree},t.prototype.addEdge=function(t){var e=t.getNodes();if(e.a!==this&&e.b!==this)throw new Error("Cannot add edge that does not connect to this node");var r=t.getID();if(t.isDirected())e.a!==this||this._out_edges[r]?this._in_edges[r]||(this._in_edges[t.getID()]=t,this._in_degree+=1):(this._out_edges[r]=t,this._out_degree+=1,e.b!==this||this._in_edges[r]||(this._in_edges[t.getID()]=t,this._in_degree+=1));else{if(this._und_edges[t.getID()])throw new Error("Cannot add same undirected edge multiple times.");this._und_edges[t.getID()]=t,this._und_degree+=1}},t.prototype.hasEdge=function(t){return!!this._in_edges[t.getID()]||!!this._out_edges[t.getID()]||!!this._und_edges[t.getID()]},t.prototype.hasEdgeID=function(t){return!!this._in_edges[t]||!!this._out_edges[t]||!!this._und_edges[t]},t.prototype.getEdge=function(t){var e=this._in_edges[t]||this._out_edges[t]||this._und_edges[t];if(!e)throw new Error("Cannot retrieve non-existing edge.");return e},t.prototype.inEdges=function(){return this._in_edges},t.prototype.outEdges=function(){return this._out_edges},t.prototype.undEdges=function(){return this._und_edges},t.prototype.dirEdges=function(){return n.mergeObjects([this._in_edges,this._out_edges])},t.prototype.allEdges=function(){return n.mergeObjects([this._in_edges,this._out_edges,this._und_edges])},t.prototype.removeEdge=function(t){if(!this.hasEdge(t))throw new Error("Cannot remove unconnected edge.");var e=t.getID(),r=this._und_edges[e];r&&(delete this._und_edges[e],this._und_degree-=1),r=this._in_edges[e],r&&(delete this._in_edges[e],this._in_degree-=1),r=this._out_edges[e],r&&(delete this._out_edges[e],this._out_degree-=1)},t.prototype.removeEdgeID=function(t){if(!this.hasEdgeID(t))throw new Error("Cannot remove unconnected edge.");var e=this._und_edges[t];e&&(delete this._und_edges[t],this._und_degree-=1),e=this._in_edges[t],e&&(delete this._in_edges[t],this._in_degree-=1),e=this._out_edges[t],e&&(delete this._out_edges[t],this._out_degree-=1)},t.prototype.clearOutEdges=function(){this._out_edges={},this._out_degree=0},t.prototype.clearInEdges=function(){this._in_edges={},this._in_degree=0},t.prototype.clearUndEdges=function(){this._und_edges={},this._und_degree=0},t.prototype.clearEdges=function(){this.clearInEdges(),this.clearOutEdges(),this.clearUndEdges()},t.prototype.prevNodes=function(){var t,e,r=[];for(t in this._in_edges)this._in_edges.hasOwnProperty(t)&&(e=this._in_edges[t],r.push({node:e.getNodes().a,edge:e}));return r},t.prototype.nextNodes=function(){var t,e,r=[];for(t in this._out_edges)this._out_edges.hasOwnProperty(t)&&(e=this._out_edges[t],r.push({node:e.getNodes().b,edge:e}));return r},t.prototype.connNodes=function(){var t,e,r=[];for(t in this._und_edges)if(this._und_edges.hasOwnProperty(t)){e=this._und_edges[t];var n=e.getNodes();n.a===this?r.push({node:e.getNodes().b,edge:e}):r.push({node:e.getNodes().a,edge:e})}return r},t.prototype.reachNodes=function(t){var e=0;return n.mergeArrays([this.nextNodes(),this.connNodes()],t||function(t){return e++})},t.prototype.clone=function(){var e=new t(this._id);return e.setFeatures(this.getFeatures()),e},t}();e.BaseNode=i},function(t,e,r){"use strict";function n(t){if(null===t||"object"!=typeof t)return t;if(!(t instanceof u.BaseNode||t instanceof h.BaseEdge)){var e=t.constructor?t.constructor():{};for(var r in t)t.hasOwnProperty(r)&&("object"==typeof t[r]?e[r]=n(t[r]):e[r]=t[r]);return e}}function i(t,e){void 0===e&&(e=void 0);for(var r in t)if(!Array.isArray(t[r]))throw new Error("Will only mergeArrays arrays");for(var n,i={},s=[],o=0;o<t.length;o++)for(var a=0;a<t[o].length;a++)n="undefined"!=typeof e?e(t[o][a]):t[o][a],i[n]!==!0&&(s.push(t[o][a]),i[n]=!0);return s}function s(t){for(var e=0;e<t.length;e++)if("[object Object]"!==Object.prototype.toString.call(t[e]))throw new Error("Will only take objects as inputs");for(var r={},e=0;e<t.length;e++)for(var n in t[e])t[e].hasOwnProperty(n)&&(r[n]=t[e][n]);return r}function o(t,e){for(var r in t)if(t.hasOwnProperty(r)&&e(t[r]))return r}function a(t,e){var r=[],n=0,i=0;if(null!=t[0]&&null!=e[0])for(;;){if(n>=t.length||i>=e.length)break;t[n]!=e[i]?t[n]<e[i]?(r.push(t[n]),n++):e[i]<t[n]&&(r.push(e[i]),i++):(r[r.length-1]!=t[n]&&r.push(t[n]),n++,i++)}for(;n<t.length;)null!=t[n]&&r.push(t[n]),n++;for(;i<e.length;)null!=e[i]&&r.push(e[i]),i++;return r}var u=r(2),h=r(1);e.clone=n,e.mergeArrays=i,e.mergeObjects=s,e.findKey=o,e.mergeOrderedArraysNoDups=a},function(t,e,r){"use strict";var n=r(2),i=r(1),s=r(3),o=r(5),a=r(7),u=r(9),h=r(10),p=(new o.Logger,1);!function(t){t[t.INIT=0]="INIT",t[t.DIRECTED=1]="DIRECTED",t[t.UNDIRECTED=2]="UNDIRECTED",t[t.MIXED=3]="MIXED"}(e.GraphMode||(e.GraphMode={}));var l=e.GraphMode,c=function(){function t(t){this._label=t,this._nr_nodes=0,this._nr_dir_edges=0,this._nr_und_edges=0,this._mode=l.INIT,this._nodes={},this._dir_edges={},this._und_edges={}}return t.prototype.toDirectedGraph=function(){return this},t.prototype.toUndirectedGraph=function(){return this},t.prototype.hasNegativeEdge=function(){var t,e=!1;for(var r in this._und_edges)if(t=this._und_edges[r],t.isWeighted()&&t.getWeight()<0)return!0;for(var r in this._dir_edges)if(t=this._dir_edges[r],t.isWeighted()&&t.getWeight()<0){e=!0;break}return e},t.prototype.hasNegativeCycles=function(t){var e=this;if(!this.hasNegativeEdge())return!1;var r=!1,n=t?t:this.getRandomNode();return u.DFS(this,n).forEach(function(t){var n,i=Number.POSITIVE_INFINITY;Object.keys(t).forEach(function(e){i>t[e].counter&&(i=t[e].counter,n=e)}),h.BellmanFordArray(e,e._nodes[n]).neg_cycle&&(r=!0)}),r},t.prototype.nextArray=function(t){void 0===t&&(t=!1);for(var e=[],r=Object.keys(this._nodes),n=this.adjListDict(t,!0,0),i=0;i<this._nr_nodes;++i){e.push([]);for(var s=0;s<this._nr_nodes;++s)e[i].push([]),e[i][s].push(i===s?s:isFinite(n[r[i]][r[s]])?s:null)}return e},t.prototype.adjListArray=function(t){void 0===t&&(t=!1);for(var e=[],r=Object.keys(this._nodes),n=this.adjListDict(t,!0,0),i=0;i<this._nr_nodes;++i){e.push([]);for(var s=0;s<this._nr_nodes;++s)e[i].push(i===s?0:isFinite(n[r[i]][r[s]])?n[r[i]][r[s]]:Number.POSITIVE_INFINITY)}return e},t.prototype.adjListDict=function(t,e,r){void 0===t&&(t=!1),void 0===e&&(e=!1),void 0===r&&(r=0);var n,i,s,o={},a=this.getNodes();for(i in a)o[i]={},e&&(o[i][i]=r);for(i in a){var u=t?a[i].reachNodes().concat(a[i].prevNodes()):a[i].reachNodes();u.forEach(function(e){n=o[i][e.node.getID()]||Number.POSITIVE_INFINITY,s=isNaN(e.edge.getWeight())?p:e.edge.getWeight(),s<n?(o[i][e.node.getID()]=s,t&&(o[e.node.getID()][i]=s)):(o[i][e.node.getID()]=n,t&&(o[e.node.getID()][i]=n))})}return o},t.prototype.getMode=function(){return this._mode},t.prototype.getStats=function(){return{mode:this._mode,nr_nodes:this._nr_nodes,nr_und_edges:this._nr_und_edges,nr_dir_edges:this._nr_dir_edges,density_dir:this._nr_dir_edges/(this._nr_nodes*(this._nr_nodes-1)),density_und:2*this._nr_und_edges/(this._nr_nodes*(this._nr_nodes-1))}},t.prototype.degreeDistribution=function(){var t,e,r,n=0;for(t in this._nodes)e=this._nodes[t],r=e.inDegree()+e.outDegree()+e.degree()+1,n=r>n?r:n;var i={"in":new Uint16Array(n),out:new Uint16Array(n),dir:new Uint16Array(n),und:new Uint16Array(n),all:new Uint16Array(n)};for(t in this._nodes)e=this._nodes[t],i["in"][e.inDegree()]++,i.out[e.outDegree()]++,i.dir[e.inDegree()+e.outDegree()]++,i.und[e.degree()]++,i.all[e.inDegree()+e.outDegree()+e.degree()]++;return i},t.prototype.nrNodes=function(){return this._nr_nodes},t.prototype.nrDirEdges=function(){return this._nr_dir_edges},t.prototype.nrUndEdges=function(){return this._nr_und_edges},t.prototype.addNodeByID=function(t,e){var r=new n.BaseNode(t,e);return this.addNode(r)?r:null},t.prototype.addNode=function(t){return this._nodes[t.getID()]=t,this._nr_nodes+=1,!0},t.prototype.cloneAndAddNode=function(t){var e=new n.BaseNode(t.getID());return e.setFeatures(s.clone(t.getFeatures())),this._nodes[t.getID()]=e,this._nr_nodes+=1,e},t.prototype.hasNodeID=function(t){return!!this._nodes[t]},t.prototype.getNodeById=function(t){return this._nodes[t]},t.prototype.getNodes=function(){return this._nodes},t.prototype.getRandomNode=function(){return this.pickRandomProperty(this._nodes)},t.prototype.deleteNode=function(t){var e=this._nodes[t.getID()];if(!e)throw new Error("Cannot remove un-added node.");var r=t.inDegree(),n=t.outDegree(),i=t.degree();r&&this.deleteInEdgesOf(t),n&&this.deleteOutEdgesOf(t),i&&this.deleteUndEdgesOf(t),delete this._nodes[t.getID()],this._nr_nodes-=1},t.prototype.hasEdgeID=function(t){return!!this._dir_edges[t]||!!this._und_edges[t]},t.prototype.getEdgeById=function(t){var e=this._dir_edges[t]||this._und_edges[t];if(!e)throw new Error("cannot retrieve edge with non-existing ID.");return e},t.prototype.checkExistanceOfEdgeNodes=function(t,e){if(!t)throw new Error("Cannot find edge. Node A does not exist (in graph).");if(!e)throw new Error("Cannot find edge. Node B does not exist (in graph).")},t.prototype.getDirEdgeByNodeIDs=function(t,e){var r=this.getNodeById(t),n=this.getNodeById(e);this.checkExistanceOfEdgeNodes(r,n);for(var i=r.outEdges(),s=Object.keys(i),o=0;o<s.length;o++){var a=i[s[o]];if(a.getNodes().b.getID()==e)return a}throw new Error("Cannot find edge. There is no edge between Node "+t+" and "+e+".")},t.prototype.getUndEdgeByNodeIDs=function(t,e){var r=this.getNodeById(t),n=this.getNodeById(e);this.checkExistanceOfEdgeNodes(r,n);for(var i=r.undEdges(),s=Object.keys(i),o=0;o<s.length;o++){var a,u=i[s[o]];if(a=u.getNodes().a.getID()==t?u.getNodes().b.getID():u.getNodes().a.getID(),a==e)return u}},t.prototype.getDirEdges=function(){return this._dir_edges},t.prototype.getUndEdges=function(){return this._und_edges},t.prototype.getDirEdgesArray=function(){var t=[];for(var e in this._dir_edges)t.push(this._dir_edges[e]);return t},t.prototype.getUndEdgesArray=function(){var t=[];for(var e in this._und_edges)t.push(this._und_edges[e]);return t},t.prototype.addEdgeByNodeIDs=function(t,e,r,n){var i=this.getNodeById(e),s=this.getNodeById(r);if(i){if(s)return this.addEdgeByID(t,i,s,n);throw new Error("Cannot add edge. Node B does not exist")}throw new Error("Cannot add edge. Node A does not exist")},t.prototype.addEdgeByID=function(t,e,r,n){var s=new i.BaseEdge(t,e,r,n||{});return this.addEdge(s)},t.prototype.addEdge=function(t){var e=t.getNodes().a,r=t.getNodes().b;if(!this.hasNodeID(e.getID())||!this.hasNodeID(r.getID())||this._nodes[e.getID()]!==e||this._nodes[r.getID()]!==r)throw new Error("can only add edge between two nodes existing in graph");return e.addEdge(t),t.isDirected()?(r.addEdge(t),this._dir_edges[t.getID()]=t,this._nr_dir_edges+=1,this.updateGraphMode()):(e!==r&&r.addEdge(t),this._und_edges[t.getID()]=t,this._nr_und_edges+=1,this.updateGraphMode()),t},t.prototype.deleteEdge=function(t){var e=this._dir_edges[t.getID()],r=this._und_edges[t.getID()];if(!e&&!r)throw new Error("cannot remove non-existing edge.");var n=t.getNodes();n.a.removeEdge(t),n.a!==n.b&&n.b.removeEdge(t),e?(delete this._dir_edges[t.getID()],this._nr_dir_edges-=1):(delete this._und_edges[t.getID()],this._nr_und_edges-=1),this.updateGraphMode()},t.prototype.deleteInEdgesOf=function(t){this.checkConnectedNodeOrThrow(t);var e,r,n=t.inEdges();for(e in n)r=n[e],r.getNodes().a.removeEdge(r),delete this._dir_edges[r.getID()],this._nr_dir_edges-=1;t.clearInEdges(),this.updateGraphMode()},t.prototype.deleteOutEdgesOf=function(t){this.checkConnectedNodeOrThrow(t);var e,r,n=t.outEdges();for(e in n)r=n[e],r.getNodes().b.removeEdge(r),delete this._dir_edges[r.getID()],this._nr_dir_edges-=1;t.clearOutEdges(),this.updateGraphMode()},t.prototype.deleteDirEdgesOf=function(t){this.deleteInEdgesOf(t),this.deleteOutEdgesOf(t)},t.prototype.deleteUndEdgesOf=function(t){this.checkConnectedNodeOrThrow(t);var e,r,n=t.undEdges();for(e in n){r=n[e];var i=r.getNodes();i.a.removeEdge(r),i.a!==i.b&&i.b.removeEdge(r),delete this._und_edges[r.getID()],this._nr_und_edges-=1}t.clearUndEdges(),this.updateGraphMode()},t.prototype.deleteAllEdgesOf=function(t){this.deleteDirEdgesOf(t),this.deleteUndEdgesOf(t)},t.prototype.clearAllDirEdges=function(){for(var t in this._dir_edges)this.deleteEdge(this._dir_edges[t])},t.prototype.clearAllUndEdges=function(){for(var t in this._und_edges)this.deleteEdge(this._und_edges[t])},t.prototype.clearAllEdges=function(){this.clearAllDirEdges(),this.clearAllUndEdges()},t.prototype.getRandomDirEdge=function(){return this.pickRandomProperty(this._dir_edges)},t.prototype.getRandomUndEdge=function(){return this.pickRandomProperty(this._und_edges)},t.prototype.clone=function(){var e,r=new t(this._label),n=this.getNodes(),i=null,s=null;for(var o in n)r.addNode(n[o].clone());return[this.getDirEdges(),this.getUndEdges()].forEach(function(t){for(var n in t)e=t[n],i=r.getNodeById(e.getNodes().a.getID()),s=r.getNodeById(e.getNodes().b.getID()),r.addEdge(e.clone(i,s))}),r},t.prototype.cloneSubGraph=function(e,r){var n=new t(this._label),i=a.prepareBFSStandardConfig(),s=function(t){i.result[t.next_node.getID()].counter>r?t.queue=[]:n.addNode(t.next_node.clone())};i.callbacks.node_unmarked.push(s),a.BFS(this,e,i);var o,u=null,h=null;return[this.getDirEdges(),this.getUndEdges()].forEach(function(t){for(var e in t)o=t[e],u=n.getNodeById(o.getNodes().a.getID()),h=n.getNodeById(o.getNodes().b.getID()),null!=u&&null!=h&&n.addEdge(o.clone(u,h))}),n},t.prototype.checkConnectedNodeOrThrow=function(t){var t=this._nodes[t.getID()];if(!t)throw new Error("Cowardly refusing to delete edges of un-added node.")},t.prototype.updateGraphMode=function(){var t=this._nr_dir_edges,e=this._nr_und_edges;t&&e?this._mode=l.MIXED:t?this._mode=l.DIRECTED:e?this._mode=l.UNDIRECTED:this._mode=l.INIT},t.prototype.pickRandomProperty=function(t){var e=Object.keys(t),r=e[Math.floor(Math.random()*e.length)];return t[r]},t.prototype.pickRandomProperties=function(t,e){for(var r=[],n=Object.keys(t),i=e/n.length,s={},o=0;r.length<e&&o<n.length;o++)Math.random()<i&&(r.push(n[o]),s[n[o]]=o);for(var a=e-r.length,o=0;o<n.length&&a;o++)null==s[n[o]]&&(r.push(n[o]),a--);return r},t}();e.BaseGraph=c},function(t,e,r){"use strict";var n=r(6),i=function(){function t(t){this.config=null,this.config=t||n.RUN_CONFIG}return t.prototype.log=function(t){return this.config.log_level===n.LOG_LEVELS.debug&&(console.log.apply(console,Array.prototype.slice.call(arguments)),!0)},t.prototype.error=function(t){return this.config.log_level===n.LOG_LEVELS.debug&&(console.error.apply(console,Array.prototype.slice.call(arguments)),!0)},t.prototype.dir=function(t){return this.config.log_level===n.LOG_LEVELS.debug&&(console.dir.apply(console,Array.prototype.slice.call(arguments)),!0)},t.prototype.info=function(t){return this.config.log_level===n.LOG_LEVELS.debug&&(console.info.apply(console,Array.prototype.slice.call(arguments)),!0)},t.prototype.warn=function(t){return this.config.log_level===n.LOG_LEVELS.debug&&(console.warn.apply(console,Array.prototype.slice.call(arguments)),!0)},t}();e.Logger=i},function(t,e){"use strict";var r={debug:"DEBUG",production:"PRODUCTION"};e.LOG_LEVELS=r;var n={log_level:r.debug};e.RUN_CONFIG=n},function(t,e,r){"use strict";function n(t,e,r){var r=r||i(),n=r.callbacks,a=r.dir_mode;if(t.getMode()===s.GraphMode.INIT)throw new Error("Cowardly refusing to traverse graph without edges.");if(a===s.GraphMode.INIT)throw new Error("Cannot traverse a graph with dir_mode set to INIT.");var u={marked:{},nodes:t.getNodes(),queue:[],current:null,next_node:null,next_edge:null,root_node:e,adj_nodes:[]};n.init_bfs&&o.execCallbacks(n.init_bfs,u),u.queue.push(e);for(var h=0;h<u.queue.length;){u.current=u.queue[h++],a===s.GraphMode.MIXED?u.adj_nodes=u.current.reachNodes():a===s.GraphMode.UNDIRECTED?u.adj_nodes=u.current.connNodes():a===s.GraphMode.DIRECTED?u.adj_nodes=u.current.nextNodes():u.adj_nodes=[],"function"==typeof n.sort_nodes&&n.sort_nodes(u);for(var p in u.adj_nodes)u.next_node=u.adj_nodes[p].node,u.next_edge=u.adj_nodes[p].edge,r.result[u.next_node.getID()].distance===Number.POSITIVE_INFINITY?n.node_unmarked&&o.execCallbacks(n.node_unmarked,u):n.node_marked&&o.execCallbacks(n.node_marked,u)}return r.result}function i(){var t={result:{},callbacks:{init_bfs:[],node_unmarked:[],node_marked:[],sort_nodes:void 0},dir_mode:s.GraphMode.MIXED,messages:{},filters:{}},e=t.result,r=t.callbacks,n=0,i=function(){return n++},o=function(e){for(var r in e.nodes)t.result[r]={distance:Number.POSITIVE_INFINITY,parent:null,counter:-1};t.result[e.root_node.getID()]={distance:0,parent:e.root_node,counter:i()}};r.init_bfs.push(o);var a=function(r){t.result[r.next_node.getID()]={distance:e[r.current.getID()].distance+1,parent:r.current,counter:i()},r.queue.push(r.next_node)};return r.node_unmarked.push(a),t}var s=r(4),o=r(8);e.BFS=n,e.prepareBFSStandardConfig=i},function(t,e){"use strict";function r(t,e){t.forEach(function(t){if("function"!=typeof t)throw new Error("Provided callback is not a function.");t(e)})}e.execCallbacks=r},function(t,e,r){"use strict";function n(t,e,r){var n={stack:[],adj_nodes:[],stack_entry:null,current:null,current_root:e},r=r||s(),i=r.callbacks,o=r.dir_mode;if(t.getMode()===a.GraphMode.INIT)throw new Error("Cowardly refusing to traverse graph without edges.");if(o===a.GraphMode.INIT)throw new Error("Cannot traverse a graph with dir_mode set to INIT.");for(i.init_dfs_visit&&u.execCallbacks(i.init_dfs_visit,n),n.stack.push({node:e,parent:e,weight:0});n.stack.length;)if(n.stack_entry=n.stack.pop(),n.current=n.stack_entry.node,i.node_popped&&u.execCallbacks(i.node_popped,n),r.dfs_visit_marked[n.current.getID()])i.node_marked&&u.execCallbacks(i.node_marked,n);else{r.dfs_visit_marked[n.current.getID()]=!0,i.node_unmarked&&u.execCallbacks(i.node_unmarked,n),o===a.GraphMode.MIXED?n.adj_nodes=n.current.reachNodes():o===a.GraphMode.UNDIRECTED?n.adj_nodes=n.current.connNodes():o===a.GraphMode.DIRECTED&&(n.adj_nodes=n.current.nextNodes()),"function"==typeof i.sort_nodes&&i.sort_nodes(n);for(var h in n.adj_nodes)n.stack.push({node:n.adj_nodes[h].node,parent:n.current,weight:n.adj_nodes[h].edge.getWeight()});i.adj_nodes_pushed&&u.execCallbacks(i.adj_nodes_pushed,n)}return r.visit_result}function i(t,e,r){var r=r||o(),i=r.callbacks,s=r.dir_mode;if(t.getMode()===a.GraphMode.INIT)throw new Error("Cowardly refusing to traverse graph without edges.");if(s===a.GraphMode.INIT)throw new Error("Cannot traverse a graph with dir_mode set to INIT.");var h={marked:{},nodes:t.getNodes()};i.init_dfs&&u.execCallbacks(i.init_dfs,h),i.adj_nodes_pushed=i.adj_nodes_pushed||[];var p=function(t){h.marked[t.current.getID()]=!0};i.adj_nodes_pushed.push(p);var l=[{}],c=0,d=0,f=function(){return d++},g=function(t){l[c][t.current.getID()]={parent:t.stack_entry.parent,counter:f()}};i&&i.node_unmarked&&i.node_unmarked.push(g),n(t,e,r);for(var y in h.nodes)h.marked[y]||(c++,l.push({}),n(t,h.nodes[y],r));return l}function s(){var t={visit_result:{},callbacks:{},messages:{},dfs_visit_marked:{},dir_mode:a.GraphMode.MIXED},e=t.visit_result,r=t.callbacks,n=0,i=function(){return n++};r.init_dfs_visit=r.init_dfs_visit||[];var s=function(t){e[t.current_root.getID()]={parent:t.current_root}};r.init_dfs_visit.push(s),r.node_unmarked=r.node_unmarked||[];var o=function(t){e[t.current.getID()]={parent:t.stack_entry.parent,counter:i()}};return r.node_unmarked.push(o),t}function o(){var t=s(),e=t.callbacks;t.visit_result;e.init_dfs=e.init_dfs||[];var r=function(t){};return e.init_dfs.push(r),t}var a=r(4),u=r(8);e.DFSVisit=n,e.DFS=i,e.prepareDFSVisitStandardConfig=s,e.prepareDFSStandardConfig=o},function(t,e,r){"use strict";function n(t,e){if(null==t||null==e)throw new Error("Graph as well as start node have to be valid objects.");if(0===t.nrDirEdges()&&0===t.nrUndEdges())throw new Error("Cowardly refusing to traverse a graph without edges.");if(!t.hasNodeID(e.getID()))throw new Error("Cannot start from an outside node.")}function i(t,e){function r(t,e,r){u=h[t]+r,h[e]>u&&(h[e]=u)}function i(t,e,r){return h[e]>h[t]+r}n(t,e);for(var s,a,u,h=[],p=t.getNodes(),l=Object.keys(p),c={},d=!1,f=0;f<l.length;++f)a=p[l[f]],h[f]=a===e?0:Number.POSITIVE_INFINITY,c[a.getID()]=f;for(var g=t.getDirEdgesArray().concat(t.getUndEdgesArray()),y=[],v=0;v<g.length;++v){s=g[v];y.push([c[s.getNodes().a.getID()],c[s.getNodes().b.getID()],isFinite(s.getWeight())?s.getWeight():o.DEFAULT_WEIGHT,s.isDirected()])}for(var m=0;m<l.length-1;++m)for(var v=0;v<y.length;++v)s=y[v],r(s[0],s[1],s[2]),!s[3]&&r(s[1],s[0],s[2]);for(var v=0;v<y.length;++v)if(s=y[v],i(s[0],s[1],s[2])||!s[3]&&i(s[1],s[0],s[2])){d=!0;break}return{distances:h,neg_cycle:d}}function s(t,e){function r(t,e,r){l=d[t]+r,d[e]>l&&(d[e]=l)}function i(t,e,r){return d[e]>d[t]+r}n(t,e);var s,a,u,h,p,l,c,d={},f=!1;d={},s=t.getDirEdgesArray().concat(t.getUndEdgesArray()),c=t.nrNodes();for(var g in t.getNodes())d[g]=Number.POSITIVE_INFINITY;d[e.getID()]=0;for(var y=0;y<c-1;++y)for(var v=0;v<s.length;++v)a=s[v],u=a.getNodes().a.getID(),h=a.getNodes().b.getID(),p=isFinite(a.getWeight())?a.getWeight():o.DEFAULT_WEIGHT,r(u,h,p),!a.isDirected()&&r(h,u,p);for(var m in s)a=s[m],u=a.getNodes().a.getID(),h=a.getNodes().b.getID(),p=isFinite(a.getWeight())?a.getWeight():o.DEFAULT_WEIGHT,(i(u,h,p)||!a.isDirected()&&i(h,u,p))&&(f=!0);return{distances:d,neg_cycle:f}}var o=r(11);e.BellmanFordArray=i,e.BellmanFordDict=s},function(t,e,r){"use strict";function n(t,r,n){var n=n||i(),h=n.callbacks,p=n.dir_mode,l=n.evalPriority,c=n.evalObjID;if(t.getMode()===o.GraphMode.INIT)throw new Error("Cowardly refusing to traverse graph without edges.");if(p===o.GraphMode.INIT)throw new Error("Cannot traverse a graph with dir_mode set to INIT.");var d={node:r,edge:new s.BaseEdge("virtual start edge",r,r,{weighted:!0,weight:0}),best:0},f={OPEN_HEAP:new u.BinaryHeap(u.BinaryHeapMode.MIN,l,c),OPEN:{},CLOSED:{},nodes:t.getNodes(),root_node:r,current:d,adj_nodes:[],next:null,better_dist:Number.POSITIVE_INFINITY};for(h.init_pfs&&a.execCallbacks(h.init_pfs,f),f.OPEN_HEAP.insert(d),f.OPEN[d.node.getID()]=d;f.OPEN_HEAP.size();){if(f.current=f.OPEN_HEAP.pop(),null==f.current&&console.log("HEAP popped undefined - HEAP size: "+f.OPEN_HEAP.size()),f.OPEN[f.current.node.getID()]=void 0,f.CLOSED[f.current.node.getID()]=f.current,f.current.node===n.goal_node)return n.callbacks.goal_reached&&a.execCallbacks(n.callbacks.goal_reached,f),n.result;if(p===o.GraphMode.MIXED)f.adj_nodes=f.current.node.reachNodes();else if(p===o.GraphMode.UNDIRECTED)f.adj_nodes=f.current.node.connNodes();else{if(p!==o.GraphMode.DIRECTED)throw new Error("Unsupported traversal mode. Please use directed, undirected, or mixed");f.adj_nodes=f.current.node.nextNodes()}for(var g in f.adj_nodes)f.next=f.adj_nodes[g],f.CLOSED[f.next.node.getID()]?n.callbacks.node_closed&&a.execCallbacks(n.callbacks.node_closed,f):f.OPEN[f.next.node.getID()]?(f.next.best=f.OPEN[f.next.node.getID()].best,n.callbacks.node_open&&a.execCallbacks(n.callbacks.node_open,f),f.better_dist=f.current.best+(isNaN(f.next.edge.getWeight())?e.DEFAULT_WEIGHT:f.next.edge.getWeight()),f.next.best>f.better_dist&&(n.callbacks.better_path&&a.execCallbacks(n.callbacks.better_path,f),f.OPEN_HEAP.remove(f.next),f.next.best=f.better_dist,f.OPEN_HEAP.insert(f.next),f.OPEN[f.next.node.getID()].best=f.better_dist),f.next.best===f.better_dist&&n.callbacks.equal_path&&a.execCallbacks(n.callbacks.equal_path,f)):(n.callbacks.not_encountered&&a.execCallbacks(n.callbacks.not_encountered,f),f.OPEN_HEAP.insert(f.next),f.OPEN[f.next.node.getID()]=f.next)}return n.result}function i(){var t={result:{},callbacks:{init_pfs:[],not_encountered:[],node_open:[],node_closed:[],better_path:[],equal_path:[],goal_reached:[]},messages:{init_pfs_msgs:[],not_enc_msgs:[],node_open_msgs:[],node_closed_msgs:[],better_path_msgs:[],equal_path_msgs:[],goal_reached_msgs:[]},dir_mode:o.GraphMode.MIXED,goal_node:null,evalPriority:function(t){return t.best||e.DEFAULT_WEIGHT},evalObjID:function(t){return t.node.getID()}},r=t.callbacks,n=0,i=function(){return n++},s=function(e){for(var r in e.nodes)t.result[r]={distance:Number.POSITIVE_INFINITY,parent:null,counter:-1};t.result[e.root_node.getID()]={distance:0,parent:e.root_node,counter:i()}};r.init_pfs.push(s);var a=function(r){r.next.best=r.current.best+(isNaN(r.next.edge.getWeight())?e.DEFAULT_WEIGHT:r.next.edge.getWeight()),t.result[r.next.node.getID()]={distance:r.next.best,parent:r.current.node,counter:void 0}};r.not_encountered.push(a);var u=function(e){t.result[e.next.node.getID()].distance=e.better_dist,t.result[e.next.node.getID()].parent=e.current.node};return r.better_path.push(u),t}var s=r(1),o=r(4),a=r(8),u=r(12);e.DEFAULT_WEIGHT=1,e.PFS=n,e.preparePFSStandardConfig=i},function(t,e){"use strict";!function(t){t[t.MIN=0]="MIN",t[t.MAX=1]="MAX"}(e.BinaryHeapMode||(e.BinaryHeapMode={}));var r=e.BinaryHeapMode,n=function(){function t(t,e,n){void 0===t&&(t=r.MIN),void 0===e&&(e=function(t){return"number"!=typeof t&&"string"!=typeof t?NaN:parseInt(t)}),void 0===n&&(n=function(t){return t}),this._mode=t,this._evalPriority=e,this._evalObjID=n,this._array=[],this._positions={}}return t.prototype.getMode=function(){return this._mode},t.prototype.getArray=function(){return this._array},t.prototype.getPositions=function(){return this._positions},t.prototype.size=function(){return this._array.length},t.prototype.getEvalPriorityFun=function(){return this._evalPriority},t.prototype.evalInputPriority=function(t){return this._evalPriority(t)},t.prototype.getEvalObjIDFun=function(){return this._evalObjID},t.prototype.evalInputObjID=function(t){return this._evalObjID(t)},t.prototype.peek=function(){return this._array[0]},t.prototype.pop=function(){if(this.size())return this.remove(this._array[0])},t.prototype.find=function(t){var e=this.getNodePosition(t);return this._array[e]},t.prototype.insert=function(t){if(isNaN(this._evalPriority(t)))throw new Error("Cannot insert object without numeric priority.");this._array.push(t),this.setNodePosition(t,this.size()-1,!1),this.trickleUp(this.size()-1)},t.prototype.remove=function(t){if(isNaN(this._evalPriority(t)))throw new Error("Object invalid.");for(var e=this._evalObjID(t),r=void 0,n=0;n<this._array.length;n++)if(this._evalObjID(this._array[n])===e){r=this._array[n];var i=this._array.pop();return this.size()&&(this._array[n]=i,this.trickleUp(n),this.trickleDown(n)),r}return r},t.prototype.trickleDown=function(t){for(var e=this._array[t];;){var r=2*(t+1),n=r-1,i=this._array[r],s=this._array[n],o=null;if(n<this.size()&&!this.orderCorrect(e,s)&&(o=n),r<this.size()&&!this.orderCorrect(e,i)&&!this.orderCorrect(s,i)&&(o=r),null===o)break;this._array[t]=this._array[o],this._array[o]=e,this.setNodePosition(this._array[t],t,!0,o),this.setNodePosition(this._array[o],o,!0,t),t=o}},t.prototype.trickleUp=function(t){for(var e=this._array[t];t;){var r=Math.floor((t+1)/2)-1,n=this._array[r];if(this.orderCorrect(n,e))break;this._array[r]=e,this._array[t]=n,this.setNodePosition(e,r,!0,t),this.setNodePosition(n,t,!0,r),t=r}},t.prototype.orderCorrect=function(t,e){var n=this._evalPriority(t),i=this._evalPriority(e);return this._mode===r.MIN?n<=i:n>=i},t.prototype.setNodePosition=function(t,e,r,n){if(void 0===r&&(r=!0),"undefined"==typeof t||null===t||"undefined"==typeof e||null===e)throw new Error("minium required arguments are ojb and new_pos");if(r===!0&&("undefined"==typeof n||null===n))throw new Error("replacing a node position requires an old_pos");var i={priority:this.evalInputPriority(t),position:e},s=this.evalInputObjID(t),o=this._positions[s];if(o)if(Array.isArray(o))if(r){for(var a=0;a<o.length;a++)if(o[a].position===n)return void(o[a].position=e)}else o.push(i);else r?this._positions[s]=i:this._positions[s]=[o,i];else this._positions[s]=i},t.prototype.getNodePosition=function(t){var e=this.evalInputObjID(t),r=this._positions[e];if(!r)return console.log("getNodePosition: no occurrence found"),console.log("Neighborhood entry: "),console.dir(t),void console.log("Object KEY: "+e);if(!Array.isArray(r))return"undefined"==typeof r.position&&console.log("Occurrence position: undefined!"),r.position;for(var n=null,i=Number.POSITIVE_INFINITY,s=0;s<r.length;s++)r[s].position<i&&(n=r[s]);return n?("undefined"==typeof n.position&&console.log("Node position: undefined!"),n.position):void 0},t.prototype.unsetNodePosition=function(t){var e=this.evalInputObjID(t),r=this._positions[e];if(!r)return console.log("Neighborhood entry: "),console.log("Object: "),console.dir(t),void console.log("Object KEY: "+e);if(!Array.isArray(r))return delete this._positions[e],r.position;for(var n=null,i=null,s=Number.POSITIVE_INFINITY,o=0;o<r.length;o++)r[o].position<s&&(n=o,
i=r[o]);return i?(r.splice(n,1),1===r.length&&(this._positions[e]=r[0]),"undefined"==typeof i.position&&console.log("Node position: undefined!"),i.position):void 0},t}();e.BinaryHeap=n},function(t,e,r){"use strict";var n=r(14),i=r(16),s=r(4),o=r(17),a=function(){function t(t,e,r){void 0===t&&(t=","),void 0===e&&(e=!0),void 0===r&&(r=!1),this._separator=t,this._explicit_direction=e,this._direction_mode=r}return t.prototype.readFromAdjacencyListURL=function(t,e){this.readGraphFromURL(t,e,this.readFromAdjacencyList)},t.prototype.readFromEdgeListURL=function(t,e){this.readGraphFromURL(t,e,this.readFromEdgeList)},t.prototype.readGraphFromURL=function(t,e,r){var i,s,a=this,u=n.basename(t);"undefined"!=typeof window?(s=new XMLHttpRequest,s.onreadystatechange=function(){if(4==s.readyState&&200==s.status){var t=s.responseText.split("\n");i=r.apply(a,[t,u]),e(i,void 0)}},s.open("GET",t,!0),s.setRequestHeader("Content-Type","text/csv; charset=ISO-8859-1"),s.send()):o.retrieveRemoteFile(t,function(t){var n=t.toString().split("\n");i=r.apply(a,[n,u]),e(i,void 0)})},t.prototype.readFromAdjacencyListFile=function(t){return this.readFileAndReturn(t,this.readFromAdjacencyList)},t.prototype.readFromEdgeListFile=function(t){return this.readFileAndReturn(t,this.readFromEdgeList)},t.prototype.readFileAndReturn=function(t,e){this.checkNodeEnvironment();var r=n.basename(t),s=i.readFileSync(t).toString().split("\n");return e.apply(this,[s,r])},t.prototype.readFromAdjacencyList=function(t,e){var r=new s.BaseGraph(e);for(var n in t){var i,o,a,u,h,p,l,c,d=t[n],f=this._separator.match(/\s+/g)?d.match(/\S+/g):d.replace(/\s+/g,"").split(this._separator),g=f[0],y=f.slice(1);if(g){i=r.hasNodeID(g)?r.getNodeById(g):r.addNodeByID(g);for(var v=0;v<y.length;){if(this._explicit_direction&&(!y||y.length%2))throw new Error("Every edge entry has to contain its direction info in explicit mode.");if(a=y[v++],u=r.hasNodeID(a)?r.getNodeById(a):r.addNodeByID(a),h=this._explicit_direction?y[v++]:this._direction_mode?"d":"u","d"!==h&&"u"!==h)throw new Error("Specification of edge direction invalid (d and u are valid).");p="d"===h,l=g+"_"+a+"_"+h,c=a+"_"+g+"_"+h,r.hasEdgeID(l)||!p&&r.hasEdgeID(c)||(o=r.addEdgeByID(l,i,u,{directed:p}))}}}return r},t.prototype.readFromEdgeList=function(t,e){var r=new s.BaseGraph(e);for(var n in t){var i=t[n],o=this._separator.match(/\s+/g)?i.match(/\S+/g):i.replace(/\s+/g,"").split(this._separator);if(o){if(o.length<2)throw console.log(o),new Error("Edge list is in wrong format - every line has to consist of two entries (the 2 nodes)");var a,u,h,p,l,c,d=o[0],f=o[1],g=this._explicit_direction?o[2]:this._direction_mode?"d":"u";if(a=r.hasNodeID(d)?r.getNodeById(d):r.addNodeByID(d),u=r.hasNodeID(f)?r.getNodeById(f):r.addNodeByID(f),"d"!==g&&"u"!==g)throw new Error("Specification of edge direction invalid (d and u are valid).");p="d"===g,l=d+"_"+f+"_"+g,c=f+"_"+d+"_"+g,r.hasEdgeID(l)||!p&&r.hasEdgeID(c)||(h=r.addEdgeByID(l,a,u,{directed:p}))}}return r},t.prototype.checkNodeEnvironment=function(){if("undefined"!=typeof window)throw new Error("Cannot read file in browser environment.")},t}();e.CSVInput=a},function(t,e,r){(function(t){function r(t,e){for(var r=0,n=t.length-1;n>=0;n--){var i=t[n];"."===i?t.splice(n,1):".."===i?(t.splice(n,1),r++):r&&(t.splice(n,1),r--)}if(e)for(;r--;r)t.unshift("..");return t}function n(t,e){if(t.filter)return t.filter(e);for(var r=[],n=0;n<t.length;n++)e(t[n],n,t)&&r.push(t[n]);return r}var i=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,s=function(t){return i.exec(t).slice(1)};e.resolve=function(){for(var e="",i=!1,s=arguments.length-1;s>=-1&&!i;s--){var o=s>=0?arguments[s]:t.cwd();if("string"!=typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(e=o+"/"+e,i="/"===o.charAt(0))}return e=r(n(e.split("/"),function(t){return!!t}),!i).join("/"),(i?"/":"")+e||"."},e.normalize=function(t){var i=e.isAbsolute(t),s="/"===o(t,-1);return t=r(n(t.split("/"),function(t){return!!t}),!i).join("/"),t||i||(t="."),t&&s&&(t+="/"),(i?"/":"")+t},e.isAbsolute=function(t){return"/"===t.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(n(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},e.relative=function(t,r){function n(t){for(var e=0;e<t.length&&""===t[e];e++);for(var r=t.length-1;r>=0&&""===t[r];r--);return e>r?[]:t.slice(e,r-e+1)}t=e.resolve(t).substr(1),r=e.resolve(r).substr(1);for(var i=n(t.split("/")),s=n(r.split("/")),o=Math.min(i.length,s.length),a=o,u=0;u<o;u++)if(i[u]!==s[u]){a=u;break}for(var h=[],u=a;u<i.length;u++)h.push("..");return h=h.concat(s.slice(a)),h.join("/")},e.sep="/",e.delimiter=":",e.dirname=function(t){var e=s(t),r=e[0],n=e[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."},e.basename=function(t,e){var r=s(t)[2];return e&&r.substr(-1*e.length)===e&&(r=r.substr(0,r.length-e.length)),r},e.extname=function(t){return s(t)[3]};var o="b"==="ab".substr(-1)?function(t,e,r){return t.substr(e,r)}:function(t,e,r){return e<0&&(e=t.length+e),t.substr(e,r)}}).call(e,r(15))},function(t,e){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function i(t){if(p===setTimeout)return setTimeout(t,0);if((p===r||!p)&&setTimeout)return p=setTimeout,setTimeout(t,0);try{return p(t,0)}catch(e){try{return p.call(null,t,0)}catch(e){return p.call(this,t,0)}}}function s(t){if(l===clearTimeout)return clearTimeout(t);if((l===n||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{return l(t)}catch(e){try{return l.call(null,t)}catch(e){return l.call(this,t)}}}function o(){g&&d&&(g=!1,d.length?f=d.concat(f):y=-1,f.length&&a())}function a(){if(!g){var t=i(o);g=!0;for(var e=f.length;e;){for(d=f,f=[];++y<e;)d&&d[y].run();y=-1,e=f.length}d=null,g=!1,s(t)}}function u(t,e){this.fun=t,this.array=e}function h(){}var p,l,c=t.exports={};!function(){try{p="function"==typeof setTimeout?setTimeout:r}catch(t){p=r}try{l="function"==typeof clearTimeout?clearTimeout:n}catch(t){l=n}}();var d,f=[],g=!1,y=-1;c.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];f.push(new u(t,e)),1!==f.length||g||i(a)},u.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=h,c.addListener=h,c.once=h,c.off=h,c.removeListener=h,c.removeAllListeners=h,c.emit=h,c.prependListener=h,c.prependOnceListener=h,c.listeners=function(t){return[]},c.binding=function(t){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(t){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}},function(t,e){},function(t,e,r){"use strict";function n(t,e){if("function"!=typeof e)throw new Error("Provided callback is not a function.");return i.get(t,function(t){var r="";t.on("data",function(t){r+=t}),t.on("end",function(){e(r)})})}var i=r(16);e.retrieveRemoteFile=n},function(t,e,r){"use strict";var n=r(16),i=function(){function t(t,e,r){void 0===t&&(t=","),void 0===e&&(e=!0),void 0===r&&(r=!1),this._separator=t,this._explicit_direction=e,this._direction_mode=r}return t.prototype.writeToAdjacencyListFile=function(t,e){if("undefined"!=typeof window&&null!==window)throw new Error("cannot write to File inside of Browser");n.writeFileSync(t,this.writeToAdjacencyList(e))},t.prototype.writeToAdjacencyList=function(t){var e="",r=t.getNodes(),n=null,i=null,s=null,o=function(t){return t.node.getID()};for(var a in r){n=r[a],e+=n.getID(),i=n.reachNodes(o);for(var u in i)s=i[u].node,e+=this._separator+s.getID();e+="\n"}return e},t.prototype.writeToEdgeListFile=function(t,e){throw new Error("CSVOutput.writeToEdgeListFile not implemented yet.")},t.prototype.writeToEdgeList=function(t){throw new Error("CSVOutput.writeToEdgeList not implemented yet.")},t}();e.CSVOutput=i},function(t,e,r){"use strict";var n=r(16),i=r(4),s=r(17),o=1,a=function(){function t(t,e,r){void 0===t&&(t=!0),void 0===e&&(e=!1),void 0===r&&(r=!1),this._explicit_direction=t,this._direction=e,this._weighted_mode=r}return t.prototype.readFromJSONFile=function(t){this.checkNodeEnvironment();var e=JSON.parse(n.readFileSync(t).toString());return this.readFromJSON(e)},t.prototype.readFromJSONURL=function(t,e){var r,n,i=this;"undefined"!=typeof window?(n=new XMLHttpRequest,n.onreadystatechange=function(){if(4==n.readyState&&200==n.status){var t=JSON.parse(n.responseText);r=i.readFromJSON(t),e&&e(r,void 0)}},n.open("GET",t,!0),n.timeout=6e4,n.setRequestHeader("Content-Type","application/json"),n.send()):s.retrieveRemoteFile(t,function(t){r=i.readFromJSON(JSON.parse(t)),e(r,void 0)})},t.prototype.readFromJSON=function(t){var e,r,n,s,a=new i.BaseGraph(t.name);for(var u in t.data){var h=a.hasNodeID(u)?a.getNodeById(u):a.addNodeByID(u);if((s=t.data[u].features)&&h.setFeatures(s),e=t.data[u].coords){r={};for(n in e)r[n]=+e[n];h.setFeature("coords",r)}var p=t.data[u].edges;for(var l in p){var c=p[l],d=c.to,f=this._explicit_direction?c.directed:this._direction,g=f?"d":"u",y=this.handleEdgeWeights(c),v=y===y?y:o,m=this._weighted_mode?v:void 0,_=a.hasNodeID(d)?a.getNodeById(d):a.addNodeByID(d),b=u+"_"+d+"_"+g,x=d+"_"+u+"_"+g;if(!(a.hasEdgeID(b)||!f&&a.hasEdgeID(x))){a.addEdgeByID(b,h,_,{directed:f,weighted:this._weighted_mode,weight:m})}}}return a},t.prototype.handleEdgeWeights=function(t){switch(t.weight){case"undefined":return o;case"Infinity":return Number.POSITIVE_INFINITY;case"-Infinity":return Number.NEGATIVE_INFINITY;case"MAX":return Number.MAX_VALUE;case"MIN":return Number.MIN_VALUE;default:return parseFloat(t.weight)}},t.prototype.checkNodeEnvironment=function(){if("undefined"!=typeof window)throw new Error("Cannot read file in browser environment.")},t}();e.JSONInput=a},function(t,e,r){"use strict";var n=r(16),i=function(){function t(){}return t.prototype.writeToJSONFile=function(t,e){if("undefined"!=typeof window&&null!==window)throw new Error("cannot write to File inside of Browser");n.writeFileSync(t,this.writeToJSONSString(e))},t.prototype.writeToJSONSString=function(t){var e,r,n,i,s,o,a,u={name:t._label,nodes:t.nrNodes(),dir_edges:t.nrDirEdges(),und_edges:t.nrUndEdges(),data:{}};e=t.getNodes();for(var h in e){r=e[h],n=u.data[r.getID()]={edges:[]},i=r.undEdges();for(var p in i){o=i[p];var l=o.getNodes();n.edges.push({to:l.a.getID()===r.getID()?l.b.getID():l.a.getID(),directed:o.isDirected(),weight:o.isWeighted()?o.getWeight():void 0})}s=r.outEdges();for(var p in s){o=s[p];var l=o.getNodes();n.edges.push({to:l.b.getID(),directed:o.isDirected(),weight:this.handleEdgeWeight(o)})}n.features=r.getFeatures(),null!=(a=r.getFeature("coords"))&&(n.coords=a)}return JSON.stringify(u)},t.prototype.handleEdgeWeight=function(t){if(t.isWeighted())switch(t.getWeight()){case Number.POSITIVE_INFINITY:return"Infinity";case Number.NEGATIVE_INFINITY:return"-Infinity";case Number.MAX_VALUE:return"MAX";case Number.MIN_VALUE:return"MIN";default:return t.getWeight()}},t}();e.JSONOutput=i},function(t,e,r){"use strict";function n(t){var e=new h,r={output:[t]},n=e.createKernel(function(){return this.thread.x},r);return n()}function i(t){var e={},r=u.mergeObjects([t.getDirEdges(),t.getUndEdges()]);for(var n in r){var i=r[n].getNodes().a.getID(),s=r[n].getNodes().b.getID();null==e[i]&&(e[i]={}),e[i][s]=isNaN(r[n].getWeight())?1:r[n].getWeight(),r[n].isDirected()||(null==e[s]&&(e[s]={}),e[s][i]=isNaN(r[n].getWeight())?1:r[n].getWeight())}return e}function s(t){if(0===t.nrDirEdges()&&0===t.nrUndEdges())throw new Error("Cowardly refusing to traverse graph without edges.");for(var e=t.adjListArray(),r=t.nextArray(),n=e.length,i=0;i<n;++i)for(var s=0;s<n;++s)for(var o=0;o<n;++o)e[s][o]==e[s][i]+e[i][o]&&i!=s&&i!=o&&(r[s][o]=u.mergeOrderedArraysNoDups(r[s][o],r[s][i])),(!e[s][o]&&0!=e[s][o]||e[s][o]>e[s][i]+e[i][o])&&(r[s][o]=r[s][i].slice(0),e[s][o]=e[s][i]+e[i][o]);return[e,r]}function o(t){if(0===t.nrDirEdges()&&0===t.nrUndEdges())throw new Error("Cowardly refusing to traverse graph without edges.");for(var e=t.adjListArray(),r=e.length,n=0;n<r;++n)for(var i=0;i<r;++i)for(var s=0;s<r;++s)e[i][s]>e[i][n]+e[n][s]&&(e[i][s]=e[i][n]+e[n][s]);return e}function a(t){if(0===t.nrDirEdges()&&0===t.nrUndEdges())throw new Error("Cowardly refusing to traverse graph without edges.");var e=i(t);for(var r in e)for(var n in e)for(var s in e)n!==s&&null!=e[n][r]&&null!=e[r][s]&&(!e[n][s]&&0!=e[n][s]||e[n][s]>e[n][r]+e[r][s])&&(e[n][s]=e[n][r]+e[r][s]);return e}var u=r(3),h=r(22);e.FloydWarshallGPU=n,e.FloydWarshallAPSP=s,e.FloydWarshallArray=o,e.FloydWarshallDict=a},function(t,e,r){"use strict";var n=r(23),i=r(48),s=r(24),o=r(26),a=r(27),u=r(44),h=r(45),p=r(42),l=r(41),c=r(36),d=r(38),f=r(31),g=r(28);n.alias=i,n.utils=s,n.Texture=a,n.Input=o,n.input=function(t,e){return new o(t,e)},n.CPUFunctionBuilder=u,n.CPUFunctionNode=h,n.CPUKernel=p,n.CPURunner=l,n.WebGLFunctionBuilder=c,n.WebGLFunctionNode=d,n.WebGLKernel=f,n.WebGLRunner=g,t.exports=n,"undefined"!=typeof window&&(window.GPU=n)},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=r(24),u=r(28),h=r(41),p=r(46),l=r(47),c=function(t){function e(t){n(this,e);var r=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));t=t||{},r._canvas=t.canvas||null,r._webGl=t.webGl||null;var s=t.mode||"webgl";a.isWebGlSupported()||(console.warn("Warning: gpu not supported, falling back to cpu support"),s="cpu"),r.kernels=[];var o={canvas:r._canvas,webGl:r._webGl};if(s)switch(s.toLowerCase()){case"cpu":r._runner=new h(o);break;case"gpu":case"webgl":r._runner=new u(o);break;case"webgl-validator":r._runner=new u(o),r._runner.Kernel=p;break;default:throw new Error('"'+s+'" mode is not defined')}return r}return s(e,t),o(e,[{key:"createKernel",value:function(t,e){if("undefined"==typeof t)throw"Missing fn parameter";if(!a.isFunction(t)&&"string"!=typeof t)throw"fn parameter not a function";var r=this._runner.buildKernel(t,e||{});return this._canvas||(this._canvas=r.getCanvas()),this._runner.canvas||(this._runner.canvas=r.getCanvas()),this.kernels.push(r),r}},{key:"createKernelMap",value:function(){var t=void 0,e=void 0;"function"==typeof arguments[arguments.length-2]?(t=arguments[arguments.length-2],e=arguments[arguments.length-1]):t=arguments[arguments.length-1],a.isWebGlDrawBuffersSupported()||(this._runner=new h(e));var r=this.createKernel(t,e);if(Array.isArray(arguments[0]))for(var n=arguments[0],i=0;i<n.length;i++)r.addSubKernel(n[i]);else{var s=arguments[0];for(var o in s)s.hasOwnProperty(o)&&r.addSubKernelProperty(o,s[o])}return r}},{key:"combineKernels",value:function(){var t=arguments[arguments.length-2],e=arguments[arguments.length-1];if("cpu"===this.getMode())return e;for(var r=arguments[0].getCanvas(),n=arguments[0].getWebGl(),i=0;i<arguments.length-1;i++)arguments[i].setCanvas(r).setWebGl(n).setOutputToTexture(!0);return function(){e.apply(null,arguments);var r=t.texSize,n=t.getWebGl(),i=t.threadDim,s=void 0;if(t.floatOutput)s=new Float32Array(r[0]*r[1]*4),n.readPixels(0,0,r[0],r[1],n.RGBA,n.FLOAT,s);else{var o=new Uint8Array(r[0]*r[1]*4);n.readPixels(0,0,r[0],r[1],n.RGBA,n.UNSIGNED_BYTE,o),s=new Float32Array(o.buffer)}if(s=s.subarray(0,i[0]*i[1]*i[2]),1===t.output.length)return s;if(2===t.output.length)return a.splitArray(s,t.output[0]);if(3===t.output.length){var u=a.splitArray(s,t.output[0]*t.output[1]);return u.map(function(e){return a.splitArray(e,t.output[0])})}}}},{key:"addFunction",value:function(t,e,r){return this._runner.functionBuilder.addFunction(null,t,e,r),this}},{key:"addNativeFunction",value:function(t,e){return this._runner.functionBuilder.addNativeFunction(t,e),this}},{key:"getMode",value:function(){return this._runner.getMode()}},{key:"isWebGlSupported",value:function(){return a.isWebGlSupported()}},{key:"getCanvas",value:function(){return this._canvas}},{key:"getWebGl",value:function(){return this._webGl}}]),e}(l);Object.assign(c,l),t.exports=c},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=r(25),h=r(26),p=r(27),l=/function ([^(]*)/,c=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,d=/([^\s,]+)/g,f=function(){var t=new ArrayBuffer(4),e=new Uint32Array(t),r=new Uint8Array(t);if(e[0]=3735928559,239===r[0])return"LE";if(222===r[0])return"BE";throw new Error("unknown endianness")}(),g=null,y=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return s(e,t),a(e,null,[{key:"systemEndianness",value:function(){return f}},{key:"isFunction",value:function(t){return"function"==typeof t}},{key:"isFunctionString",value:function(t){return null!==t&&"function"===t.toString().slice(0,"function".length).toLowerCase()}},{key:"getFunctionNameFromString",value:function(t){return l.exec(t)[1]}},{key:"getFunctionBodyFromString",value:function(t){return t.substring(t.indexOf("{")+1,t.lastIndexOf("}"))}},{key:"getParamNamesFromString",value:function(t){var e=t.toString().replace(c,""),r=e.slice(e.indexOf("(")+1,e.indexOf(")")).match(d);return null===r&&(r=[]),r}},{key:"clone",value:function(t){if(null===t||"object"!==("undefined"==typeof t?"undefined":o(t))||t.hasOwnProperty("isActiveClone"))return t;var r=t.constructor();for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(t.isActiveClone=null,r[n]=e.clone(t[n]),delete t.isActiveClone);return r}},{key:"newPromise",value:function(t){var e=Promise||small_promise;if(null===e)throw TypeError("Browser is missing Promise implementation. Consider adding small_promise.js polyfill");return new e(t)}},{key:"functionBinder",value:function(t,e){return t.bind?t.bind(e):function(){var r=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);return t.apply(e,r)}}},{key:"isArray",value:function(t){return!isNaN(t.length)}},{key:"getArgumentType",value:function(t){return e.isArray(t)?"Array":"number"==typeof t?"Number":t instanceof p?"Texture":t instanceof h?"Input":"Unknown"}},{key:"isFloatReadPixelsSupported",value:function(){if(null!==g)return g;var t=r(22),e=new t({mode:"webgl-validator"}).createKernel(function(){return 1},{output:[2],floatTextures:!0,floatOutput:!0,floatOutputForce:!0})();return g=1===e[0]}},{key:"dimToTexSize",value:function(t,e,r){for(var n=e[0],i=1;i<e.length;i++)n*=e[i];!t.floatTextures||r&&!t.floatOutput||(n=Math.ceil(n/4));var s=Math.ceil(Math.sqrt(n));return[s,s]}},{key:"getDimensions",value:function(t,r){var n=void 0;if(e.isArray(t)){for(var i=[],s=t;e.isArray(s);)i.push(s.length),s=s[0];n=i.reverse()}else if(t instanceof p)n=t.output;else{if(!(t instanceof h))throw"Unknown dimensions of "+t;n=t.size}if(r)for(n=e.clone(n);n.length<3;)n.push(1);return n}},{key:"pad",value:function(t,e){function r(t){return Array.apply(null,new Array(t)).map(Number.prototype.valueOf,0)}for(var n=t.length+2*e,i=t.map(function(t){return[].concat(r(e),t,r(e))}),s=0;s<e;s++)i=[].concat([r(n)],i,[r(n)]);return i}},{key:"flatten2dArrayTo",value:function(t,e){for(var r=0,n=0;n<t.length;n++)e.set(t[n],r),r+=t[n].length}},{key:"flatten3dArrayTo",value:function(t,e){for(var r=0,n=0;n<t.length;n++)for(var i=0;i<t[n].length;i++)e.set(t[n][i],r),r+=t[n][i].length}},{key:"flattenTo",value:function(t,r){e.isArray(t[0])?e.isArray(t[0][0])?e.flatten3dArrayTo(t,r):e.flatten2dArrayTo(t,r):r.set(t)}},{key:"splitArray",value:function(t,e){for(var r=[],n=0;n<t.length;n+=e)r.push(Array.prototype.slice.call(t,n,n+e));return r}},{key:"getAstString",value:function(t,e){var r=Array.isArray(t)?t:t.split(/\r?\n/g),n=e.loc.start,i=e.loc.end,s=[];s.push(r[n.line-1].slice(n.column));for(var o=n.line;o<i.line-1;o++)s.push(r[o]);return s.push(r[i.line-1].slice(0,i.column)),s.join("\n")}},{key:"allPropertiesOf",value:function(t){var e=[];do e.push.apply(e,Object.getOwnPropertyNames(t));while(t=Object.getPrototypeOf(t));return e}}]),e}(u);Object.assign(y,u),t.exports=y},function(t,e){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=function(){function t(){r(this,t)}return n(t,null,[{key:"isCanvas",value:function(t){return null!==t&&t.nodeName&&t.getContext&&"CANVAS"===t.nodeName.toUpperCase()}},{key:"isCanvasSupported",value:function(){return s}},{key:"initCanvas",value:function(){if(!s)return null;var t=document.createElement("canvas");return t.width=2,t.height=2,t}},{key:"isWebGl",value:function(t){return t&&"function"==typeof t.getExtension}},{key:"isWebGlSupported",value:function(){return a}},{key:"isWebGlDrawBuffersSupported",value:function(){return u}},{key:"initWebGlDefaultOptions",value:function(){return{alpha:!1,depth:!1,antialias:!1}}},{key:"initWebGl",value:function(e){if(("undefined"!=typeof s||null===e)&&!s)return null;if(!t.isCanvas(e))throw new Error("Invalid canvas object - "+e);var r=e.getContext("experimental-webgl",t.initWebGlDefaultOptions())||e.getContext("webgl",t.initWebGlDefaultOptions());return r&&(r.OES_texture_float=r.getExtension("OES_texture_float"),r.OES_texture_float_linear=r.getExtension("OES_texture_float_linear"),r.OES_element_index_uint=r.getExtension("OES_element_index_uint")),r}}]),t}(),s="undefined"!=typeof document&&i.isCanvas(document.createElement("canvas")),o=i.initWebGl(i.initCanvas()),a=i.isWebGl(o),u=a&&Boolean(o.getExtension("WEBGL_draw_buffers"));a?(i.OES_texture_float=o.OES_texture_float,i.OES_texture_float_linear=o.OES_texture_float_linear,i.OES_element_index_uint=o.OES_element_index_uint):(i.OES_texture_float=!1,i.OES_texture_float_linear=!1,i.OES_element_index_uint=!1),t.exports=i},function(t,e){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}t.exports=function n(t,e){if(r(this,n),this.value=t,Array.isArray(e)){this.size=[];for(var i=0;i<e.length;i++)this.size[i]=e[i];for(;this.size.length<3;)this.size.push(1)}else e.z?this.size=[e.x,e.y,e.z]:e.y?this.size=[e.x,e.y,1]:this.size=[e.x,1,1]}},function(t,e){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();t.exports=function(){function t(e,n,i,s){r(this,t),this.texture=e,this.size=n,this.output=i,this.webGl=s,this.kernel=null}return n(t,[{key:"toArray",value:function(t){if(!t)throw new Error("You need to pass the GPU object for toArray to work.");return this.kernel?this.kernel(this):(this.kernel=t.createKernel(function(t){return t[this.thread.z][this.thread.y][this.thread.x]}).setOutput(this.output),this.kernel(this))}},{key:"delete",value:function(){return this.webGl.deleteTexture(this.texture)}}]),t}()},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=r(29),u=r(31),h=(r(24),r(36));t.exports=function(t){function e(t){n(this,e);var r=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,new h,t));return r.Kernel=u,r.kernel=null,r}return s(e,t),o(e,[{key:"getMode",value:function(){return"gpu"}}]),e}(a)},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=r(24),o=r(30);t.exports=function(){function t(e,r){n(this,t),r=r||{},this.kernel=r.kernel,this.canvas=r.canvas,this.webGl=r.webGl,this.fn=null,this.functionBuilder=e,this.fnString=null,this.endianness=s.systemEndianness(),this.functionBuilder.polyfillStandardFunctions()}return i(t,[{key:"textureToArray",value:function(t){var e=this.createKernel(function(t){return t[this.thread.z][this.thread.y][this.thread.x]});return e(t)}},{key:"deleteTexture",value:function(t){this.webGl.deleteTexture(t.texture)}},{key:"buildPromiseKernel",value:function(){throw new Error("not yet implemented")}},{key:"getMode",value:function(){throw new Error('"mode" not implemented on BaseRunner')}},{key:"buildKernel",value:function(t,e){e=Object.assign({},e||{});var r=t.toString();return e.functionBuilder||(e.functionBuilder=this.functionBuilder),e.canvas||(e.canvas=this.canvas),e.webGl||(e.webGl=this.webgl),o(new this.Kernel(r,e))}}]),t}()},function(t,e,r){"use strict";var n=r(24);t.exports=function(t){var e=function(){return t.run.apply(t,arguments)};return n.allPropertiesOf(t).forEach(function(r){"_"===r[0]&&"_"===r[1]||("function"==typeof t[r]?"add"===r.substring(0,3)||"set"===r.substring(0,3)?e[r]=function(){return t[r].apply(t,arguments),e}:e[r]=t[r].bind(t):(e.__defineGetter__(r,function(){return t[r]}),e.__defineSetter__(r,function(e){t[r]=e})))}),e.kernel=t,e}},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=r(32),u=r(24),h=r(27),p=r(33),l=r(34),c=r(35),d=[],f={};t.exports=function(t){function e(t,r){n(this,e);var s=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));return s.textureCache={},s.threadDim={},s.programUniformLocationCache={},s.framebuffer=null,s.buffer=null,s.program=null,s.outputToTexture=r.outputToTexture,s.endianness=u.systemEndianness(),s.subKernelOutputTextures=null,s.subKernelOutputVariableNames=null,s.argumentsLength=0,s.ext=null,s.compiledFragShaderString=null,s.compiledVertShaderString=null,s.extDrawBuffersMap=null,s.outputTexture=null,s.maxTexSize=null,s._webGl||(s._webGl=u.initWebGl(s.getCanvas())),s}return s(e,t),o(e,[{key:"validateOptions",value:function(){var t=u.isFloatReadPixelsSupported();if(this.floatTextures===!0&&!u.OES_texture_float)throw"Float textures are not supported on this browser";if(this.floatOutput===!0&&this.floatOutputForce!==!0&&!t)throw"Float texture outputs are not supported on this browser";if(null!==this.floatTextures||t||this.graphical||(this.floatTextures=!0,this.floatOutput=!1),!this.output||0===this.output.length){if(1!==arguments.length)throw"Auto output only supported for kernels with only one input";var e=u.getArgumentType(arguments[0]);if("Array"===e)this.output=u.getDimensions(e);else{if("Texture"!==e)throw"Auto output not supported for input type: "+e;this.output=arguments[0].output}}if(this.texSize=u.dimToTexSize({floatTextures:this.floatTextures,floatOutput:this.floatOutput},this.output,!0),this.graphical){if(2!==this.output.length)throw"Output must have 2 dimensions on graphical mode";if(this.floatOutput)throw"Cannot use graphical mode and float output at the same time";this.texSize=u.clone(this.output)}else void 0===this.floatOutput&&u.OES_texture_float&&(this.floatOutput=!0)}},{key:"updateMaxTexSize",value:function(){var t=this.texSize,e=this._canvas;if(null===this.maxTexSize){var r=d.indexOf(e);r===-1&&(r=d.length,d.push(e),f[r]=[t[0],t[1]]),this.maxTexSize=f[r]}this.maxTexSize[0]<t[0]&&(this.maxTexSize[0]=t[0]),this.maxTexSize[1]<t[1]&&(this.maxTexSize[1]=t[1])}},{key:"build",value:function(){this.validateOptions(),this.setupParams(arguments),this.updateMaxTexSize();var t=this.texSize,e=this._webGl,r=this._canvas;e.enable(e.SCISSOR_TEST),e.viewport(0,0,this.maxTexSize[0],this.maxTexSize[1]),r.width=this.maxTexSize[0],r.height=this.maxTexSize[1];for(var n=this.threadDim=u.clone(this.output);n.length<3;)n.push(1);this.functionBuilder&&this._addKernels();var i=this._getVertShaderString(arguments),s=e.createShader(e.VERTEX_SHADER);e.shaderSource(s,i),e.compileShader(s);var o=this._getFragShaderString(arguments),a=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(a,o),e.compileShader(a),!e.getShaderParameter(s,e.COMPILE_STATUS))throw console.log(i),console.error("An error occurred compiling the shaders: "+e.getShaderInfoLog(s)),"Error compiling vertex shader";if(!e.getShaderParameter(a,e.COMPILE_STATUS))throw console.log(o),console.error("An error occurred compiling the shaders: "+e.getShaderInfoLog(a)),"Error compiling fragment shader";this.debug&&(console.log("Options:"),console.dir(this),console.log("GLSL Shader Output:"),console.log(o));var h=this.program=e.createProgram();e.attachShader(h,s),e.attachShader(h,a),e.linkProgram(h),this.framebuffer=e.createFramebuffer(),this.framebuffer.width=t[0],this.framebuffer.height=t[1];var p=new Float32Array([-1,-1,1,-1,-1,1,1,1]),l=new Float32Array([0,0,1,0,0,1,1,1]),c=p.byteLength,d=this.buffer;d?e.bindBuffer(e.ARRAY_BUFFER,d):(d=this.buffer=e.createBuffer(),
e.bindBuffer(e.ARRAY_BUFFER,d),e.bufferData(e.ARRAY_BUFFER,p.byteLength+l.byteLength,e.STATIC_DRAW)),e.bufferSubData(e.ARRAY_BUFFER,0,p),e.bufferSubData(e.ARRAY_BUFFER,c,l);var f=e.getAttribLocation(this.program,"aPos");e.enableVertexAttribArray(f),e.vertexAttribPointer(f,2,e.FLOAT,e.FALSE,0,0);var g=e.getAttribLocation(this.program,"aTexCoord");if(e.enableVertexAttribArray(g),e.vertexAttribPointer(g,2,e.FLOAT,e.FALSE,0,c),this.setupOutputTexture(),null!==this.subKernelOutputTextures)for(var y=this.extDrawBuffersMap=[e.COLOR_ATTACHMENT0],v=0;v<this.subKernelOutputTextures.length;v++){var m=this.subKernelOutputTextures[v];y.push(e.COLOR_ATTACHMENT0+v+1),e.activeTexture(e.TEXTURE0+arguments.length+v),e.bindTexture(e.TEXTURE_2D,m),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),this.floatOutput?e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t[0],t[1],0,e.RGBA,e.FLOAT,null):e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t[0],t[1],0,e.RGBA,e.UNSIGNED_BYTE,null)}}},{key:"run",value:function(){null===this.program&&this.build.apply(this,arguments);var t=this.paramNames,e=this.paramTypes,r=this.texSize,n=this._webGl;if(n.useProgram(this.program),n.scissor(0,0,r[0],r[1]),!this.hardcodeConstants){var i=this.getUniformLocation("uOutputDim");n.uniform3fv(i,this.threadDim);var s=this.getUniformLocation("uTexSize");n.uniform2fv(s,r)}var o=this.getUniformLocation("ratio");n.uniform2f(o,r[0]/this.maxTexSize[0],r[1]/this.maxTexSize[1]),this.argumentsLength=0;for(var a=0;a<t.length;a++)this._addArgument(arguments[a],e[a],t[a]);if(this.graphical)return n.bindRenderbuffer(n.RENDERBUFFER,null),n.bindFramebuffer(n.FRAMEBUFFER,null),void n.drawArrays(n.TRIANGLE_STRIP,0,4);n.bindFramebuffer(n.FRAMEBUFFER,this.framebuffer);var u=this.outputTexture;if(n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,u,0),null!==this.subKernelOutputTextures){for(var p=0;p<this.subKernelOutputTextures.length;p++){var l=this.subKernelOutputTextures[p];n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+p+1,n.TEXTURE_2D,l,0)}this.ext.drawBuffersWEBGL(this.extDrawBuffersMap)}if(n.drawArrays(n.TRIANGLE_STRIP,0,4),null!==this.subKernelOutputTextures){if(null!==this.subKernels){var c=[];c.result=this.renderOutput(u);for(var d=0;d<this.subKernels.length;d++)c.push(new h(this.subKernelOutputTextures[d],r,this.output,this._webGl));return c}if(null!==this.subKernelProperties){var f={result:this.renderOutput(u)},g=0;for(var y in this.subKernelProperties)this.subKernelProperties.hasOwnProperty(y)&&(f[y]=new h(this.subKernelOutputTextures[g],r,this.output,this._webGl),g++);return f}}return this.renderOutput(u)}},{key:"renderOutput",value:function(t){var e=this.texSize,r=this._webGl,n=this.threadDim,i=this.output;if(this.outputToTexture)return new h(t,e,i,this._webGl);var s=void 0;if(this.floatOutput)s=new Float32Array(e[0]*e[1]*4),r.readPixels(0,0,e[0],e[1],r.RGBA,r.FLOAT,s);else{var o=new Uint8Array(e[0]*e[1]*4);r.readPixels(0,0,e[0],e[1],r.RGBA,r.UNSIGNED_BYTE,o),s=new Float32Array(o.buffer)}if(s=s.subarray(0,n[0]*n[1]*n[2]),1===i.length)return s;if(2===i.length)return u.splitArray(s,i[0]);if(3===i.length){var a=u.splitArray(s,i[0]*i[1]);return a.map(function(t){return u.splitArray(t,i[0])})}}},{key:"getOutputTexture",value:function(){return this.getTextureCache("OUTPUT")}},{key:"detachOutputTexture",value:function(){this.detachTextureCache("OUTPUT")}},{key:"setupOutputTexture",value:function(){var t=this._webGl,e=this.texSize;this.detachOutputTexture(),this.outputTexture=this.getOutputTexture(),t.activeTexture(t.TEXTURE0+this.paramNames.length),t.bindTexture(t.TEXTURE_2D,this.outputTexture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),this.floatOutput?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e[0],e[1],0,t.RGBA,t.FLOAT,null):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e[0],e[1],0,t.RGBA,t.UNSIGNED_BYTE,null)}},{key:"getArgumentTexture",value:function(t){return this.getTextureCache("ARGUMENT_"+t)}},{key:"getSubKernelTexture",value:function(t){return this.getTextureCache("SUB_KERNEL_"+t)}},{key:"getTextureCache",value:function(t){return this.outputToTexture?this._webGl.createTexture():this.textureCache.hasOwnProperty(t)?this.textureCache[t]:this.textureCache[t]=this._webGl.createTexture()}},{key:"detachTextureCache",value:function(t){delete this.textureCache[t]}},{key:"getUniformLocation",value:function(t){var e=this.programUniformLocationCache[t];return e||(e=this._webGl.getUniformLocation(this.program,t),this.programUniformLocationCache[t]=e),e}},{key:"_getFragShaderArtifactMap",value:function(t){return{HEADER:this._getHeaderString(),LOOP_MAX:this._getLoopMaxString(),CONSTANTS:this._getConstantsString(),DECODE32_ENDIANNESS:this._getDecode32EndiannessString(),ENCODE32_ENDIANNESS:this._getEncode32EndiannessString(),GET_WRAPAROUND:this._getGetWraparoundString(),GET_TEXTURE_CHANNEL:this._getGetTextureChannelString(),GET_TEXTURE_INDEX:this._getGetTextureIndexString(),GET_RESULT:this._getGetResultString(),MAIN_PARAMS:this._getMainParamsString(t),MAIN_CONSTANTS:this._getMainConstantsString(),KERNEL:this._getKernelString(),MAIN_RESULT:this._getMainResultString()}}},{key:"_addArgument",value:function(t,e,r){var n=this._webGl,i=this.getArgumentTexture(r);switch(t instanceof h&&(e="Texture"),e){case"Array":var s=u.getDimensions(t,!0),o=u.dimToTexSize({floatTextures:this.floatTextures,floatOutput:this.floatOutput},s);n.activeTexture(n.TEXTURE0+this.argumentsLength),n.bindTexture(n.TEXTURE_2D,i),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST);var a=o[0]*o[1];this.floatTextures&&(a*=4);var p=new Float32Array(a);u.flattenTo(t,p);var l=void 0;this.floatTextures?n.texImage2D(n.TEXTURE_2D,0,n.RGBA,o[0],o[1],0,n.RGBA,n.FLOAT,p):(l=new Uint8Array(p.buffer),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,o[0],o[1],0,n.RGBA,n.UNSIGNED_BYTE,l));var c=this.getUniformLocation("user_"+r),d=this.getUniformLocation("user_"+r+"Size"),f=this.getUniformLocation("user_"+r+"Dim");this.hardcodeConstants||(n.uniform3fv(f,s),n.uniform2fv(d,o)),n.uniform1i(c,this.argumentsLength);break;case"Number":var g=this.getUniformLocation("user_"+r);n.uniform1f(g,t);break;case"Input":var y=t,v=y.size,m=u.dimToTexSize({floatTextures:this.floatTextures,floatOutput:this.floatOutput},v);n.activeTexture(n.TEXTURE0+this.argumentsLength),n.bindTexture(n.TEXTURE_2D,i),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST);var _=m[0]*m[1],b=void 0;if(this.floatTextures?(_*=4,b=new Float32Array(_),b.set(y.value)):b=y.value,this.floatTextures)n.texImage2D(n.TEXTURE_2D,0,n.RGBA,m[0],m[1],0,n.RGBA,n.FLOAT,b);else{var x=new Uint8Array(b.buffer);n.texImage2D(n.TEXTURE_2D,0,n.RGBA,m[0],m[1],0,n.RGBA,n.UNSIGNED_BYTE,x)}var E=this.getUniformLocation("user_"+r),w=this.getUniformLocation("user_"+r+"Size"),S=this.getUniformLocation("user_"+r+"Dim");this.hardcodeConstants||(n.uniform3fv(S,v),n.uniform2fv(w,m)),n.uniform1i(E,this.argumentsLength);break;case"Texture":var k=t,N=u.getDimensions(k,!0),T=k.size;k.texture===this.outputTexture&&this.setupOutputTexture(),n.activeTexture(n.TEXTURE0+this.argumentsLength),n.bindTexture(n.TEXTURE_2D,k.texture);var I=this.getUniformLocation("user_"+r),O=this.getUniformLocation("user_"+r+"Size"),D=this.getUniformLocation("user_"+r+"Dim");n.uniform3fv(D,N),n.uniform2fv(O,T),n.uniform1i(I,this.argumentsLength);break;default:throw"Input type not supported (WebGL): "+t}this.argumentsLength++}},{key:"_getHeaderString",value:function(){return null!==this.subKernels||null!==this.subKernelProperties?"#extension GL_EXT_draw_buffers : require\n":""}},{key:"_getLoopMaxString",value:function(){return this.loopMaxIterations?" "+parseInt(this.loopMaxIterations)+".0;\n":" 1000.0;\n"}},{key:"_getConstantsString",value:function(){var t=[],e=this.threadDim,r=this.texSize;return this.hardcodeConstants?t.push("highp vec3 uOutputDim = vec3("+e[0]+","+e[1]+", "+e[2]+")","highp vec2 uTexSize = vec2("+r[0]+", "+r[1]+")"):t.push("uniform highp vec3 uOutputDim","uniform highp vec2 uTexSize"),this._linesToString(t)}},{key:"_getTextureCoordinate",value:function(){var t=this.subKernelOutputVariableNames;return null===t||t.length<1?"varying highp vec2 vTexCoord;\n":"out highp vec2 vTexCoord;\n"}},{key:"_getDecode32EndiannessString",value:function(){return"LE"===this.endianness?"":"  rgba.rgba = rgba.abgr;\n"}},{key:"_getEncode32EndiannessString",value:function(){return"LE"===this.endianness?"":"  rgba.rgba = rgba.abgr;\n"}},{key:"_getGetWraparoundString",value:function(){return this.wraparound?"  xyz = mod(xyz, texDim);\n":""}},{key:"_getGetTextureChannelString",value:function(){return this.floatTextures?this._linesToString(["  int channel = int(integerMod(index, 4.0))","  index = float(int(index) / 4)"]):""}},{key:"_getGetTextureIndexString",value:function(){return this.floatTextures?"  index = float(int(index)/4);\n":""}},{key:"_getGetResultString",value:function(){return this.floatTextures?this._linesToString(["  if (channel == 0) return texel.r","  if (channel == 1) return texel.g","  if (channel == 2) return texel.b","  if (channel == 3) return texel.a"]):"  return decode32(texel);\n"}},{key:"_getMainParamsString",value:function(t){for(var e=[],r=this.paramTypes,n=this.paramNames,i=0;i<n.length;i++){var s=t[i],o=n[i],a=r[i];if(this.hardcodeConstants)if("Array"===a||"Texture"===a){var h=u.getDimensions(s,!0),p=u.dimToTexSize({floatTextures:this.floatTextures,floatOutput:this.floatOutput},h);e.push("uniform highp sampler2D user_"+o,"highp vec2 user_"+o+"Size = vec2("+p[0]+".0, "+p[1]+".0)","highp vec3 user_"+o+"Dim = vec3("+h[0]+".0, "+h[1]+".0, "+h[2]+".0)")}else"Number"===a&&Number.isInteger(s)?e.push("highp float user_"+o+" = "+s+".0"):"Number"===a&&e.push("highp float user_"+o+" = "+s);else"Array"===a||"Texture"===a||"Input"===a?e.push("uniform highp sampler2D user_"+o,"uniform highp vec2 user_"+o+"Size","uniform highp vec3 user_"+o+"Dim"):"Number"===a&&e.push("uniform highp float user_"+o)}return this._linesToString(e)}},{key:"_getMainConstantsString",value:function(){var t=[];if(this.constants)for(var e in this.constants)if(this.constants.hasOwnProperty(e)){var r=parseFloat(this.constants[e]);Number.isInteger(r)?t.push("const float constants_"+e+" = "+parseInt(r)+".0"):t.push("const float constants_"+e+" = "+parseFloat(r))}return this._linesToString(t)}},{key:"_getKernelString",value:function(){var t=[],e=this.subKernelOutputVariableNames;if(null!==e){t.push("highp float kernelResult = 0.0");for(var r=0;r<e.length;r++)t.push("highp float "+e[r]+" = 0.0")}else t.push("highp float kernelResult = 0.0");return this._linesToString(t)+this.functionBuilder.getPrototypeString("kernel")}},{key:"_getMainResultString",value:function(){var t=this.subKernelOutputVariableNames,e=[];if(this.floatOutput&&e.push("  index *= 4.0"),this.graphical)e.push("  threadId = indexTo3D(index, uOutputDim)","  kernel()","  gl_FragColor = actualColor");else if(this.floatOutput)e.push("  threadId = indexTo3D(index, uOutputDim)","  kernel()","  gl_FragColor.r = kernelResult","  index += 1.0","  threadId = indexTo3D(index, uOutputDim)","  kernel()","  gl_FragColor.g = kernelResult","  index += 1.0","  threadId = indexTo3D(index, uOutputDim)","  kernel()","  gl_FragColor.b = kernelResult","  index += 1.0","  threadId = indexTo3D(index, uOutputDim)","  kernel()","  gl_FragColor.a = kernelResult");else if(null!==t){e.push("  threadId = indexTo3D(index, uOutputDim)"),e.push("  kernel()"),e.push("  gl_FragData[0] = encode32(kernelResult)");for(var r=0;r<t.length;r++)e.push("  gl_FragData["+(r+1)+"] = encode32("+t[r]+")")}else e.push("  threadId = indexTo3D(index, uOutputDim)","  kernel()","  gl_FragColor = encode32(kernelResult)");return this._linesToString(e)}},{key:"_linesToString",value:function(t){return t.length>0?t.join(";\n")+";\n":"\n"}},{key:"_replaceArtifacts",value:function(t,e){return t.replace(/[ ]*__([A-Z]+[0-9]*([_]?[A-Z])*)__;\n/g,function(t,r){if(e.hasOwnProperty(r))return e[r];throw"unhandled artifact "+r})}},{key:"_addKernels",value:function(){var t=this.functionBuilder,e=this._webGl;if(t.addFunctions(this.functions,{constants:this.constants,output:this.output}),t.addNativeFunctions(this.nativeFunctions),t.addKernel(this.fnString,{prototypeOnly:!1,constants:this.constants,output:this.output,debug:this.debug,loopMaxIterations:this.loopMaxIterations},this.paramNames,this.paramTypes),null!==this.subKernels){var r=this.ext=e.getExtension("WEBGL_draw_buffers");if(!r)throw new Error("could not instantiate draw buffers extension");this.subKernelOutputTextures=[],this.subKernelOutputVariableNames=[];for(var n=0;n<this.subKernels.length;n++){var i=this.subKernels[n];t.addSubKernel(i,{prototypeOnly:!1,constants:this.constants,output:this.output,debug:this.debug,loopMaxIterations:this.loopMaxIterations}),this.subKernelOutputTextures.push(this.getSubKernelTexture(n)),this.subKernelOutputVariableNames.push(i.name+"Result")}}else if(null!==this.subKernelProperties){var s=this.ext=e.getExtension("WEBGL_draw_buffers");if(!s)throw new Error("could not instantiate draw buffers extension");this.subKernelOutputTextures=[],this.subKernelOutputVariableNames=[];var o=0;for(var a in this.subKernelProperties)if(this.subKernelProperties.hasOwnProperty(a)){var u=this.subKernelProperties[a];t.addSubKernel(u,{prototypeOnly:!1,constants:this.constants,output:this.output,debug:this.debug,loopMaxIterations:this.loopMaxIterations}),this.subKernelOutputTextures.push(this.getSubKernelTexture(a)),this.subKernelOutputVariableNames.push(u.name+"Result"),o++}}}},{key:"_getFragShaderString",value:function(t){return null!==this.compiledFragShaderString?this.compiledFragShaderString:this.compiledFragShaderString=this._replaceArtifacts(p,this._getFragShaderArtifactMap(t))}},{key:"_getVertShaderString",value:function(t){return null!==this.compiledVertShaderString?this.compiledVertShaderString:this.compiledVertShaderString=l}},{key:"toString",value:function(){return c(this)}},{key:"addFunction",value:function(t){this.functionBuilder.addFunction(null,t)}}]),e}(a)},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),s=r(24);t.exports=function(){function t(e,r){n(this,t),this.paramNames=s.getParamNamesFromString(e),this.fnString=e,this.output=null,this.debug=!1,this.graphical=!1,this.loopMaxIterations=0,this.constants=null,this.wraparound=null,this.hardcodeConstants=null,this.outputToTexture=null,this.texSize=null,this._canvas=null,this._webGl=null,this.threadDim=null,this.floatTextures=null,this.floatOutput=null,this.floatOutputForce=null,this.addFunction=null,this.functions=null,this.nativeFunctions=null,this.copyData=!0,this.subKernels=null,this.subKernelProperties=null,this.subKernelNames=null,this.subKernelOutputVariableNames=null,this.functionBuilder=null,this.paramTypes=null;for(var i in r)r.hasOwnProperty(i)&&this.hasOwnProperty(i)&&(this[i]=r[i]);r.hasOwnProperty("canvas")&&(this._canvas=r.canvas),r.hasOwnProperty("output")&&this.setOutput(r.output),this._canvas||(this._canvas=s.initCanvas())}return i(t,[{key:"build",value:function(){throw new Error('"build" not defined on Base')}},{key:"setupParams",value:function(t){for(var e=this.paramTypes=[],r=0;r<t.length;r++){var n=t[r],i=s.getArgumentType(n);e.push(i)}}},{key:"setAddFunction",value:function(t){return this.addFunction=t,this}},{key:"setFunctions",value:function(t){return this.functions=t,this}},{key:"setOutput",value:function(t){return t.hasOwnProperty("x")?t.hasOwnProperty("y")?t.hasOwnProperty("z")?this.output=[t.x,t.y,t.z]:this.output=[t.x,t.y]:this.output=[t.x]:this.output=t,this}},{key:"setDebug",value:function(t){return this.debug=t,this}},{key:"setGraphical",value:function(t){return this.graphical=t,this}},{key:"setLoopMaxIterations",value:function(t){return this.loopMaxIterations=t,this}},{key:"setConstants",value:function(t){return this.constants=t,this}},{key:"setWraparound",value:function(t){return console.warn("Wraparound mode is not supported and undocumented."),this.wraparound=t,this}},{key:"setHardcodeConstants",value:function(t){return this.hardcodeConstants=t,this}},{key:"setOutputToTexture",value:function(t){return this.outputToTexture=t,this}},{key:"setFloatTextures",value:function(t){return this.floatTextures=t,this}},{key:"setFloatOutput",value:function(t){return this.floatOutput=t,this}},{key:"setFloatOutputForce",value:function(t){return this.floatOutputForce=t,this}},{key:"setCanvas",value:function(t){return this._canvas=t,this}},{key:"setWebGl",value:function(t){return this._webGl=t,this}},{key:"setCopyData",value:function(t){return this.copyData=t,this}},{key:"getCanvas",value:function(){return this._canvas}},{key:"getWebGl",value:function(){return this._webGl}},{key:"validateOptions",value:function(){throw new Error("validateOptions not defined")}},{key:"exec",value:function(){return this.execute.apply(this,arguments)}},{key:"execute",value:function(){var t=this,e=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);return s.newPromise(function(r,n){try{r(t.run.apply(t,e))}catch(i){n(i)}})}},{key:"addSubKernel",value:function(t){return null===this.subKernels&&(this.subKernels=[],this.subKernelNames=[]),this.subKernels.push(t),this.subKernelNames.push(s.getFunctionNameFromString(t)),this}},{key:"addSubKernelProperty",value:function(t,e){if(null===this.subKernelProperties&&(this.subKernelProperties={},this.subKernelNames=[]),this.subKernelProperties.hasOwnProperty(t))throw new Error("cannot add sub kernel "+t+", already defined");return this.subKernelProperties[t]=e,this.subKernelNames.push(s.getFunctionNameFromString(e)),this}},{key:"addNativeFunction",value:function(t,e){this.functionBuilder.addNativeFunction(t,e)}}]),t}()},function(t,e){"use strict";t.exports="__HEADER__;\nprecision highp float;\nprecision highp int;\nprecision highp sampler2D;\n\nconst float LOOP_MAX = __LOOP_MAX__;\n#define EPSILON 0.0000001;\n\n__CONSTANTS__;\n\nvarying highp vec2 vTexCoord;\n\nvec4 round(vec4 x) {\n  return floor(x + 0.5);\n}\n\nhighp float round(highp float x) {\n  return floor(x + 0.5);\n}\n\nvec2 integerMod(vec2 x, float y) {\n  vec2 res = floor(mod(x, y));\n  return res * step(1.0 - floor(y), -res);\n}\n\nvec3 integerMod(vec3 x, float y) {\n  vec3 res = floor(mod(x, y));\n  return res * step(1.0 - floor(y), -res);\n}\n\nvec4 integerMod(vec4 x, vec4 y) {\n  vec4 res = floor(mod(x, y));\n  return res * step(1.0 - floor(y), -res);\n}\n\nhighp float integerMod(highp float x, highp float y) {\n  highp float res = floor(mod(x, y));\n  return res * (res > floor(y) - 1.0 ? 0.0 : 1.0);\n}\n\nhighp int integerMod(highp int x, highp int y) {\n  return int(integerMod(float(x), float(y)));\n}\n\n// Here be dragons!\n// DO NOT OPTIMIZE THIS CODE\n// YOU WILL BREAK SOMETHING ON SOMEBODY'S MACHINE\n// LEAVE IT AS IT IS, LEST YOU WASTE YOUR OWN TIME\nconst vec2 MAGIC_VEC = vec2(1.0, -256.0);\nconst vec4 SCALE_FACTOR = vec4(1.0, 256.0, 65536.0, 0.0);\nconst vec4 SCALE_FACTOR_INV = vec4(1.0, 0.00390625, 0.0000152587890625, 0.0); // 1, 1/256, 1/65536\nhighp float decode32(highp vec4 rgba) {\n  __DECODE32_ENDIANNESS__;\n  rgba *= 255.0;\n  vec2 gte128;\n  gte128.x = rgba.b >= 128.0 ? 1.0 : 0.0;\n  gte128.y = rgba.a >= 128.0 ? 1.0 : 0.0;\n  float exponent = 2.0 * rgba.a - 127.0 + dot(gte128, MAGIC_VEC);\n  float res = exp2(round(exponent));\n  rgba.b = rgba.b - 128.0 * gte128.x;\n  res = dot(rgba, SCALE_FACTOR) * exp2(round(exponent-23.0)) + res;\n  res *= gte128.y * -2.0 + 1.0;\n  return res;\n}\n\nhighp vec4 encode32(highp float f) {\n  highp float F = abs(f);\n  highp float sign = f < 0.0 ? 1.0 : 0.0;\n  highp float exponent = floor(log2(F));\n  highp float mantissa = (exp2(-exponent) * F);\n  // exponent += floor(log2(mantissa));\n  vec4 rgba = vec4(F * exp2(23.0-exponent)) * SCALE_FACTOR_INV;\n  rgba.rg = integerMod(rgba.rg, 256.0);\n  rgba.b = integerMod(rgba.b, 128.0);\n  rgba.a = exponent*0.5 + 63.5;\n  rgba.ba += vec2(integerMod(exponent+127.0, 2.0), sign) * 128.0;\n  rgba = floor(rgba);\n  rgba *= 0.003921569; // 1/255\n  __ENCODE32_ENDIANNESS__;\n  return rgba;\n}\n// Dragons end here\n\nhighp float index;\nhighp vec3 threadId;\n\nhighp vec3 indexTo3D(highp float idx, highp vec3 texDim) {\n  highp float z = floor(idx / (texDim.x * texDim.y));\n  idx -= z * texDim.x * texDim.y;\n  highp float y = floor(idx / texDim.x);\n  highp float x = integerMod(idx, texDim.x);\n  return vec3(x, y, z);\n}\n\nhighp float get(highp sampler2D tex, highp vec2 texSize, highp vec3 texDim, highp float z, highp float y, highp float x) {\n  highp vec3 xyz = vec3(x, y, z);\n  xyz = floor(xyz + 0.5);\n  __GET_WRAPAROUND__;\n  highp float index = round(xyz.x + texDim.x * (xyz.y + texDim.y * xyz.z));\n  __GET_TEXTURE_CHANNEL__;\n  highp float w = round(texSize.x);\n  vec2 st = vec2(integerMod(index, w), float(int(index) / int(w))) + 0.5;\n  __GET_TEXTURE_INDEX__;\n  highp vec4 texel = texture2D(tex, st / texSize);\n  __GET_RESULT__;\n}\n\nhighp float get(highp sampler2D tex, highp vec2 texSize, highp vec3 texDim, highp float y, highp float x) {\n  return get(tex, texSize, texDim, 0.0, y, x);\n}\n\nhighp float get(highp sampler2D tex, highp vec2 texSize, highp vec3 texDim, highp float x) {\n  return get(tex, texSize, texDim, 0.0, 0.0, x);\n}\n\nhighp vec4 actualColor;\nvoid color(float r, float g, float b, float a) {\n  actualColor = vec4(r,g,b,a);\n}\n\nvoid color(float r, float g, float b) {\n  color(r,g,b,1.0);\n}\n\n__MAIN_PARAMS__;\n__MAIN_CONSTANTS__;\n__KERNEL__;\n\nvoid main(void) {\n  index = floor(vTexCoord.s * float(uTexSize.x)) + floor(vTexCoord.t * float(uTexSize.y)) * uTexSize.x;\n  __MAIN_RESULT__;\n}"},function(t,e){"use strict";t.exports="precision highp float;\nprecision highp int;\nprecision highp sampler2D;\n\nattribute highp vec2 aPos;\nattribute highp vec2 aTexCoord;\n\nvarying highp vec2 vTexCoord;\nuniform vec2 ratio;\n\nvoid main(void) {\n  gl_Position = vec4((aPos + vec2(1)) * ratio + vec2(-1), 0, 1);\n  vTexCoord = aTexCoord;\n}"},function(t,e,r){"use strict";var n=r(24),i=r(30);t.exports=function(t,e){return"() => {\n    "+i.toString()+";\n    const utils = {\n      allPropertiesOf: function "+n.allPropertiesOf.toString()+",\n      clone: function "+n.clone.toString()+",\n      splitArray: function "+n.splitArray.toString()+",\n      getArgumentType: function "+n.getArgumentType.toString()+",\n      getDimensions: function "+n.getDimensions.toString()+",\n      dimToTexSize: function "+n.dimToTexSize.toString()+",\n      copyFlatten: function "+n.copyFlatten.toString()+",\n      flatten: function "+n.flatten.toString()+",\n      systemEndianness: '"+n.systemEndianness()+"',\n      initWebGl: function "+n.initWebGl.toString()+",\n      isArray: function "+n.isArray.toString()+"\n    };\n    class "+(e||"Kernel")+" {\n      constructor() {\n        this.argumentsLength = 0;\n        this._canvas = null;\n        this._webGl = null;\n        this.built = false;\n        this.program = null;\n        this.paramNames = "+JSON.stringify(t.paramNames)+";\n        this.paramTypes = "+JSON.stringify(t.paramTypes)+";\n        this.texSize = "+JSON.stringify(t.texSize)+";\n        this.output = "+JSON.stringify(t.output)+";\n        this.compiledFragShaderString = `"+t.compiledFragShaderString+"`;\n\t\t    this.compiledVertShaderString = `"+t.compiledVertShaderString+"`;\n\t\t    this.programUniformLocationCache = {};\n\t\t    this.textureCache = {};\n\t\t    this.subKernelOutputTextures = null;\n      }\n      "+t._getFragShaderString.toString()+"\n      "+t._getVertShaderString.toString()+"\n      validateOptions() {}\n      setupParams() {}\n      setCanvas(canvas) { this._canvas = canvas; return this; }\n      setWebGl(webGl) { this._webGl = webGl; return this; }\n      "+t.getUniformLocation.toString()+"\n      "+t.setupParams.toString()+"\n      "+t.build.toString()+"\n\t\t  "+t.run.toString()+"\n\t\t  "+t._addArgument.toString()+"\n\t\t  "+t.getArgumentTexture.toString()+"\n\t\t  "+t.getTextureCache.toString()+"\n\t\t  "+t.getOutputTexture.toString()+"\n\t\t  "+t.renderOutput.toString()+"\n    };\n    return kernelRunShortcut(new Kernel());\n  };"}},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(t){return Math.floor(t+.5)}var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=r(37),h=r(38);t.exports=function(t){function e(){n(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.Node=h,t}return s(e,t),a(e,[{key:"polyfillStandardFunctions",value:function(){this.addFunction("round",o)}}],[{key:"round",value:function(t){return o(t)}}]),e}(u)},function(t,e){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();t.exports=function(){function t(e){r(this,t),this.nodeMap={},this.nativeFunctions={},this.gpu=e,this.rootKernel=null,this.Node=null}return n(t,[{key:"addNativeFunction",value:function(t,e){this.nativeFunctions[t]=e}},{key:"addFunction",value:function(t,e,r,n,i){this.addFunctionNode(new this.Node(t,e,r,n,i).setAddFunction(this.addFunction.bind(this)))}},{key:"addFunctions",value:function(t,e){if(t)if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addFunction(null,t[r],e);else for(var n in t)this.addFunction(n,t[n],e)}},{key:"addNativeFunctions",value:function(t){for(var e in t)t.hasOwnProperty(e)&&this.addNativeFunction(e,t[e])}},{key:"addFunctionNode",value:function(t){this.nodeMap[t.functionName]=t,t.isRootKernel&&(this.rootKernel=t)}},{key:"traceFunctionCalls",value:function(t,e,r){t=t||"kernel",e=e||[];var n=this.nodeMap[t];if(n){var i=e.indexOf(t);if(i===-1){e.push(t),r&&(n.parent=r),n.getFunctionString();for(var s=0;s<n.calledFunctions.length;++s)this.traceFunctionCalls(n.calledFunctions[s],e,n)}else{var o=e.splice(i,1)[0];e.push(o)}}return this.nativeFunctions[t]&&(e.indexOf(t)>=0||e.push(t)),e}},{key:"addKernel",value:function(t,e,r,n){var i=new this.Node("kernel",t,e,n);return i.setAddFunction(this.addFunction.bind(this)),i.paramNames=r,i.paramTypes=n,i.isRootKernel=!0,this.addFunctionNode(i),i}},{key:"addSubKernel",value:function(t,e,r,n){var i=new this.Node(null,t,e,r,n);return i.setAddFunction(this.addFunction.bind(this)),i.isSubKernel=!0,this.addFunctionNode(i),i}},{key:"getPrototypeString",value:function(t){return this.getPrototypes(t).join("\n")}},{key:"getPrototypes",value:function(t){return this.rootKernel.generate(),t?this.getPrototypesFromFunctionNames(this.traceFunctionCalls(t,[]).reverse()):this.getPrototypesFromFunctionNames(Object.keys(this.nodeMap))}},{key:"getStringFromFunctionNames",value:function(t){for(var e=[],r=0;r<t.length;++r){var n=this.nodeMap[t[r]];n&&e.push(this.nodeMap[t[r]].getFunctionString())}return e.join("\n")}},{key:"getPrototypesFromFunctionNames",value:function(t,e){for(var r=[],n=0;n<t.length;++n){var i=t[n],s=this.nodeMap[i];s?r.push(s.getFunctionPrototypeString(e)):this.nativeFunctions[i]&&r.push(this.nativeFunctions[i])}return r}},{key:"getPrototypeStringFromFunctionNames",value:function(t,e){return this.getPrototypesFromFunctionNames(t,e).toString()}},{key:"getString",value:function(t,e){return void 0===e&&(e={}),t?this.getStringFromFunctionNames(this.traceFunctionCalls(t,[],e).reverse(),e):this.getStringFromFunctionNames(Object.keys(this.nodeMap),e)}},{key:"polyfillStandardFunctions",value:function(){throw new Error("polyfillStandardFunctions not defined on base function builder")}}]),t}()},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(t){return t.replace(d,"((").replace(f,"((")}var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),u=r(39),h=r(24),p="Math.",l="this.",c="this.constants.",d=/decode32\(\s+encode32\(/g,f=/encode32\(\s+decode32\(/g;t.exports=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return s(e,t),a(e,[{key:"generate",value:function(){return this.debug&&console.log(this),this.prototypeOnly?e.astFunctionPrototype(this.getJsAST(),[],this).join("").trim():(this.functionStringArray=this.astGeneric(this.getJsAST(),[],this),this.functionString=o(this.functionStringArray.join("").trim()),this.functionString)}},{key:"astGeneric",value:function(t,e,r){if(null===t)throw this.astErrorOutput("NULL ast",t,r);if(Array.isArray(t)){for(var n=0;n<t.length;n++)this.astGeneric(t[n],e,r);return e}switch(t.type){case"FunctionDeclaration":return this.astFunctionDeclaration(t,e,r);case"FunctionExpression":return this.astFunctionExpression(t,e,r);case"ReturnStatement":return this.astReturnStatement(t,e,r);case"Literal":return this.astLiteral(t,e,r);case"BinaryExpression":return this.astBinaryExpression(t,e,r);case"Identifier":return this.astIdentifierExpression(t,e,r);case"AssignmentExpression":return this.astAssignmentExpression(t,e,r);case"ExpressionStatement":return this.astExpressionStatement(t,e,r);case"EmptyStatement":return this.astEmptyStatement(t,e,r);case"BlockStatement":return this.astBlockStatement(t,e,r);case"IfStatement":return this.astIfStatement(t,e,r);case"BreakStatement":return this.astBreakStatement(t,e,r);case"ContinueStatement":return this.astContinueStatement(t,e,r);case"ForStatement":return this.astForStatement(t,e,r);case"WhileStatement":return this.astWhileStatement(t,e,r);case"VariableDeclaration":return this.astVariableDeclaration(t,e,r);case"VariableDeclarator":
return this.astVariableDeclarator(t,e,r);case"ThisExpression":return this.astThisExpression(t,e,r);case"SequenceExpression":return this.astSequenceExpression(t,e,r);case"UnaryExpression":return this.astUnaryExpression(t,e,r);case"UpdateExpression":return this.astUpdateExpression(t,e,r);case"LogicalExpression":return this.astLogicalExpression(t,e,r);case"MemberExpression":return this.astMemberExpression(t,e,r);case"CallExpression":return this.astCallExpression(t,e,r);case"ArrayExpression":return this.astArrayExpression(t,e,r);case"DebuggerStatement":return this.astDebuggerStatement(t,e,r)}throw this.astErrorOutput("Unknown ast type : "+t.type,t,r)}},{key:"astFunctionDeclaration",value:function(t,e,r){return this.addFunction&&this.addFunction(null,h.getAstString(this.jsFunctionString,t)),e}},{key:"astFunctionExpression",value:function(t,e,r){if(r.isRootKernel?(e.push("void"),r.kernalAst=t):e.push(r.returnType),e.push(" "),e.push(r.functionName),e.push("("),!r.isRootKernel)for(var n=0;n<r.paramNames.length;++n){var i=r.paramNames[n];n>0&&e.push(", ");var s=r.getParamType(i);switch(s){case"Texture":case"Input":case"Array":e.push("sampler2D");break;default:e.push("float")}e.push(" "),e.push("user_"),e.push(i)}e.push(") {\n");for(var o=0;o<t.body.body.length;++o)this.astGeneric(t.body.body[o],e,r),e.push("\n");return e.push("}\n"),e}},{key:"astReturnStatement",value:function(t,e,r){return r.isRootKernel?(e.push("kernelResult = "),this.astGeneric(t.argument,e,r),e.push(";"),e.push("return;")):r.isSubKernel?(e.push(r.functionName+"Result = "),this.astGeneric(t.argument,e,r),e.push(";"),e.push("return "+r.functionName+"Result;")):(e.push("return "),this.astGeneric(t.argument,e,r),e.push(";")),e}},{key:"astLiteral",value:function(t,e,r){if(isNaN(t.value))throw this.astErrorOutput("Non-numeric literal not supported : "+t.value,t,r);return e.push(t.value),Number.isInteger(t.value)&&e.push(".0"),e}},{key:"astBinaryExpression",value:function(t,e,r){return e.push("("),"%"===t.operator?(e.push("mod("),this.astGeneric(t.left,e,r),e.push(","),this.astGeneric(t.right,e,r),e.push(")")):"==="===t.operator?(this.astGeneric(t.left,e,r),e.push("=="),this.astGeneric(t.right,e,r)):"!=="===t.operator?(this.astGeneric(t.left,e,r),e.push("!="),this.astGeneric(t.right,e,r)):(this.astGeneric(t.left,e,r),e.push(t.operator),this.astGeneric(t.right,e,r)),e.push(")"),e}},{key:"astIdentifierExpression",value:function(t,e,r){if("Identifier"!==t.type)throw this.astErrorOutput("IdentifierExpression - not an Identifier",ast,r);switch(t.name){case"gpu_threadX":e.push("threadId.x");break;case"gpu_threadY":e.push("threadId.y");break;case"gpu_threadZ":e.push("threadId.z");break;case"gpu_outputX":e.push("uOutputDim.x");break;case"gpu_outputY":e.push("uOutputDim.y");break;case"gpu_outputZ":e.push("uOutputDim.z");break;default:if(this.constants&&this.constants.hasOwnProperty(t.name))e.push("constants_"+t.name);else{var n=r.getUserParamName(t.name);null!==n?e.push("user_"+n):e.push("user_"+t.name)}}return e}},{key:"astForStatement",value:function(t,e,r){if("ForStatement"!==t.type)throw this.astErrorOutput("Invalid for statment",t,r);if(t.test&&"BinaryExpression"===t.test.type){if("Identifier"===t.test.right.type&&"<"===t.test.operator&&this.isIdentifierConstant(t.test.right.name)===!1){if(this.loopMaxIterations||(console.warn("Warning: loopMaxIterations is not set! Using default of 1000 which may result in unintended behavior."),console.warn("Set loopMaxIterations or use a for loop of fixed length to silence this message.")),e.push("for ("),this.astGeneric(t.init,e,r),this.astGeneric(t.test.left,e,r),e.push(t.test.operator),e.push("LOOP_MAX"),e.push(";"),this.astGeneric(t.update,e,r),e.push(")"),e.push("{\n"),e.push("if ("),this.astGeneric(t.test.left,e,r),e.push(t.test.operator),this.astGeneric(t.test.right,e,r),e.push(") {\n"),"BlockStatement"===t.body.type)for(var n=0;n<t.body.body.length;n++)this.astGeneric(t.body.body[n],e,r);else this.astGeneric(t.body,e,r);return e.push("} else {\n"),e.push("break;\n"),e.push("}\n"),e.push("}\n"),e}var i=JSON.parse(JSON.stringify(t.init.declarations)),s=t.update.argument;if(!Array.isArray(i)||i.length<1)throw console.log(this.jsFunctionString),new Error("Error: Incompatible for loop declaration");if(i.length>1){for(var o=null,a=0;a<i.length;a++){var u=i[a];u.id.name===s.name?(o=u,i.splice(a,1)):(e.push("float "),this.astGeneric(u,e,r),e.push(";"))}e.push("for (float "),this.astGeneric(o,e,r),e.push(";")}else e.push("for ("),this.astGeneric(t.init,e,r);return this.astGeneric(t.test,e,r),e.push(";"),this.astGeneric(t.update,e,r),e.push(")"),this.astGeneric(t.body,e,r),e}throw this.astErrorOutput("Invalid for statement",ast,r)}},{key:"astWhileStatement",value:function(t,e,r){if("WhileStatement"!==t.type)throw this.astErrorOutput("Invalid while statment",t,r);return e.push("for (float i = 0.0; i < LOOP_MAX; i++) {"),e.push("if ("),this.astGeneric(t.test,e,r),e.push(") {\n"),this.astGeneric(t.body,e,r),e.push("} else {\n"),e.push("break;\n"),e.push("}\n"),e.push("}\n"),e}},{key:"astAssignmentExpression",value:function(t,e,r){return"%="!==t.operator?(this.astGeneric(t.left,e,r),e.push(t.operator),this.astGeneric(t.right,e,r),e):(this.astGeneric(t.left,e,r),e.push("="),e.push("mod("),this.astGeneric(t.left,e,r),e.push(","),this.astGeneric(t.right,e,r),e.push(")"),void 0)}},{key:"astEmptyStatement",value:function(t,e,r){return e}},{key:"astBlockStatement",value:function(t,e,r){e.push("{\n");for(var n=0;n<t.body.length;n++)this.astGeneric(t.body[n],e,r);return e.push("}\n"),e}},{key:"astExpressionStatement",value:function(t,e,r){return this.astGeneric(t.expression,e,r),e.push(";\n"),e}},{key:"astVariableDeclaration",value:function(t,e,r){e.push("float ");for(var n=0;n<t.declarations.length;n++)n>0&&e.push(","),this.astGeneric(t.declarations[n],e,r);return e.push(";"),e}},{key:"astVariableDeclarator",value:function(t,e,r){return this.astGeneric(t.id,e,r),null!==t.init&&(e.push("="),this.astGeneric(t.init,e,r)),e}},{key:"astIfStatement",value:function(t,e,r){return e.push("if ("),this.astGeneric(t.test,e,r),e.push(")"),"BlockStatement"===t.consequent.type?this.astGeneric(t.consequent,e,r):(e.push(" {\n"),this.astGeneric(t.consequent,e,r),e.push("\n}\n")),t.alternate&&(e.push("else "),"BlockStatement"===t.alternate.type?this.astGeneric(t.alternate,e,r):(e.push(" {\n"),this.astGeneric(t.alternate,e,r),e.push("\n}\n"))),e}},{key:"astBreakStatement",value:function(t,e,r){return e.push("break;\n"),e}},{key:"astContinueStatement",value:function(t,e,r){return e.push("continue;\n"),e}},{key:"astLogicalExpression",value:function(t,e,r){return e.push("("),this.astGeneric(t.left,e,r),e.push(t.operator),this.astGeneric(t.right,e,r),e.push(")"),e}},{key:"astUpdateExpression",value:function(t,e,r){return t.prefix?(e.push(t.operator),this.astGeneric(t.argument,e,r)):(this.astGeneric(t.argument,e,r),e.push(t.operator)),e}},{key:"astUnaryExpression",value:function(t,e,r){return t.prefix?(e.push(t.operator),this.astGeneric(t.argument,e,r)):(this.astGeneric(t.argument,e,r),e.push(t.operator)),e}},{key:"astThisExpression",value:function(t,e,r){return e.push("this"),e}},{key:"astMemberExpression",value:function(t,e,r){if(t.computed)if("Identifier"===t.object.type){var n=t.object.name,i=(r.functionName||"kernel",!1);if(r.paramNames){var s=r.paramNames.indexOf(n);s>=0&&"float"===r.paramTypes[s]&&(i=!0)}i?(this.astGeneric(t.object,e,r),e.push("[int("),this.astGeneric(t.property,e,r),e.push(")]")):(e.push("get("),this.astGeneric(t.object,e,r),e.push(", vec2("),this.astGeneric(t.object,e,r),e.push("Size[0],"),this.astGeneric(t.object,e,r),e.push("Size[1]), vec3("),this.astGeneric(t.object,e,r),e.push("Dim[0],"),this.astGeneric(t.object,e,r),e.push("Dim[1],"),this.astGeneric(t.object,e,r),e.push("Dim[2]"),e.push("), "),this.astGeneric(t.property,e,r),e.push(")"))}else{this.astGeneric(t.object,e,r);var o=e.pop();e.push(","),this.astGeneric(t.property,e,r),e.push(o)}else{var a=this.astMemberExpressionUnroll(t),u=a.toLowerCase();switch(0===a.indexOf(c)&&(a="constants_"+a.slice(c.length)),u){case"this.thread.x":e.push("threadId.x");break;case"this.thread.y":e.push("threadId.y");break;case"this.thread.z":e.push("threadId.z");break;case"this.output.x":e.push(this.output[0]+".0");break;case"this.output.y":e.push(this.output[1]+".0");break;case"this.output.z":e.push(this.output[2]+".0");break;default:e.push(a)}}return e}},{key:"astSequenceExpression",value:function(t,e,r){for(var n=0;n<t.expressions.length;n++)n>0&&e.push(","),this.astGeneric(t.expressions,e,r);return e}},{key:"astCallExpression",value:function(t,e,r){if(t.callee){var n=this.astMemberExpressionUnroll(t.callee);0===n.indexOf(p)&&(n=n.slice(p.length)),0===n.indexOf(l)&&(n=n.slice(l.length)),r.calledFunctions.indexOf(n)<0&&r.calledFunctions.push(n),r.hasOwnProperty("funcName")||(r.calledFunctionsArguments[n]=[]);var i=[];r.calledFunctionsArguments[n].push(i),e.push(n),e.push("(");for(var s=0;s<t.arguments.length;++s){var o=t.arguments[s];if(s>0&&e.push(", "),this.astGeneric(o,e,r),"Identifier"===o.type){var a=r.paramNames.indexOf(o.name);a===-1?i.push(null):i.push({name:o.name,type:r.paramTypes[a]})}else i.push(null)}return e.push(")"),e}throw this.astErrorOutput("Unknown CallExpression",t,r)}},{key:"astArrayExpression",value:function(t,e,r){var n=t.elements.length;e.push("float["+n+"](");for(var i=0;i<n;++i){i>0&&e.push(", ");var s=t.elements[i];this.astGeneric(s,e,r)}return e.push(")"),e}},{key:"getFunctionPrototypeString",value:function(){return this.webGlFunctionPrototypeString?this.webGlFunctionPrototypeString:this.webGlFunctionPrototypeString=this.generate()}},{key:"build",value:function(){return this.getFunctionPrototypeString().length>0}}],[{key:"astFunctionPrototype",value:function(t,e,r){if(r.isRootKernel||r.isSubKernel)return e;e.push(r.returnType),e.push(" "),e.push(r.functionName),e.push("(");for(var n=0;n<r.paramNames.length;++n)n>0&&e.push(", "),e.push(r.paramTypes[n]),e.push(" "),e.push("user_"),e.push(r.paramNames[n]);return e.push(");\n"),e}}]),e}(u)},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),utils=__webpack_require__(24),acorn=__webpack_require__(40);module.exports=function(){function BaseFunctionNode(t,e,r,n,i){if(_classCallCheck(this,BaseFunctionNode),this.calledFunctions=[],this.calledFunctionsArguments={},this.initVariables=[],this.readVariables=[],this.writeVariables=[],this.addFunction=null,this.isRootKernel=!1,this.isSubKernel=!1,this.parent=null,this.debug=null,this.prototypeOnly=null,this.constants=null,this.output=null,r&&(r.hasOwnProperty("debug")&&(this.debug=r.debug),r.hasOwnProperty("prototypeOnly")&&(this.prototypeOnly=r.prototypeOnly),r.hasOwnProperty("constants")&&(this.constants=r.constants),r.hasOwnProperty("output")&&(this.output=r.output),r.hasOwnProperty("loopMaxIterations")&&(this.loopMaxIterations=r.loopMaxIterations)),!e)throw"jsFunction, parameter is missing";if(this.jsFunctionString=e.toString(),!utils.isFunctionString(this.jsFunctionString))throw console.error("jsFunction, to string conversion check failed: not a function?",this.jsFunctionString),"jsFunction, to string conversion check failed: not a function?";if(utils.isFunction(e)?this.jsFunction=e:this.jsFunction=null,this.functionName=t||e&&e.name||utils.getFunctionNameFromString(this.jsFunctionString),!this.functionName)throw"jsFunction, missing name argument or value";if(this.paramNames=utils.getParamNamesFromString(this.jsFunctionString),n){if(Array.isArray(n)){if(n.length!==this.paramNames.length)throw"Invalid argument type array length, against function length -> ("+n.length+","+this.paramNames.length+")";this.paramTypes=n}else if("object"===("undefined"==typeof n?"undefined":_typeof(n))){var s=Object.keys(n);if(n.hasOwnProperty("returns")&&(this.returnType=n.returns,s.splice(s.indexOf("returns"),1)),s.length>0&&s.length!==this.paramNames.length)throw"Invalid argument type array length, against function length -> ("+s.length+","+this.paramNames.length+")";this.paramTypes=this.paramNames.map(function(t){return n.hasOwnProperty(t)?n[t]:"float"})}}else this.paramTypes=[];this.returnType||(this.returnType=i||"float")}return _createClass(BaseFunctionNode,[{key:"isIdentifierConstant",value:function(t){return!!this.constants&&this.constants.hasOwnProperty(t)}},{key:"setAddFunction",value:function(t){return this.addFunction=t,this}},{key:"getJsFunction",value:function getJsFunction(){if(this.jsFunction)return this.jsFunction;if(this.jsFunctionString)return this.jsFunction=eval(this.jsFunctionString),this.jsFunction;throw"Missing jsFunction, and jsFunctionString parameter"}},{key:"astMemberExpressionUnroll",value:function(t,e){if("Identifier"===t.type)return t.name;if("ThisExpression"===t.type)return"this";if("MemberExpression"===t.type&&t.object&&t.property)return t.object.hasOwnProperty("name")&&"_"===t.object.name[0]?this.astMemberExpressionUnroll(t.property,e):this.astMemberExpressionUnroll(t.object,e)+"."+this.astMemberExpressionUnroll(t.property,e);if(t.hasOwnProperty("expressions")){var r=t.expressions[0];if("Literal"===r.type&&0===r.value&&2===t.expressions.length)return this.astMemberExpressionUnroll(t.expressions[1])}throw this.astErrorOutput("Unknown CallExpression_unroll",t,e)}},{key:"getJsAST",value:function(t){if(this.jsFunctionAST)return this.jsFunctionAST;if(t=t||acorn,null===t)throw"Missing JS to AST parser";var e=t.parse("var "+this.functionName+" = "+this.jsFunctionString+";",{locations:!0});if(null===e)throw"Failed to parse JS code";var r=e.body[0].declarations[0].init;return this.jsFunctionAST=r,r}},{key:"getFunctionString",value:function(){return this.generate(),this.functionString}},{key:"setFunctionString",value:function(t){this.functionString=t}},{key:"getParamType",value:function(t){var e=this.paramNames.indexOf(t);if(e===-1)return null;if(!this.parent)return null;if(this.paramTypes[e])return this.paramTypes[e];for(var r=this.parent.calledFunctionsArguments[this.functionName],n=0;n<r.length;n++){var i=r[n];if(null!==i[e])return this.paramTypes[e]=i[e].type}return null}},{key:"getUserParamName",value:function(t){var e=this.paramNames.indexOf(t);if(e===-1)return null;if(!this.parent)return null;for(var r=this.parent.calledFunctionsArguments[this.functionName],n=0;n<r.length;n++){var i=r[n];if(null!==i[e])return i[e].name}return null}},{key:"generate",value:function(t){throw new Error("generate not defined on BaseFunctionNode")}},{key:"astErrorOutput",value:function(t,e,r){return console.error(utils.getAstString(this.jsFunctionString,e)),console.error(t,e,r),t}},{key:"astDebuggerStatement",value:function(t,e,r){return e}}]),BaseFunctionNode}()},function(t,e,r){var n,n;!function(e){t.exports=e()}(function(){return function t(e,r,i){function s(a,u){if(!r[a]){if(!e[a]){var h="function"==typeof n&&n;if(!u&&h)return n(a,!0);if(o)return o(a,!0);var p=new Error("Cannot find module '"+a+"'");throw p.code="MODULE_NOT_FOUND",p}var l=r[a]={exports:{}};e[a][0].call(l.exports,function(t){var r=e[a][1][t];return s(r?r:t)},l,l.exports,t,e,r,i)}return r[a].exports}for(var o="function"==typeof n&&n,a=0;a<i.length;a++)s(i[a]);return s}({1:[function(t,e,r){"use strict";var n=t("./tokentype"),i=t("./state"),s=i.Parser.prototype;s.checkPropClash=function(t,e){if(!(this.options.ecmaVersion>=6&&(t.computed||t.method||t.shorthand))){var r=t.key,n=void 0;switch(r.type){case"Identifier":n=r.name;break;case"Literal":n=String(r.value);break;default:return}var i=t.kind;if(this.options.ecmaVersion>=6)return void("__proto__"===n&&"init"===i&&(e.proto&&this.raise(r.start,"Redefinition of __proto__ property"),e.proto=!0));n="$"+n;var s=e[n];if(s){var o="init"!==i;(!this.strict&&!o||!s[i])&&o^s.init||this.raise(r.start,"Redefinition of property")}else s=e[n]={init:!1,get:!1,set:!1};s[i]=!0}},s.parseExpression=function(t,e){var r=this.start,i=this.startLoc,s=this.parseMaybeAssign(t,e);if(this.type===n.types.comma){var o=this.startNodeAt(r,i);for(o.expressions=[s];this.eat(n.types.comma);)o.expressions.push(this.parseMaybeAssign(t,e));return this.finishNode(o,"SequenceExpression")}return s},s.parseMaybeAssign=function(t,e,r){if(this.type==n.types._yield&&this.inGenerator)return this.parseYield();var i=!1;e||(e={shorthandAssign:0,trailingComma:0},i=!0);var s=this.start,o=this.startLoc;this.type!=n.types.parenL&&this.type!=n.types.name||(this.potentialArrowAt=this.start);var a=this.parseMaybeConditional(t,e);if(r&&(a=r.call(this,a,s,o)),this.type.isAssign){i&&this.checkPatternErrors(e,!0);var u=this.startNodeAt(s,o);return u.operator=this.value,u.left=this.type===n.types.eq?this.toAssignable(a):a,e.shorthandAssign=0,this.checkLVal(a),this.next(),u.right=this.parseMaybeAssign(t),this.finishNode(u,"AssignmentExpression")}return i&&this.checkExpressionErrors(e,!0),a},s.parseMaybeConditional=function(t,e){var r=this.start,i=this.startLoc,s=this.parseExprOps(t,e);if(this.checkExpressionErrors(e))return s;if(this.eat(n.types.question)){var o=this.startNodeAt(r,i);return o.test=s,o.consequent=this.parseMaybeAssign(),this.expect(n.types.colon),o.alternate=this.parseMaybeAssign(t),this.finishNode(o,"ConditionalExpression")}return s},s.parseExprOps=function(t,e){var r=this.start,n=this.startLoc,i=this.parseMaybeUnary(e);return this.checkExpressionErrors(e)?i:this.parseExprOp(i,r,n,-1,t)},s.parseExprOp=function(t,e,r,i,s){var o=this.type.binop;if(null!=o&&(!s||this.type!==n.types._in)&&o>i){var a=this.startNodeAt(e,r);a.left=t,a.operator=this.value;var u=this.type;this.next();var h=this.start,p=this.startLoc;return a.right=this.parseExprOp(this.parseMaybeUnary(),h,p,o,s),this.finishNode(a,u===n.types.logicalOR||u===n.types.logicalAND?"LogicalExpression":"BinaryExpression"),this.parseExprOp(a,e,r,i,s)}return t},s.parseMaybeUnary=function(t){if(this.type.prefix){var e=this.startNode(),r=this.type===n.types.incDec;return e.operator=this.value,e.prefix=!0,this.next(),e.argument=this.parseMaybeUnary(),this.checkExpressionErrors(t,!0),r?this.checkLVal(e.argument):this.strict&&"delete"===e.operator&&"Identifier"===e.argument.type&&this.raise(e.start,"Deleting local variable in strict mode"),this.finishNode(e,r?"UpdateExpression":"UnaryExpression")}var i=this.start,s=this.startLoc,o=this.parseExprSubscripts(t);if(this.checkExpressionErrors(t))return o;for(;this.type.postfix&&!this.canInsertSemicolon();){var e=this.startNodeAt(i,s);e.operator=this.value,e.prefix=!1,e.argument=o,this.checkLVal(o),this.next(),o=this.finishNode(e,"UpdateExpression")}return o},s.parseExprSubscripts=function(t){var e=this.start,r=this.startLoc,n=this.parseExprAtom(t),i="ArrowFunctionExpression"===n.type&&")"!==this.input.slice(this.lastTokStart,this.lastTokEnd);return this.checkExpressionErrors(t)||i?n:this.parseSubscripts(n,e,r)},s.parseSubscripts=function(t,e,r,i){for(;;)if(this.eat(n.types.dot)){var s=this.startNodeAt(e,r);s.object=t,s.property=this.parseIdent(!0),s.computed=!1,t=this.finishNode(s,"MemberExpression")}else if(this.eat(n.types.bracketL)){var s=this.startNodeAt(e,r);s.object=t,s.property=this.parseExpression(),s.computed=!0,this.expect(n.types.bracketR),t=this.finishNode(s,"MemberExpression")}else if(!i&&this.eat(n.types.parenL)){var s=this.startNodeAt(e,r);s.callee=t,s.arguments=this.parseExprList(n.types.parenR,!1),t=this.finishNode(s,"CallExpression")}else{if(this.type!==n.types.backQuote)return t;var s=this.startNodeAt(e,r);s.tag=t,s.quasi=this.parseTemplate(),t=this.finishNode(s,"TaggedTemplateExpression")}},s.parseExprAtom=function(t){var e=void 0,r=this.potentialArrowAt==this.start;switch(this.type){case n.types._super:this.inFunction||this.raise(this.start,"'super' outside of function or class");case n.types._this:var i=this.type===n.types._this?"ThisExpression":"Super";return e=this.startNode(),this.next(),this.finishNode(e,i);case n.types._yield:this.inGenerator&&this.unexpected();case n.types.name:var s=this.start,o=this.startLoc,a=this.parseIdent(this.type!==n.types.name);return r&&!this.canInsertSemicolon()&&this.eat(n.types.arrow)?this.parseArrowExpression(this.startNodeAt(s,o),[a]):a;case n.types.regexp:var u=this.value;return e=this.parseLiteral(u.value),e.regex={pattern:u.pattern,flags:u.flags},e;case n.types.num:case n.types.string:return this.parseLiteral(this.value);case n.types._null:case n.types._true:case n.types._false:return e=this.startNode(),e.value=this.type===n.types._null?null:this.type===n.types._true,e.raw=this.type.keyword,this.next(),this.finishNode(e,"Literal");case n.types.parenL:return this.parseParenAndDistinguishExpression(r);case n.types.bracketL:return e=this.startNode(),this.next(),this.options.ecmaVersion>=7&&this.type===n.types._for?this.parseComprehension(e,!1):(e.elements=this.parseExprList(n.types.bracketR,!0,!0,t),this.finishNode(e,"ArrayExpression"));case n.types.braceL:return this.parseObj(!1,t);case n.types._function:return e=this.startNode(),this.next(),this.parseFunction(e,!1);case n.types._class:return this.parseClass(this.startNode(),!1);case n.types._new:return this.parseNew();case n.types.backQuote:return this.parseTemplate();default:this.unexpected()}},s.parseLiteral=function(t){var e=this.startNode();return e.value=t,e.raw=this.input.slice(this.start,this.end),this.next(),this.finishNode(e,"Literal")},s.parseParenExpression=function(){this.expect(n.types.parenL);var t=this.parseExpression();return this.expect(n.types.parenR),t},s.parseParenAndDistinguishExpression=function(t){var e=this.start,r=this.startLoc,i=void 0;if(this.options.ecmaVersion>=6){if(this.next(),this.options.ecmaVersion>=7&&this.type===n.types._for)return this.parseComprehension(this.startNodeAt(e,r),!0);for(var s=this.start,o=this.startLoc,a=[],u=!0,h={shorthandAssign:0,trailingComma:0},p=void 0,l=void 0;this.type!==n.types.parenR;){if(u?u=!1:this.expect(n.types.comma),this.type===n.types.ellipsis){p=this.start,a.push(this.parseParenItem(this.parseRest()));break}this.type!==n.types.parenL||l||(l=this.start),a.push(this.parseMaybeAssign(!1,h,this.parseParenItem))}var c=this.start,d=this.startLoc;if(this.expect(n.types.parenR),t&&!this.canInsertSemicolon()&&this.eat(n.types.arrow))return this.checkPatternErrors(h,!0),l&&this.unexpected(l),this.parseParenArrowList(e,r,a);a.length||this.unexpected(this.lastTokStart),p&&this.unexpected(p),this.checkExpressionErrors(h,!0),a.length>1?(i=this.startNodeAt(s,o),i.expressions=a,this.finishNodeAt(i,"SequenceExpression",c,d)):i=a[0]}else i=this.parseParenExpression();if(this.options.preserveParens){var f=this.startNodeAt(e,r);return f.expression=i,this.finishNode(f,"ParenthesizedExpression")}return i},s.parseParenItem=function(t){return t},s.parseParenArrowList=function(t,e,r){return this.parseArrowExpression(this.startNodeAt(t,e),r)};var o=[];s.parseNew=function(){var t=this.startNode(),e=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(n.types.dot))return t.meta=e,t.property=this.parseIdent(!0),"target"!==t.property.name&&this.raise(t.property.start,"The only valid meta property for new is new.target"),this.inFunction||this.raise(t.start,"new.target can only be used in functions"),this.finishNode(t,"MetaProperty");var r=this.start,i=this.startLoc;return t.callee=this.parseSubscripts(this.parseExprAtom(),r,i,!0),this.eat(n.types.parenL)?t.arguments=this.parseExprList(n.types.parenR,!1):t.arguments=o,this.finishNode(t,"NewExpression")},s.parseTemplateElement=function(){var t=this.startNode();return t.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,"\n"),cooked:this.value},this.next(),t.tail=this.type===n.types.backQuote,this.finishNode(t,"TemplateElement")},s.parseTemplate=function(){var t=this.startNode();this.next(),t.expressions=[];var e=this.parseTemplateElement();for(t.quasis=[e];!e.tail;)this.expect(n.types.dollarBraceL),t.expressions.push(this.parseExpression()),this.expect(n.types.braceR),t.quasis.push(e=this.parseTemplateElement());return this.next(),this.finishNode(t,"TemplateLiteral")},s.parseObj=function(t,e){var r=this.startNode(),i=!0,s={};for(r.properties=[],this.next();!this.eat(n.types.braceR);){if(i)i=!1;else if(this.expect(n.types.comma),this.afterTrailingComma(n.types.braceR))break;var o=this.startNode(),a=void 0,u=void 0,h=void 0;this.options.ecmaVersion>=6&&(o.method=!1,o.shorthand=!1,(t||e)&&(u=this.start,h=this.startLoc),t||(a=this.eat(n.types.star))),this.parsePropertyName(o),this.parsePropertyValue(o,t,a,u,h,e),this.checkPropClash(o,s),r.properties.push(this.finishNode(o,"Property"))}return this.finishNode(r,t?"ObjectPattern":"ObjectExpression")},s.parsePropertyValue=function(t,e,r,i,s,o){if(this.eat(n.types.colon))t.value=e?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,o),t.kind="init";else if(this.options.ecmaVersion>=6&&this.type===n.types.parenL)e&&this.unexpected(),t.kind="init",t.method=!0,t.value=this.parseMethod(r);else if(this.options.ecmaVersion>=5&&!t.computed&&"Identifier"===t.key.type&&("get"===t.key.name||"set"===t.key.name)&&this.type!=n.types.comma&&this.type!=n.types.braceR){(r||e)&&this.unexpected(),t.kind=t.key.name,this.parsePropertyName(t),t.value=this.parseMethod(!1);var a="get"===t.kind?0:1;if(t.value.params.length!==a){var u=t.value.start;"get"===t.kind?this.raise(u,"getter should have no params"):this.raise(u,"setter should have exactly one param")}"set"===t.kind&&"RestElement"===t.value.params[0].type&&this.raise(t.value.params[0].start,"Setter cannot use rest params")}else this.options.ecmaVersion>=6&&!t.computed&&"Identifier"===t.key.type?(t.kind="init",e?((this.keywords.test(t.key.name)||(this.strict?this.reservedWordsStrictBind:this.reservedWords).test(t.key.name))&&this.raise(t.key.start,"Binding "+t.key.name),t.value=this.parseMaybeDefault(i,s,t.key)):this.type===n.types.eq&&o?(o.shorthandAssign||(o.shorthandAssign=this.start),t.value=this.parseMaybeDefault(i,s,t.key)):t.value=t.key,t.shorthand=!0):this.unexpected()},s.parsePropertyName=function(t){if(this.options.ecmaVersion>=6){if(this.eat(n.types.bracketL))return t.computed=!0,t.key=this.parseMaybeAssign(),this.expect(n.types.bracketR),t.key;t.computed=!1}return t.key=this.type===n.types.num||this.type===n.types.string?this.parseExprAtom():this.parseIdent(!0)},s.initFunction=function(t){t.id=null,this.options.ecmaVersion>=6&&(t.generator=!1,t.expression=!1)},s.parseMethod=function(t){var e=this.startNode();return this.initFunction(e),this.expect(n.types.parenL),e.params=this.parseBindingList(n.types.parenR,!1,!1),this.options.ecmaVersion>=6&&(e.generator=t),this.parseFunctionBody(e,!1),this.finishNode(e,"FunctionExpression")},s.parseArrowExpression=function(t,e){return this.initFunction(t),t.params=this.toAssignableList(e,!0),this.parseFunctionBody(t,!0),this.finishNode(t,"ArrowFunctionExpression")},s.parseFunctionBody=function(t,e){var r=e&&this.type!==n.types.braceL;if(r)t.body=this.parseMaybeAssign(),t.expression=!0;else{var i=this.inFunction,s=this.inGenerator,o=this.labels;this.inFunction=!0,this.inGenerator=t.generator,this.labels=[],t.body=this.parseBlock(!0),t.expression=!1,this.inFunction=i,this.inGenerator=s,this.labels=o}if(this.strict||!r&&t.body.body.length&&this.isUseStrict(t.body.body[0])){var a=this.strict;this.strict=!0,t.id&&this.checkLVal(t.id,!0),this.checkParams(t),this.strict=a}else e&&this.checkParams(t)},s.checkParams=function(t){for(var e={},r=0;r<t.params.length;r++)this.checkLVal(t.params[r],!0,e)},s.parseExprList=function(t,e,r,i){for(var s=[],o=!0;!this.eat(t);){if(o)o=!1;else if(this.expect(n.types.comma),this.type===t&&i&&!i.trailingComma&&(i.trailingComma=this.lastTokStart),e&&this.afterTrailingComma(t))break;var a=void 0;a=r&&this.type===n.types.comma?null:this.type===n.types.ellipsis?this.parseSpread(i):this.parseMaybeAssign(!1,i),s.push(a)}return s},s.parseIdent=function(t){var e=this.startNode();return t&&"never"==this.options.allowReserved&&(t=!1),this.type===n.types.name?(!t&&(this.strict?this.reservedWordsStrict:this.reservedWords).test(this.value)&&(this.options.ecmaVersion>=6||this.input.slice(this.start,this.end).indexOf("\\")==-1)&&this.raise(this.start,"The keyword '"+this.value+"' is reserved"),e.name=this.value):t&&this.type.keyword?e.name=this.type.keyword:this.unexpected(),this.next(),this.finishNode(e,"Identifier")},s.parseYield=function(){var t=this.startNode();return this.next(),this.type==n.types.semi||this.canInsertSemicolon()||this.type!=n.types.star&&!this.type.startsExpr?(t.delegate=!1,t.argument=null):(t.delegate=this.eat(n.types.star),t.argument=this.parseMaybeAssign()),this.finishNode(t,"YieldExpression")},s.parseComprehension=function(t,e){for(t.blocks=[];this.type===n.types._for;){var r=this.startNode();this.next(),this.expect(n.types.parenL),r.left=this.parseBindingAtom(),this.checkLVal(r.left,!0),this.expectContextual("of"),r.right=this.parseExpression(),this.expect(n.types.parenR),t.blocks.push(this.finishNode(r,"ComprehensionBlock"))}return t.filter=this.eat(n.types._if)?this.parseParenExpression():null,t.body=this.parseExpression(),this.expect(e?n.types.parenR:n.types.bracketR),t.generator=e,this.finishNode(t,"ComprehensionExpression")}},{"./state":10,"./tokentype":14}],2:[function(t,e,r){"use strict";function n(t,e){for(var r=65536,n=0;n<e.length;n+=2){if(r+=e[n],r>t)return!1;if(r+=e[n+1],r>=t)return!0}}function i(t,e){return t<65?36===t:t<91||(t<97?95===t:t<123||(t<=65535?t>=170&&l.test(String.fromCharCode(t)):e!==!1&&n(t,d)))}function s(t,e){return t<48?36===t:t<58||!(t<65)&&(t<91||(t<97?95===t:t<123||(t<=65535?t>=170&&c.test(String.fromCharCode(t)):e!==!1&&(n(t,d)||n(t,f)))))}r.__esModule=!0,r.isIdentifierStart=i,r.isIdentifierChar=s;var o={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"};r.reservedWords=o;var a="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",u={5:a,6:a+" let const class extends export import yield super"};r.keywords=u;var h="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢲऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕ℘-ℝℤΩℨK-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖ゛-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞭꞰꞱꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭟꭤꭥꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",p="‌‍·̀-ͯ·҃-֑҇-ׇֽֿׁׂׅׄؐ-ًؚ-٩ٰۖ-ۜ۟-۪ۤۧۨ-ۭ۰-۹ܑܰ-݊ަ-ް߀-߉߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࣤ-ःऺ-़ा-ॏ॑-ॗॢॣ०-९ঁ-ঃ়া-ৄেৈো-্ৗৢৣ০-৯ਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣ૦-૯ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୢୣ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఀ-ఃా-ౄె-ైొ-్ౕౖౢౣ౦-౯ಁ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣ೦-೯ഁ-ഃാ-ൄെ-ൈൊ-്ൗൢൣ൦-൯ංඃ්ා-ුූෘ-ෟ෦-෯ෲෳัิ-ฺ็-๎๐-๙ັິ-ູົຼ່-ໍ໐-໙༘༙༠-༩༹༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှ၀-၉ၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟፩-፱ᜒ-᜔ᜲ-᜴ᝒᝓᝲᝳ឴-៓៝០-៩᠋-᠍᠐-᠙ᢩᤠ-ᤫᤰ-᤻᥆-᥏ᦰ-ᧀᧈᧉ᧐-᧚ᨗ-ᨛᩕ-ᩞ᩠-᩿᩼-᪉᪐-᪙᪰-᪽ᬀ-ᬄ᬴-᭄᭐-᭙᭫-᭳ᮀ-ᮂᮡ-ᮭ᮰-᮹᯦-᯳ᰤ-᰷᱀-᱉᱐-᱙᳐-᳔᳒-᳨᳭ᳲ-᳴᳸᳹᷀-᷵᷼-᷿‿⁀⁔⃐-⃥⃜⃡-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯꘠-꘩꙯ꙴ-꙽ꚟ꛰꛱ꠂ꠆ꠋꠣ-ꠧꢀꢁꢴ-꣄꣐-꣙꣠-꣱꤀-꤉ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀꧐-꧙ꧥ꧰-꧹ꨩ-ꨶꩃꩌꩍ꩐-꩙ꩻ-ꩽꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫫ-ꫯꫵ꫶ꯣ-ꯪ꯬꯭꯰-꯹ﬞ︀-️︠-︭︳︴﹍-﹏０-９＿",l=new RegExp("["+h+"]"),c=new RegExp("["+h+p+"]");
h=p=null;var d=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,17,26,6,37,11,29,3,35,5,7,2,4,43,157,99,39,9,51,157,310,10,21,11,7,153,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,98,21,11,25,71,55,7,1,65,0,16,3,2,2,2,26,45,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,955,52,76,44,33,24,27,35,42,34,4,0,13,47,15,3,22,0,38,17,2,24,133,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,32,4,287,47,21,1,2,0,185,46,82,47,21,0,60,42,502,63,32,0,449,56,1288,920,104,110,2962,1070,13266,568,8,30,114,29,19,47,17,3,32,20,6,18,881,68,12,0,67,12,16481,1,3071,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,4149,196,1340,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42710,42,4148,12,221,16355,541],f=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,1306,2,54,14,32,9,16,3,46,10,54,9,7,2,37,13,2,9,52,0,13,2,49,13,16,9,83,11,168,11,6,9,8,2,57,0,2,6,3,1,3,2,10,0,11,1,3,6,4,4,316,19,13,9,214,6,3,8,112,16,16,9,82,12,9,9,535,9,20855,9,135,4,60,6,26,9,1016,45,17,3,19723,1,5319,4,4,5,9,7,3,6,31,3,149,2,1418,49,4305,6,792618,239]},{}],3:[function(t,e,r){"use strict";function n(t,e){return new o.Parser(e,t).parse()}function i(t,e,r){var n=new o.Parser(r,t,e);return n.nextToken(),n.parseExpression()}function s(t,e){return new o.Parser(e,t)}r.__esModule=!0,r.parse=n,r.parseExpressionAt=i,r.tokenizer=s;var o=t("./state");t("./parseutil"),t("./statement"),t("./lval"),t("./expression"),t("./location"),r.Parser=o.Parser,r.plugins=o.plugins;var a=t("./options");r.defaultOptions=a.defaultOptions;var u=t("./locutil");r.Position=u.Position,r.SourceLocation=u.SourceLocation,r.getLineInfo=u.getLineInfo;var h=t("./node");r.Node=h.Node;var p=t("./tokentype");r.TokenType=p.TokenType,r.tokTypes=p.types;var l=t("./tokencontext");r.TokContext=l.TokContext,r.tokContexts=l.types;var c=t("./identifier");r.isIdentifierChar=c.isIdentifierChar,r.isIdentifierStart=c.isIdentifierStart;var d=t("./tokenize");r.Token=d.Token;var f=t("./whitespace");r.isNewLine=f.isNewLine,r.lineBreak=f.lineBreak,r.lineBreakG=f.lineBreakG;var g="2.7.0";r.version=g},{"./expression":1,"./identifier":2,"./location":4,"./locutil":5,"./lval":6,"./node":7,"./options":8,"./parseutil":9,"./state":10,"./statement":11,"./tokencontext":12,"./tokenize":13,"./tokentype":14,"./whitespace":16}],4:[function(t,e,r){"use strict";var n=t("./state"),i=t("./locutil"),s=n.Parser.prototype;s.raise=function(t,e){var r=i.getLineInfo(this.input,t);e+=" ("+r.line+":"+r.column+")";var n=new SyntaxError(e);throw n.pos=t,n.loc=r,n.raisedAt=this.pos,n},s.curPosition=function(){if(this.options.locations)return new i.Position(this.curLine,this.pos-this.lineStart)}},{"./locutil":5,"./state":10}],5:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var r=1,n=0;;){s.lineBreakG.lastIndex=n;var i=s.lineBreakG.exec(t);if(!(i&&i.index<e))return new o(r,e-n);++r,n=i.index+i[0].length}}r.__esModule=!0,r.getLineInfo=i;var s=t("./whitespace"),o=function(){function t(e,r){n(this,t),this.line=e,this.column=r}return t.prototype.offset=function(e){return new t(this.line,this.column+e)},t}();r.Position=o;var a=function u(t,e,r){n(this,u),this.start=e,this.end=r,null!==t.sourceFile&&(this.source=t.sourceFile)};r.SourceLocation=a},{"./whitespace":16}],6:[function(t,e,r){"use strict";var n=t("./tokentype"),i=t("./state"),s=t("./util"),o=i.Parser.prototype;o.toAssignable=function(t,e){if(this.options.ecmaVersion>=6&&t)switch(t.type){case"Identifier":case"ObjectPattern":case"ArrayPattern":break;case"ObjectExpression":t.type="ObjectPattern";for(var r=0;r<t.properties.length;r++){var n=t.properties[r];"init"!==n.kind&&this.raise(n.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(n.value,e)}break;case"ArrayExpression":t.type="ArrayPattern",this.toAssignableList(t.elements,e);break;case"AssignmentExpression":if("="!==t.operator){this.raise(t.left.end,"Only '=' operator can be used for specifying default value.");break}t.type="AssignmentPattern",delete t.operator;case"AssignmentPattern":"YieldExpression"===t.right.type&&this.raise(t.right.start,"Yield expression cannot be a default value");break;case"ParenthesizedExpression":t.expression=this.toAssignable(t.expression,e);break;case"MemberExpression":if(!e)break;default:this.raise(t.start,"Assigning to rvalue")}return t},o.toAssignableList=function(t,e){var r=t.length;if(r){var n=t[r-1];if(n&&"RestElement"==n.type)--r;else if(n&&"SpreadElement"==n.type){n.type="RestElement";var i=n.argument;this.toAssignable(i,e),"Identifier"!==i.type&&"MemberExpression"!==i.type&&"ArrayPattern"!==i.type&&this.unexpected(i.start),--r}e&&"RestElement"===n.type&&"Identifier"!==n.argument.type&&this.unexpected(n.argument.start)}for(var s=0;s<r;s++){var o=t[s];o&&this.toAssignable(o,e)}return t},o.parseSpread=function(t){var e=this.startNode();return this.next(),e.argument=this.parseMaybeAssign(t),this.finishNode(e,"SpreadElement")},o.parseRest=function(t){var e=this.startNode();return this.next(),t?e.argument=this.type===n.types.name?this.parseIdent():this.unexpected():e.argument=this.type===n.types.name||this.type===n.types.bracketL?this.parseBindingAtom():this.unexpected(),this.finishNode(e,"RestElement")},o.parseBindingAtom=function(){if(this.options.ecmaVersion<6)return this.parseIdent();switch(this.type){case n.types.name:return this.parseIdent();case n.types.bracketL:var t=this.startNode();return this.next(),t.elements=this.parseBindingList(n.types.bracketR,!0,!0),this.finishNode(t,"ArrayPattern");case n.types.braceL:return this.parseObj(!0);default:this.unexpected()}},o.parseBindingList=function(t,e,r,i){for(var s=[],o=!0;!this.eat(t);)if(o?o=!1:this.expect(n.types.comma),e&&this.type===n.types.comma)s.push(null);else{if(r&&this.afterTrailingComma(t))break;if(this.type===n.types.ellipsis){var a=this.parseRest(i);this.parseBindingListItem(a),s.push(a),this.expect(t);break}var u=this.parseMaybeDefault(this.start,this.startLoc);this.parseBindingListItem(u),s.push(u)}return s},o.parseBindingListItem=function(t){return t},o.parseMaybeDefault=function(t,e,r){if(r=r||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(n.types.eq))return r;var i=this.startNodeAt(t,e);return i.left=r,i.right=this.parseMaybeAssign(),this.finishNode(i,"AssignmentPattern")},o.checkLVal=function(t,e,r){switch(t.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(t.name)&&this.raise(t.start,(e?"Binding ":"Assigning to ")+t.name+" in strict mode"),r&&(s.has(r,t.name)&&this.raise(t.start,"Argument name clash"),r[t.name]=!0);break;case"MemberExpression":e&&this.raise(t.start,(e?"Binding":"Assigning to")+" member expression");break;case"ObjectPattern":for(var n=0;n<t.properties.length;n++)this.checkLVal(t.properties[n].value,e,r);break;case"ArrayPattern":for(var n=0;n<t.elements.length;n++){var i=t.elements[n];i&&this.checkLVal(i,e,r)}break;case"AssignmentPattern":this.checkLVal(t.left,e,r);break;case"RestElement":this.checkLVal(t.argument,e,r);break;case"ParenthesizedExpression":this.checkLVal(t.expression,e,r);break;default:this.raise(t.start,(e?"Binding":"Assigning to")+" rvalue")}}},{"./state":10,"./tokentype":14,"./util":15}],7:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e,r,n){return t.type=e,t.end=r,this.options.locations&&(t.loc.end=n),this.options.ranges&&(t.range[1]=r),t}r.__esModule=!0;var s=t("./state"),o=t("./locutil"),a=function h(t,e,r){n(this,h),this.type="",this.start=e,this.end=0,t.options.locations&&(this.loc=new o.SourceLocation(t,r)),t.options.directSourceFile&&(this.sourceFile=t.options.directSourceFile),t.options.ranges&&(this.range=[e,0])};r.Node=a;var u=s.Parser.prototype;u.startNode=function(){return new a(this,this.start,this.startLoc)},u.startNodeAt=function(t,e){return new a(this,t,e)},u.finishNode=function(t,e){return i.call(this,t,e,this.lastTokEnd,this.lastTokEndLoc)},u.finishNodeAt=function(t,e,r,n){return i.call(this,t,e,r,n)}},{"./locutil":5,"./state":10}],8:[function(t,e,r){"use strict";function n(t){var e={};for(var r in a)e[r]=t&&s.has(t,r)?t[r]:a[r];return null==e.allowReserved&&(e.allowReserved=e.ecmaVersion<5),s.isArray(e.onToken)&&!function(){var t=e.onToken;e.onToken=function(e){return t.push(e)}}(),s.isArray(e.onComment)&&(e.onComment=i(e,e.onComment)),e}function i(t,e){return function(r,n,i,s,a,u){var h={type:r?"Block":"Line",value:n,start:i,end:s};t.locations&&(h.loc=new o.SourceLocation(this,a,u)),t.ranges&&(h.range=[i,s]),e.push(h)}}r.__esModule=!0,r.getOptions=n;var s=t("./util"),o=t("./locutil"),a={ecmaVersion:5,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowHashBang:!1,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1,plugins:{}};r.defaultOptions=a},{"./locutil":5,"./util":15}],9:[function(t,e,r){"use strict";var n=t("./tokentype"),i=t("./state"),s=t("./whitespace"),o=i.Parser.prototype;o.isUseStrict=function(t){return this.options.ecmaVersion>=5&&"ExpressionStatement"===t.type&&"Literal"===t.expression.type&&"use strict"===t.expression.raw.slice(1,-1)},o.eat=function(t){return this.type===t&&(this.next(),!0)},o.isContextual=function(t){return this.type===n.types.name&&this.value===t},o.eatContextual=function(t){return this.value===t&&this.eat(n.types.name)},o.expectContextual=function(t){this.eatContextual(t)||this.unexpected()},o.canInsertSemicolon=function(){return this.type===n.types.eof||this.type===n.types.braceR||s.lineBreak.test(this.input.slice(this.lastTokEnd,this.start))},o.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},o.semicolon=function(){this.eat(n.types.semi)||this.insertSemicolon()||this.unexpected()},o.afterTrailingComma=function(t){if(this.type==t)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),this.next(),!0},o.expect=function(t){this.eat(t)||this.unexpected()},o.unexpected=function(t){this.raise(null!=t?t:this.start,"Unexpected token")},o.checkPatternErrors=function(t,e){var r=t&&t.trailingComma;return e?void(r&&this.raise(r,"Trailing comma is not permitted in destructuring patterns")):!!r},o.checkExpressionErrors=function(t,e){var r=t&&t.shorthandAssign;return e?void(r&&this.raise(r,"Shorthand property assignments are valid only in destructuring patterns")):!!r}},{"./state":10,"./tokentype":14,"./whitespace":16}],10:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t){return new RegExp("^("+t.replace(/ /g,"|")+")$")}r.__esModule=!0;var s=t("./identifier"),o=t("./tokentype"),a=t("./whitespace"),u=t("./options"),h={};r.plugins=h;var p=function(){function t(e,r,h){n(this,t),this.options=e=u.getOptions(e),this.sourceFile=e.sourceFile,this.keywords=i(s.keywords[e.ecmaVersion>=6?6:5]);var p=e.allowReserved?"":s.reservedWords[e.ecmaVersion]+("module"==e.sourceType?" await":"");this.reservedWords=i(p);var l=(p?p+" ":"")+s.reservedWords.strict;this.reservedWordsStrict=i(l),this.reservedWordsStrictBind=i(l+" "+s.reservedWords.strictBind),this.input=String(r),this.containsEsc=!1,this.loadPlugins(e.plugins),h?(this.pos=h,this.lineStart=Math.max(0,this.input.lastIndexOf("\n",h)),this.curLine=this.input.slice(0,this.lineStart).split(a.lineBreak).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=o.types.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.strict=this.inModule="module"===e.sourceType,this.potentialArrowAt=-1,this.inFunction=this.inGenerator=!1,this.labels=[],0===this.pos&&e.allowHashBang&&"#!"===this.input.slice(0,2)&&this.skipLineComment(2)}return t.prototype.isKeyword=function(t){return this.keywords.test(t)},t.prototype.isReservedWord=function(t){return this.reservedWords.test(t)},t.prototype.extend=function(t,e){this[t]=e(this[t])},t.prototype.loadPlugins=function(t){for(var e in t){var r=h[e];if(!r)throw new Error("Plugin '"+e+"' not found");r(this,t[e])}},t.prototype.parse=function(){var t=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(t)},t}();r.Parser=p},{"./identifier":2,"./options":8,"./tokentype":14,"./whitespace":16}],11:[function(t,e,r){"use strict";var n=t("./tokentype"),i=t("./state"),s=t("./whitespace"),o=i.Parser.prototype;o.parseTopLevel=function(t){var e=!0;for(t.body||(t.body=[]);this.type!==n.types.eof;){var r=this.parseStatement(!0,!0);t.body.push(r),e&&(this.isUseStrict(r)&&this.setStrict(!0),e=!1)}return this.next(),this.options.ecmaVersion>=6&&(t.sourceType=this.options.sourceType),this.finishNode(t,"Program")};var a={kind:"loop"},u={kind:"switch"};o.parseStatement=function(t,e){var r=this.type,i=this.startNode();switch(r){case n.types._break:case n.types._continue:return this.parseBreakContinueStatement(i,r.keyword);case n.types._debugger:return this.parseDebuggerStatement(i);case n.types._do:return this.parseDoStatement(i);case n.types._for:return this.parseForStatement(i);case n.types._function:return!t&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(i);case n.types._class:return t||this.unexpected(),this.parseClass(i,!0);case n.types._if:return this.parseIfStatement(i);case n.types._return:return this.parseReturnStatement(i);case n.types._switch:return this.parseSwitchStatement(i);case n.types._throw:return this.parseThrowStatement(i);case n.types._try:return this.parseTryStatement(i);case n.types._let:case n.types._const:t||this.unexpected();case n.types._var:return this.parseVarStatement(i,r);case n.types._while:return this.parseWhileStatement(i);case n.types._with:return this.parseWithStatement(i);case n.types.braceL:return this.parseBlock();case n.types.semi:return this.parseEmptyStatement(i);case n.types._export:case n.types._import:return this.options.allowImportExportEverywhere||(e||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),r===n.types._import?this.parseImport(i):this.parseExport(i);default:var s=this.value,o=this.parseExpression();return r===n.types.name&&"Identifier"===o.type&&this.eat(n.types.colon)?this.parseLabeledStatement(i,s,o):this.parseExpressionStatement(i,o)}},o.parseBreakContinueStatement=function(t,e){var r="break"==e;this.next(),this.eat(n.types.semi)||this.insertSemicolon()?t.label=null:this.type!==n.types.name?this.unexpected():(t.label=this.parseIdent(),this.semicolon());for(var i=0;i<this.labels.length;++i){var s=this.labels[i];if(null==t.label||s.name===t.label.name){if(null!=s.kind&&(r||"loop"===s.kind))break;if(t.label&&r)break}}return i===this.labels.length&&this.raise(t.start,"Unsyntactic "+e),this.finishNode(t,r?"BreakStatement":"ContinueStatement")},o.parseDebuggerStatement=function(t){return this.next(),this.semicolon(),this.finishNode(t,"DebuggerStatement")},o.parseDoStatement=function(t){return this.next(),this.labels.push(a),t.body=this.parseStatement(!1),this.labels.pop(),this.expect(n.types._while),t.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(n.types.semi):this.semicolon(),this.finishNode(t,"DoWhileStatement")},o.parseForStatement=function(t){if(this.next(),this.labels.push(a),this.expect(n.types.parenL),this.type===n.types.semi)return this.parseFor(t,null);if(this.type===n.types._var||this.type===n.types._let||this.type===n.types._const){var e=this.startNode(),r=this.type;return this.next(),this.parseVar(e,!0,r),this.finishNode(e,"VariableDeclaration"),!(this.type===n.types._in||this.options.ecmaVersion>=6&&this.isContextual("of"))||1!==e.declarations.length||r!==n.types._var&&e.declarations[0].init?this.parseFor(t,e):this.parseForIn(t,e)}var i={shorthandAssign:0,trailingComma:0},s=this.parseExpression(!0,i);return this.type===n.types._in||this.options.ecmaVersion>=6&&this.isContextual("of")?(this.checkPatternErrors(i,!0),this.toAssignable(s),this.checkLVal(s),this.parseForIn(t,s)):(this.checkExpressionErrors(i,!0),this.parseFor(t,s))},o.parseFunctionStatement=function(t){return this.next(),this.parseFunction(t,!0)},o.parseIfStatement=function(t){return this.next(),t.test=this.parseParenExpression(),t.consequent=this.parseStatement(!1),t.alternate=this.eat(n.types._else)?this.parseStatement(!1):null,this.finishNode(t,"IfStatement")},o.parseReturnStatement=function(t){return this.inFunction||this.options.allowReturnOutsideFunction||this.raise(this.start,"'return' outside of function"),this.next(),this.eat(n.types.semi)||this.insertSemicolon()?t.argument=null:(t.argument=this.parseExpression(),this.semicolon()),this.finishNode(t,"ReturnStatement")},o.parseSwitchStatement=function(t){this.next(),t.discriminant=this.parseParenExpression(),t.cases=[],this.expect(n.types.braceL),this.labels.push(u);for(var e,r=!1;this.type!=n.types.braceR;)if(this.type===n.types._case||this.type===n.types._default){var i=this.type===n.types._case;e&&this.finishNode(e,"SwitchCase"),t.cases.push(e=this.startNode()),e.consequent=[],this.next(),i?e.test=this.parseExpression():(r&&this.raise(this.lastTokStart,"Multiple default clauses"),r=!0,e.test=null),this.expect(n.types.colon)}else e||this.unexpected(),e.consequent.push(this.parseStatement(!0));return e&&this.finishNode(e,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(t,"SwitchStatement")},o.parseThrowStatement=function(t){return this.next(),s.lineBreak.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),t.argument=this.parseExpression(),this.semicolon(),this.finishNode(t,"ThrowStatement")};var h=[];o.parseTryStatement=function(t){if(this.next(),t.block=this.parseBlock(),t.handler=null,this.type===n.types._catch){var e=this.startNode();this.next(),this.expect(n.types.parenL),e.param=this.parseBindingAtom(),this.checkLVal(e.param,!0),this.expect(n.types.parenR),e.body=this.parseBlock(),t.handler=this.finishNode(e,"CatchClause")}return t.finalizer=this.eat(n.types._finally)?this.parseBlock():null,t.handler||t.finalizer||this.raise(t.start,"Missing catch or finally clause"),this.finishNode(t,"TryStatement")},o.parseVarStatement=function(t,e){return this.next(),this.parseVar(t,!1,e),this.semicolon(),this.finishNode(t,"VariableDeclaration")},o.parseWhileStatement=function(t){return this.next(),t.test=this.parseParenExpression(),this.labels.push(a),t.body=this.parseStatement(!1),this.labels.pop(),this.finishNode(t,"WhileStatement")},o.parseWithStatement=function(t){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),t.object=this.parseParenExpression(),t.body=this.parseStatement(!1),this.finishNode(t,"WithStatement")},o.parseEmptyStatement=function(t){return this.next(),this.finishNode(t,"EmptyStatement")},o.parseLabeledStatement=function(t,e,r){for(var i=0;i<this.labels.length;++i)this.labels[i].name===e&&this.raise(r.start,"Label '"+e+"' is already declared");for(var s=this.type.isLoop?"loop":this.type===n.types._switch?"switch":null,i=this.labels.length-1;i>=0;i--){var o=this.labels[i];if(o.statementStart!=t.start)break;o.statementStart=this.start,o.kind=s}return this.labels.push({name:e,kind:s,statementStart:this.start}),t.body=this.parseStatement(!0),this.labels.pop(),t.label=r,this.finishNode(t,"LabeledStatement")},o.parseExpressionStatement=function(t,e){return t.expression=e,this.semicolon(),this.finishNode(t,"ExpressionStatement")},o.parseBlock=function(t){var e=this.startNode(),r=!0,i=void 0;for(e.body=[],this.expect(n.types.braceL);!this.eat(n.types.braceR);){var s=this.parseStatement(!0);e.body.push(s),r&&t&&this.isUseStrict(s)&&(i=this.strict,this.setStrict(this.strict=!0)),r=!1}return i===!1&&this.setStrict(!1),this.finishNode(e,"BlockStatement")},o.parseFor=function(t,e){return t.init=e,this.expect(n.types.semi),t.test=this.type===n.types.semi?null:this.parseExpression(),this.expect(n.types.semi),t.update=this.type===n.types.parenR?null:this.parseExpression(),this.expect(n.types.parenR),t.body=this.parseStatement(!1),this.labels.pop(),this.finishNode(t,"ForStatement")},o.parseForIn=function(t,e){var r=this.type===n.types._in?"ForInStatement":"ForOfStatement";return this.next(),t.left=e,t.right=this.parseExpression(),this.expect(n.types.parenR),t.body=this.parseStatement(!1),this.labels.pop(),this.finishNode(t,r)},o.parseVar=function(t,e,r){for(t.declarations=[],t.kind=r.keyword;;){var i=this.startNode();if(this.parseVarId(i),this.eat(n.types.eq)?i.init=this.parseMaybeAssign(e):r!==n.types._const||this.type===n.types._in||this.options.ecmaVersion>=6&&this.isContextual("of")?"Identifier"==i.id.type||e&&(this.type===n.types._in||this.isContextual("of"))?i.init=null:this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):this.unexpected(),t.declarations.push(this.finishNode(i,"VariableDeclarator")),!this.eat(n.types.comma))break}return t},o.parseVarId=function(t){t.id=this.parseBindingAtom(),this.checkLVal(t.id,!0)},o.parseFunction=function(t,e,r){return this.initFunction(t),this.options.ecmaVersion>=6&&(t.generator=this.eat(n.types.star)),(e||this.type===n.types.name)&&(t.id=this.parseIdent()),this.parseFunctionParams(t),this.parseFunctionBody(t,r),this.finishNode(t,e?"FunctionDeclaration":"FunctionExpression")},o.parseFunctionParams=function(t){this.expect(n.types.parenL),t.params=this.parseBindingList(n.types.parenR,!1,!1,!0)},o.parseClass=function(t,e){this.next(),this.parseClassId(t,e),this.parseClassSuper(t);var r=this.startNode(),i=!1;for(r.body=[],this.expect(n.types.braceL);!this.eat(n.types.braceR);)if(!this.eat(n.types.semi)){var s=this.startNode(),o=this.eat(n.types.star),a=this.type===n.types.name&&"static"===this.value;this.parsePropertyName(s),s["static"]=a&&this.type!==n.types.parenL,s["static"]&&(o&&this.unexpected(),o=this.eat(n.types.star),this.parsePropertyName(s)),s.kind="method";var u=!1;if(!s.computed){var h=s.key;o||"Identifier"!==h.type||this.type===n.types.parenL||"get"!==h.name&&"set"!==h.name||(u=!0,s.kind=h.name,h=this.parsePropertyName(s)),!s["static"]&&("Identifier"===h.type&&"constructor"===h.name||"Literal"===h.type&&"constructor"===h.value)&&(i&&this.raise(h.start,"Duplicate constructor in the same class"),u&&this.raise(h.start,"Constructor can't have get/set modifier"),o&&this.raise(h.start,"Constructor can't be a generator"),s.kind="constructor",i=!0)}if(this.parseClassMethod(r,s,o),u){var p="get"===s.kind?0:1;if(s.value.params.length!==p){var l=s.value.start;"get"===s.kind?this.raise(l,"getter should have no params"):this.raise(l,"setter should have exactly one param")}"set"===s.kind&&"RestElement"===s.value.params[0].type&&this.raise(s.value.params[0].start,"Setter cannot use rest params")}}return t.body=this.finishNode(r,"ClassBody"),this.finishNode(t,e?"ClassDeclaration":"ClassExpression")},o.parseClassMethod=function(t,e,r){e.value=this.parseMethod(r),t.body.push(this.finishNode(e,"MethodDefinition"))},o.parseClassId=function(t,e){t.id=this.type===n.types.name?this.parseIdent():e?this.unexpected():null},o.parseClassSuper=function(t){t.superClass=this.eat(n.types._extends)?this.parseExprSubscripts():null},o.parseExport=function(t){if(this.next(),this.eat(n.types.star))return this.expectContextual("from"),t.source=this.type===n.types.string?this.parseExprAtom():this.unexpected(),this.semicolon(),this.finishNode(t,"ExportAllDeclaration");if(this.eat(n.types._default)){var e=this.parseMaybeAssign(),r=!0;return"FunctionExpression"!=e.type&&"ClassExpression"!=e.type||(r=!1,e.id&&(e.type="FunctionExpression"==e.type?"FunctionDeclaration":"ClassDeclaration")),t.declaration=e,r&&this.semicolon(),this.finishNode(t,"ExportDefaultDeclaration")}if(this.shouldParseExportStatement())t.declaration=this.parseStatement(!0),t.specifiers=[],t.source=null;else{if(t.declaration=null,t.specifiers=this.parseExportSpecifiers(),this.eatContextual("from"))t.source=this.type===n.types.string?this.parseExprAtom():this.unexpected();else{for(var i=0;i<t.specifiers.length;i++)(this.keywords.test(t.specifiers[i].local.name)||this.reservedWords.test(t.specifiers[i].local.name))&&this.unexpected(t.specifiers[i].local.start);t.source=null}this.semicolon()}return this.finishNode(t,"ExportNamedDeclaration")},o.shouldParseExportStatement=function(){return this.type.keyword},o.parseExportSpecifiers=function(){var t=[],e=!0;for(this.expect(n.types.braceL);!this.eat(n.types.braceR);){if(e)e=!1;else if(this.expect(n.types.comma),this.afterTrailingComma(n.types.braceR))break;var r=this.startNode();r.local=this.parseIdent(this.type===n.types._default),r.exported=this.eatContextual("as")?this.parseIdent(!0):r.local,t.push(this.finishNode(r,"ExportSpecifier"))}return t},o.parseImport=function(t){return this.next(),this.type===n.types.string?(t.specifiers=h,t.source=this.parseExprAtom()):(t.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),t.source=this.type===n.types.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(t,"ImportDeclaration")},o.parseImportSpecifiers=function(){var t=[],e=!0;if(this.type===n.types.name){var r=this.startNode();if(r.local=this.parseIdent(),this.checkLVal(r.local,!0),t.push(this.finishNode(r,"ImportDefaultSpecifier")),!this.eat(n.types.comma))return t}if(this.type===n.types.star){var r=this.startNode();return this.next(),this.expectContextual("as"),r.local=this.parseIdent(),this.checkLVal(r.local,!0),t.push(this.finishNode(r,"ImportNamespaceSpecifier")),t}for(this.expect(n.types.braceL);!this.eat(n.types.braceR);){if(e)e=!1;else if(this.expect(n.types.comma),this.afterTrailingComma(n.types.braceR))break;var r=this.startNode();r.imported=this.parseIdent(!0),this.eatContextual("as")?r.local=this.parseIdent():(r.local=r.imported,this.isKeyword(r.local.name)&&this.unexpected(r.local.start),this.reservedWordsStrict.test(r.local.name)&&this.raise(r.local.start,"The keyword '"+r.local.name+"' is reserved")),this.checkLVal(r.local,!0),t.push(this.finishNode(r,"ImportSpecifier"))}return t}},{"./state":10,"./tokentype":14,"./whitespace":16}],12:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}r.__esModule=!0;var i=t("./state"),s=t("./tokentype"),o=t("./whitespace"),a=function p(t,e,r,i){n(this,p),this.token=t,this.isExpr=!!e,this.preserveSpace=!!r,this.override=i};r.TokContext=a;var u={b_stat:new a("{",(!1)),b_expr:new a("{",(!0)),b_tmpl:new a("${",(!0)),p_stat:new a("(",(!1)),p_expr:new a("(",(!0)),q_tmpl:new a("`",(!0),(!0),function(t){return t.readTmplToken()}),f_expr:new a("function",(!0))};r.types=u;var h=i.Parser.prototype;h.initialContext=function(){return[u.b_stat]},h.braceIsBlock=function(t){if(t===s.types.colon){var e=this.curContext();if(e===u.b_stat||e===u.b_expr)return!e.isExpr}return t===s.types._return?o.lineBreak.test(this.input.slice(this.lastTokEnd,this.start)):t===s.types._else||t===s.types.semi||t===s.types.eof||t===s.types.parenR||(t==s.types.braceL?this.curContext()===u.b_stat:!this.exprAllowed)},h.updateContext=function(t){var e=void 0,r=this.type;r.keyword&&t==s.types.dot?this.exprAllowed=!1:(e=r.updateContext)?e.call(this,t):this.exprAllowed=r.beforeExpr},s.types.parenR.updateContext=s.types.braceR.updateContext=function(){if(1==this.context.length)return void(this.exprAllowed=!0);var t=this.context.pop();t===u.b_stat&&this.curContext()===u.f_expr?(this.context.pop(),this.exprAllowed=!1):t===u.b_tmpl?this.exprAllowed=!0:this.exprAllowed=!t.isExpr},s.types.braceL.updateContext=function(t){this.context.push(this.braceIsBlock(t)?u.b_stat:u.b_expr),this.exprAllowed=!0},s.types.dollarBraceL.updateContext=function(){this.context.push(u.b_tmpl),this.exprAllowed=!0},s.types.parenL.updateContext=function(t){var e=t===s.types._if||t===s.types._for||t===s.types._with||t===s.types._while;this.context.push(e?u.p_stat:u.p_expr),this.exprAllowed=!0},s.types.incDec.updateContext=function(){},s.types._function.updateContext=function(){this.curContext()!==u.b_stat&&this.context.push(u.f_expr),this.exprAllowed=!1},s.types.backQuote.updateContext=function(){this.curContext()===u.q_tmpl?this.context.pop():this.context.push(u.q_tmpl),this.exprAllowed=!1}},{"./state":10,"./tokentype":14,"./whitespace":16}],13:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e,r,n){try{return new RegExp(t,e)}catch(i){if(void 0!==r)throw i instanceof SyntaxError&&n.raise(r,"Error parsing regular expression: "+i.message),i}}function s(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode((t>>10)+55296,(1023&t)+56320))}r.__esModule=!0;var o=t("./identifier"),a=t("./tokentype"),u=t("./state"),h=t("./locutil"),p=t("./whitespace"),l=function g(t){n(this,g),this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,t.options.locations&&(this.loc=new h.SourceLocation(t,t.startLoc,t.endLoc)),t.options.ranges&&(this.range=[t.start,t.end])};r.Token=l;var c=u.Parser.prototype,d="object"==typeof Packages&&"[object JavaPackage]"==Object.prototype.toString.call(Packages);c.next=function(){this.options.onToken&&this.options.onToken(new l(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},c.getToken=function(){return this.next(),new l(this)},"undefined"!=typeof Symbol&&(c[Symbol.iterator]=function(){var t=this;return{next:function(){var e=t.getToken();return{done:e.type===a.types.eof,value:e}}}}),c.setStrict=function(t){if(this.strict=t,this.type===a.types.num||this.type===a.types.string){if(this.pos=this.start,this.options.locations)for(;this.pos<this.lineStart;)this.lineStart=this.input.lastIndexOf("\n",this.lineStart-2)+1,--this.curLine;this.nextToken()}},c.curContext=function(){return this.context[this.context.length-1]},c.nextToken=function(){var t=this.curContext();return t&&t.preserveSpace||this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length?this.finishToken(a.types.eof):t.override?t.override(this):void this.readToken(this.fullCharCodeAtPos())},c.readToken=function(t){return o.isIdentifierStart(t,this.options.ecmaVersion>=6)||92===t?this.readWord():this.getTokenFromCode(t)},c.fullCharCodeAtPos=function(){var t=this.input.charCodeAt(this.pos);if(t<=55295||t>=57344)return t;var e=this.input.charCodeAt(this.pos+1);return(t<<10)+e-56613888},c.skipBlockComment=function(){var t=this.options.onComment&&this.curPosition(),e=this.pos,r=this.input.indexOf("*/",this.pos+=2);if(r===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=r+2,this.options.locations){p.lineBreakG.lastIndex=e;for(var n=void 0;(n=p.lineBreakG.exec(this.input))&&n.index<this.pos;)++this.curLine,this.lineStart=n.index+n[0].length}this.options.onComment&&this.options.onComment(!0,this.input.slice(e+2,r),e,this.pos,t,this.curPosition())},c.skipLineComment=function(t){for(var e=this.pos,r=this.options.onComment&&this.curPosition(),n=this.input.charCodeAt(this.pos+=t);this.pos<this.input.length&&10!==n&&13!==n&&8232!==n&&8233!==n;)++this.pos,n=this.input.charCodeAt(this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(e+t,this.pos),e,this.pos,r,this.curPosition())},c.skipSpace=function(){t:for(;this.pos<this.input.length;){var t=this.input.charCodeAt(this.pos);
switch(t){case 32:case 160:++this.pos;break;case 13:10===this.input.charCodeAt(this.pos+1)&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break t}break;default:if(!(t>8&&t<14||t>=5760&&p.nonASCIIwhitespace.test(String.fromCharCode(t))))break t;++this.pos}}},c.finishToken=function(t,e){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var r=this.type;this.type=t,this.value=e,this.updateContext(r)},c.readToken_dot=function(){var t=this.input.charCodeAt(this.pos+1);if(t>=48&&t<=57)return this.readNumber(!0);var e=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&46===t&&46===e?(this.pos+=3,this.finishToken(a.types.ellipsis)):(++this.pos,this.finishToken(a.types.dot))},c.readToken_slash=function(){var t=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):61===t?this.finishOp(a.types.assign,2):this.finishOp(a.types.slash,1)},c.readToken_mult_modulo=function(t){var e=this.input.charCodeAt(this.pos+1);return 61===e?this.finishOp(a.types.assign,2):this.finishOp(42===t?a.types.star:a.types.modulo,1)},c.readToken_pipe_amp=function(t){var e=this.input.charCodeAt(this.pos+1);return e===t?this.finishOp(124===t?a.types.logicalOR:a.types.logicalAND,2):61===e?this.finishOp(a.types.assign,2):this.finishOp(124===t?a.types.bitwiseOR:a.types.bitwiseAND,1)},c.readToken_caret=function(){var t=this.input.charCodeAt(this.pos+1);return 61===t?this.finishOp(a.types.assign,2):this.finishOp(a.types.bitwiseXOR,1)},c.readToken_plus_min=function(t){var e=this.input.charCodeAt(this.pos+1);return e===t?45==e&&62==this.input.charCodeAt(this.pos+2)&&p.lineBreak.test(this.input.slice(this.lastTokEnd,this.pos))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(a.types.incDec,2):61===e?this.finishOp(a.types.assign,2):this.finishOp(a.types.plusMin,1)},c.readToken_lt_gt=function(t){var e=this.input.charCodeAt(this.pos+1),r=1;return e===t?(r=62===t&&62===this.input.charCodeAt(this.pos+2)?3:2,61===this.input.charCodeAt(this.pos+r)?this.finishOp(a.types.assign,r+1):this.finishOp(a.types.bitShift,r)):33==e&&60==t&&45==this.input.charCodeAt(this.pos+2)&&45==this.input.charCodeAt(this.pos+3)?(this.inModule&&this.unexpected(),this.skipLineComment(4),this.skipSpace(),this.nextToken()):(61===e&&(r=61===this.input.charCodeAt(this.pos+2)?3:2),this.finishOp(a.types.relational,r))},c.readToken_eq_excl=function(t){var e=this.input.charCodeAt(this.pos+1);return 61===e?this.finishOp(a.types.equality,61===this.input.charCodeAt(this.pos+2)?3:2):61===t&&62===e&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(a.types.arrow)):this.finishOp(61===t?a.types.eq:a.types.prefix,1)},c.getTokenFromCode=function(t){switch(t){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(a.types.parenL);case 41:return++this.pos,this.finishToken(a.types.parenR);case 59:return++this.pos,this.finishToken(a.types.semi);case 44:return++this.pos,this.finishToken(a.types.comma);case 91:return++this.pos,this.finishToken(a.types.bracketL);case 93:return++this.pos,this.finishToken(a.types.bracketR);case 123:return++this.pos,this.finishToken(a.types.braceL);case 125:return++this.pos,this.finishToken(a.types.braceR);case 58:return++this.pos,this.finishToken(a.types.colon);case 63:return++this.pos,this.finishToken(a.types.question);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(a.types.backQuote);case 48:var e=this.input.charCodeAt(this.pos+1);if(120===e||88===e)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(111===e||79===e)return this.readRadixNumber(8);if(98===e||66===e)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(t);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo(t);case 124:case 38:return this.readToken_pipe_amp(t);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(t);case 60:case 62:return this.readToken_lt_gt(t);case 61:case 33:return this.readToken_eq_excl(t);case 126:return this.finishOp(a.types.prefix,1)}this.raise(this.pos,"Unexpected character '"+s(t)+"'")},c.finishOp=function(t,e){var r=this.input.slice(this.pos,this.pos+e);return this.pos+=e,this.finishToken(t,r)};var f=!!i("￿","u");c.readRegexp=function(){for(var t=this,e=void 0,r=void 0,n=this.pos;;){this.pos>=this.input.length&&this.raise(n,"Unterminated regular expression");var s=this.input.charAt(this.pos);if(p.lineBreak.test(s)&&this.raise(n,"Unterminated regular expression"),e)e=!1;else{if("["===s)r=!0;else if("]"===s&&r)r=!1;else if("/"===s&&!r)break;e="\\"===s}++this.pos}var o=this.input.slice(n,this.pos);++this.pos;var u=this.readWord1(),h=o;if(u){var l=/^[gim]*$/;this.options.ecmaVersion>=6&&(l=/^[gimuy]*$/),l.test(u)||this.raise(n,"Invalid regular expression flag"),u.indexOf("u")>=0&&!f&&(h=h.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(e,r,i){return r=Number("0x"+r),r>1114111&&t.raise(n+i+3,"Code point out of bounds"),"x"}),h=h.replace(/\\u([a-fA-F0-9]{4})|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"))}var c=null;return d||(i(h,void 0,n,this),c=i(o,u)),this.finishToken(a.types.regexp,{pattern:o,flags:u,value:c})},c.readInt=function(t,e){for(var r=this.pos,n=0,i=0,s=null==e?1/0:e;i<s;++i){var o=this.input.charCodeAt(this.pos),a=void 0;if(a=o>=97?o-97+10:o>=65?o-65+10:o>=48&&o<=57?o-48:1/0,a>=t)break;++this.pos,n=n*t+a}return this.pos===r||null!=e&&this.pos-r!==e?null:n},c.readRadixNumber=function(t){this.pos+=2;var e=this.readInt(t);return null==e&&this.raise(this.start+2,"Expected number in radix "+t),o.isIdentifierStart(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(a.types.num,e)},c.readNumber=function(t){var e=this.pos,r=!1,n=48===this.input.charCodeAt(this.pos);t||null!==this.readInt(10)||this.raise(e,"Invalid number");var i=this.input.charCodeAt(this.pos);46===i&&(++this.pos,this.readInt(10),r=!0,i=this.input.charCodeAt(this.pos)),69!==i&&101!==i||(i=this.input.charCodeAt(++this.pos),43!==i&&45!==i||++this.pos,null===this.readInt(10)&&this.raise(e,"Invalid number"),r=!0),o.isIdentifierStart(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var s=this.input.slice(e,this.pos),u=void 0;return r?u=parseFloat(s):n&&1!==s.length?/[89]/.test(s)||this.strict?this.raise(e,"Invalid number"):u=parseInt(s,8):u=parseInt(s,10),this.finishToken(a.types.num,u)},c.readCodePoint=function(){var t=this.input.charCodeAt(this.pos),e=void 0;if(123===t){this.options.ecmaVersion<6&&this.unexpected();var r=++this.pos;e=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,e>1114111&&this.raise(r,"Code point out of bounds")}else e=this.readHexChar(4);return e},c.readString=function(t){for(var e="",r=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var n=this.input.charCodeAt(this.pos);if(n===t)break;92===n?(e+=this.input.slice(r,this.pos),e+=this.readEscapedChar(!1),r=this.pos):(p.isNewLine(n)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return e+=this.input.slice(r,this.pos++),this.finishToken(a.types.string,e)},c.readTmplToken=function(){for(var t="",e=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var r=this.input.charCodeAt(this.pos);if(96===r||36===r&&123===this.input.charCodeAt(this.pos+1))return this.pos===this.start&&this.type===a.types.template?36===r?(this.pos+=2,this.finishToken(a.types.dollarBraceL)):(++this.pos,this.finishToken(a.types.backQuote)):(t+=this.input.slice(e,this.pos),this.finishToken(a.types.template,t));if(92===r)t+=this.input.slice(e,this.pos),t+=this.readEscapedChar(!0),e=this.pos;else if(p.isNewLine(r)){switch(t+=this.input.slice(e,this.pos),++this.pos,r){case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:t+="\n";break;default:t+=String.fromCharCode(r)}this.options.locations&&(++this.curLine,this.lineStart=this.pos),e=this.pos}else++this.pos}},c.readEscapedChar=function(t){var e=this.input.charCodeAt(++this.pos);switch(++this.pos,e){case 110:return"\n";case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return s(this.readCodePoint());case 116:return"\t";case 98:return"\b";case 118:return"\x0B";case 102:return"\f";case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";default:if(e>=48&&e<=55){var r=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],n=parseInt(r,8);return n>255&&(r=r.slice(0,-1),n=parseInt(r,8)),"0"!==r&&(this.strict||t)&&this.raise(this.pos-2,"Octal literal in strict mode"),this.pos+=r.length-1,String.fromCharCode(n)}return String.fromCharCode(e)}},c.readHexChar=function(t){var e=this.pos,r=this.readInt(16,t);return null===r&&this.raise(e,"Bad character escape sequence"),r},c.readWord1=function(){this.containsEsc=!1;for(var t="",e=!0,r=this.pos,n=this.options.ecmaVersion>=6;this.pos<this.input.length;){var i=this.fullCharCodeAtPos();if(o.isIdentifierChar(i,n))this.pos+=i<=65535?1:2;else{if(92!==i)break;this.containsEsc=!0,t+=this.input.slice(r,this.pos);var a=this.pos;117!=this.input.charCodeAt(++this.pos)&&this.raise(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var u=this.readCodePoint();(e?o.isIdentifierStart:o.isIdentifierChar)(u,n)||this.raise(a,"Invalid Unicode escape"),t+=s(u),r=this.pos}e=!1}return t+this.input.slice(r,this.pos)},c.readWord=function(){var t=this.readWord1(),e=a.types.name;return(this.options.ecmaVersion>=6||!this.containsEsc)&&this.keywords.test(t)&&(e=a.keywords[t]),this.finishToken(e,t)}},{"./identifier":2,"./locutil":5,"./state":10,"./tokentype":14,"./whitespace":16}],14:[function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){return new o(t,{beforeExpr:!0,binop:e})}function s(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];e.keyword=t,p[t]=h["_"+t]=new o(t,e)}r.__esModule=!0;var o=function l(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];n(this,l),this.label=t,this.keyword=e.keyword,this.beforeExpr=!!e.beforeExpr,this.startsExpr=!!e.startsExpr,this.isLoop=!!e.isLoop,this.isAssign=!!e.isAssign,this.prefix=!!e.prefix,this.postfix=!!e.postfix,this.binop=e.binop||null,this.updateContext=null};r.TokenType=o;var a={beforeExpr:!0},u={startsExpr:!0},h={num:new o("num",u),regexp:new o("regexp",u),string:new o("string",u),name:new o("name",u),eof:new o("eof"),bracketL:new o("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new o("]"),braceL:new o("{",{beforeExpr:!0,startsExpr:!0}),braceR:new o("}"),parenL:new o("(",{beforeExpr:!0,startsExpr:!0}),parenR:new o(")"),comma:new o(",",a),semi:new o(";",a),colon:new o(":",a),dot:new o("."),question:new o("?",a),arrow:new o("=>",a),template:new o("template"),ellipsis:new o("...",a),backQuote:new o("`",u),dollarBraceL:new o("${",{beforeExpr:!0,startsExpr:!0}),eq:new o("=",{beforeExpr:!0,isAssign:!0}),assign:new o("_=",{beforeExpr:!0,isAssign:!0}),incDec:new o("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new o("prefix",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:i("||",1),logicalAND:i("&&",2),bitwiseOR:i("|",3),bitwiseXOR:i("^",4),bitwiseAND:i("&",5),equality:i("==/!=",6),relational:i("</>",7),bitShift:i("<</>>",8),plusMin:new o("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:i("%",10),star:i("*",10),slash:i("/",10)};r.types=h;var p={};r.keywords=p,s("break"),s("case",a),s("catch"),s("continue"),s("debugger"),s("default",a),s("do",{isLoop:!0,beforeExpr:!0}),s("else",a),s("finally"),s("for",{isLoop:!0}),s("function",u),s("if"),s("return",a),s("switch"),s("throw",a),s("try"),s("var"),s("let"),s("const"),s("while",{isLoop:!0}),s("with"),s("new",{beforeExpr:!0,startsExpr:!0}),s("this",u),s("super",u),s("class"),s("extends",a),s("export"),s("import"),s("yield",{beforeExpr:!0,startsExpr:!0}),s("null",u),s("true",u),s("false",u),s("in",{beforeExpr:!0,binop:7}),s("instanceof",{beforeExpr:!0,binop:7}),s("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),s("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),s("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},{}],15:[function(t,e,r){"use strict";function n(t){return"[object Array]"===Object.prototype.toString.call(t)}function i(t,e){return Object.prototype.hasOwnProperty.call(t,e)}r.__esModule=!0,r.isArray=n,r.has=i},{}],16:[function(t,e,r){"use strict";function n(t){return 10===t||13===t||8232===t||8233==t}r.__esModule=!0,r.isNewLine=n;var i=/\r\n?|\n|\u2028|\u2029/;r.lineBreak=i;var s=new RegExp(i.source,"g");r.lineBreakG=s;var o=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/;r.nonASCIIwhitespace=o},{}]},{},[3])(3)})},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=(r(24),r(29)),u=r(42),h=r(44);t.exports=function(t){function e(t){n(this,e);var r=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,new h,t));return r.Kernel=u,r.kernel=null,r}return s(e,t),o(e,[{key:"getMode",value:function(){return"cpu"}}]),e}(a)},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=r(32),u=r(24),h=r(43);t.exports=function(t){function e(t,r){n(this,e);var s=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));return s._fnBody=u.getFunctionBodyFromString(t),s._fn=null,s.run=null,s._canvasCtx=null,s._imageData=null,s._colorData=null,s._kernelString=null,s.thread={x:0,y:0,z:0},s.run=function(){return this.run=null,this.build.apply(this,arguments),this.run.apply(this,arguments)}.bind(s),s}return s(e,t),o(e,[{key:"validateOptions",value:function(){if(!this.output||0===this.output.length){if(1!==arguments.length)throw"Auto dimensions only supported for kernels with only one input";var t=u.getArgumentType(arguments[0]);if("Array"===t)this.output=u.getDimensions(t);else{if("Texture"!==t)throw"Auto dimensions not supported for input type: "+t;this.output=arguments[0].output}}}},{key:"build",value:function(){this.setupParams(arguments);for(var t=this.threadDim=u.clone(this.output);t.length<3;)t.push(1);if(this.graphical){var e=this.getCanvas();e.width=t[0],e.height=t[1],this._canvasCtx=e.getContext("2d"),this._imageData=this._canvasCtx.createImageData(t[0],t[1]),this._colorData=new Uint8ClampedArray(t[0]*t[1]*4)}var r=this.getKernelString();this.debug&&(console.log("Options:"),console.dir(this),console.log("Function output:"),console.log(r)),this.kernelString=r,this.run=new Function([],r).bind(this)()}},{key:"color",value:function(t,e,r,n){"undefined"==typeof n&&(n=1),t=Math.floor(255*t),e=Math.floor(255*e),r=Math.floor(255*r),n=Math.floor(255*n);var i=this.output[0],s=this.output[1],o=this.thread.x,a=s-this.thread.y-1,u=o+a*i;this._colorData[4*u+0]=t,this._colorData[4*u+1]=e,this._colorData[4*u+2]=r,this._colorData[4*u+3]=n}},{key:"getKernelString",value:function(){var t=this;if(null!==this._kernelString)return this._kernelString;for(var e=this.functionBuilder,r=this.threadDim||(this.threadDim=u.clone(this.output));r.length<3;)r.push(1);if(e.addKernel(this.fnString,{prototypeOnly:!1,constants:this.constants,output:this.output,debug:this.debug,loopMaxIterations:this.loopMaxIterations},this.paramNames,this.paramTypes),e.addFunctions(this.functions,{constants:this.constants,output:this.output}),null!==this.subKernels){this.subKernelOutputTextures=[],this.subKernelOutputVariableNames=[];for(var n=0;n<this.subKernels.length;n++){var i=this.subKernels[n];e.addSubKernel(i,{prototypeOnly:!1,constants:this.constants,output:this.output,debug:this.debug,loopMaxIterations:this.loopMaxIterations}),this.subKernelOutputVariableNames.push(i.name+"Result")}}else if(null!==this.subKernelProperties){this.subKernelOutputVariableNames=[];var s=0;for(var o in this.subKernelProperties)if(this.subKernelProperties.hasOwnProperty(o)){var a=this.subKernelProperties[o];e.addSubKernel(a),this.subKernelOutputVariableNames.push(a.name+"Result"),s++}}var h=e.getPrototypes(),p=h.shift(),l=this._kernelString="\n\t\tvar LOOP_MAX = "+this._getLoopMaxString()+";\n\t\tvar _this = this;\n  "+(null===this.subKernelOutputVariableNames?"":this.subKernelOutputVariableNames.map(function(t){return"  var "+t+" = null;\n"}).join(""))+"\n    return function ("+this.paramNames.map(function(t){return"user_"+t}).join(", ")+") {\n    var ret = new Array("+r[2]+");\n  "+(null===this.subKernelOutputVariableNames?"":this.subKernelOutputVariableNames.map(function(t){return"  "+t+"Z = new Array("+r[2]+");\n"}).join(""))+"\n    for (this.thread.z = 0; this.thread.z < "+r[2]+"; this.thread.z++) {\n      ret[this.thread.z] = new Array("+r[1]+");\n  "+(null===this.subKernelOutputVariableNames?"":this.subKernelOutputVariableNames.map(function(t){return"    "+t+"Z[this.thread.z] = new Array("+r[1]+");\n"}).join(""))+"\n      for (this.thread.y = 0; this.thread.y < "+r[1]+"; this.thread.y++) {\n        ret[this.thread.z][this.thread.y] = new Array("+r[0]+");\n  "+(null===this.subKernelOutputVariableNames?"":this.subKernelOutputVariableNames.map(function(t){return"      "+t+"Z[this.thread.z][this.thread.y] = new Array("+r[0]+");\n"}).join(""))+"\n        for (this.thread.x = 0; this.thread.x < "+r[0]+"; this.thread.x++) {\n          var kernelResult;\n          "+p+"\n          ret[this.thread.z][this.thread.y][this.thread.x] = kernelResult;\n"+(null===this.subKernelOutputVariableNames?"":this.subKernelOutputVariableNames.map(function(t){return"        "+t+"Z[this.thread.z][this.thread.y][this.thread.x] = "+t+";\n"}).join(""))+"\n          }\n        }\n      }\n      \n      if (this.graphical) {\n        this._imageData.data.set(this._colorData);\n        this._canvasCtx.putImageData(this._imageData, 0, 0);\n        return;\n      }\n      \n      if (this.output.length === 1) {\n        ret = ret[0][0];\n"+(null===this.subKernelOutputVariableNames?"":this.subKernelOutputVariableNames.map(function(t){return"    "+t+" = "+t+"Z[0][0];\n"}).join(""))+"\n      \n    } else if (this.output.length === 2) {\n      ret = ret[0];\n      "+(null===this.subKernelOutputVariableNames?"":this.subKernelOutputVariableNames.map(function(t){return"    "+t+" = "+t+"Z[0];\n"}).join(""))+"\n    }\n    \n    "+(null===this.subKernelOutputVariableNames?"return ret;\n":null!==this.subKernels?"var result = [\n        "+this.subKernelOutputVariableNames.map(function(t){return""+t}).join(",\n")+"\n      ];\n      result.result = ret;\n      return result;\n":"return {\n        result: ret,\n        "+Object.keys(this.subKernelProperties).map(function(e,r){return e+": "+t.subKernelOutputVariableNames[r]}).join(",\n")+"\n      };")+"\n    "+(h.length>0?h.join("\n"):"")+"\n    }.bind(this);";return l}},{key:"toString",value:function(){return h(this)}},{key:"precompileKernelObj",value:function(t){var e=this.threadDim||(this.threadDim=u.clone(this.output));return{threadDim:e}}},{key:"_getLoopMaxString",value:function(){return this.loopMaxIterations?" "+parseInt(this.loopMaxIterations)+";\n":" 1000;\n"}}],[{key:"compileKernel",value:function(t){for(var e=t.threadDim;e.length<3;)e.push(1)}}]),e}(a)},function(t,e,r){"use strict";var n=r(24),i=r(30);t.exports=function(t,e){return"() => {\n    "+i.toString()+";\n    const utils = {\n      allPropertiesOf: function "+n.allPropertiesOf.toString()+",\n      clone: function "+n.clone.toString()+",\n      /*splitArray: function "+n.splitArray.toString()+",\n      getArgumentType: function "+n.getArgumentType.toString()+",\n      getOutput: function "+n.getOutput.toString()+",\n      dimToTexSize: function "+n.dimToTexSize.toString()+",\n      copyFlatten: function "+n.copyFlatten.toString()+",\n      flatten: function "+n.flatten.toString()+",\n      systemEndianness: '"+n.systemEndianness()+"',\n      initWebGl: function "+n.initWebGl.toString()+",\n      isArray: function "+n.isArray.toString()+"*/\n    };\n    class "+(e||"Kernel")+" {\n      constructor() {        \n        this.argumentsLength = 0;\n        this._canvas = null;\n        this._webGl = null;\n        this.built = false;\n        this.program = null;\n        this.paramNames = "+JSON.stringify(t.paramNames)+";\n        this.paramTypes = "+JSON.stringify(t.paramTypes)+";\n        this.texSize = "+JSON.stringify(t.texSize)+";\n        this.output = "+JSON.stringify(t.output)+";\n        this._kernelString = `"+t._kernelString+"`;\n        this.output = "+JSON.stringify(t.output)+";\n\t\t    this.run = function() {\n          this.run = null;\n          this.build();\n          return this.run.apply(this, arguments);\n        }.bind(this);\n        this.thread = {\n          x: 0,\n          y: 0,\n          z: 0\n        };\n      }\n      setCanvas(canvas) { this._canvas = canvas; return this; }\n      setWebGl(webGl) { this._webGl = webGl; return this; }\n      "+t.build.toString()+"\n      run () { "+t.kernelString+" }\n      getKernelString() { return this._kernelString; }\n    };\n    return kernelRunShortcut(new Kernel());\n  };"}},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=r(37),u=r(45);t.exports=function(t){function e(){n(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.Node=u,t}return s(e,t),o(e,[{key:"polyfillStandardFunctions",value:function(){}}]),e}(a)},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=r(39),u=r(24);t.exports=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return s(e,t),o(e,[{key:"generate",value:function(){return this.debug&&console.log(this),this.functionStringArray=this.astGeneric(this.getJsAST(),[],this),this.functionString=this.functionStringArray.join("").trim(),this.functionString}},{key:"getFunctionPrototypeString",value:function(){return this.webGlFunctionPrototypeString?this.webGlFunctionPrototypeString:this.webGlFunctionPrototypeString=this.generate()}},{key:"astGeneric",value:function(t,e,r){if(null===t)throw this.astErrorOutput("NULL ast",t,r);if(Array.isArray(t)){for(var n=0;n<t.length;n++)this.astGeneric(t[n],e,r);return e}switch(t.type){case"FunctionDeclaration":return this.astFunctionDeclaration(t,e,r);case"FunctionExpression":return this.astFunctionExpression(t,e,r);case"ReturnStatement":return this.astReturnStatement(t,e,r);case"Literal":return this.astLiteral(t,e,r);case"BinaryExpression":return this.astBinaryExpression(t,e,r);case"Identifier":return this.astIdentifierExpression(t,e,r);case"AssignmentExpression":return this.astAssignmentExpression(t,e,r);case"ExpressionStatement":return this.astExpressionStatement(t,e,r);case"EmptyStatement":return this.astEmptyStatement(t,e,r);case"BlockStatement":return this.astBlockStatement(t,e,r);case"IfStatement":return this.astIfStatement(t,e,r);case"BreakStatement":return this.astBreakStatement(t,e,r);case"ContinueStatement":return this.astContinueStatement(t,e,r);case"ForStatement":return this.astForStatement(t,e,r);case"WhileStatement":return this.astWhileStatement(t,e,r);case"VariableDeclaration":return this.astVariableDeclaration(t,e,r);case"VariableDeclarator":return this.astVariableDeclarator(t,e,r);case"ThisExpression":return this.astThisExpression(t,e,r);case"SequenceExpression":return this.astSequenceExpression(t,e,r);case"UnaryExpression":return this.astUnaryExpression(t,e,r);case"UpdateExpression":return this.astUpdateExpression(t,e,r);case"LogicalExpression":return this.astLogicalExpression(t,e,r);case"MemberExpression":return this.astMemberExpression(t,e,r);case"CallExpression":return this.astCallExpression(t,e,r);case"ArrayExpression":return this.astArrayExpression(t,e,r);case"DebuggerStatement":return this.astDebuggerStatement(t,e,r)}throw this.astErrorOutput("Unknown ast type : "+t.type,t,r)}},{key:"astFunctionDeclaration",value:function(t,e,r){return this.addFunction&&this.addFunction(null,u.getAstString(this.jsFunctionString,t)),e}},{key:"astFunctionExpression",value:function(t,e,r){if(!r.isRootKernel){e.push("function"),r.kernalAst=t,e.push(" "),e.push(r.functionName),e.push("(");for(var n=0;n<r.paramNames.length;++n){var i=r.paramNames[n];n>0&&e.push(", "),e.push(" "),e.push("user_"),e.push(i)}e.push(") {\n")}for(var s=0;s<t.body.body.length;++s)this.astGeneric(t.body.body[s],e,r),e.push("\n");return r.isRootKernel||e.push("}\n"),e}},{key:"astReturnStatement",value:function(t,e,r){return r.isRootKernel?(e.push("kernelResult = "),this.astGeneric(t.argument,e,r),e.push(";")):r.isSubKernel?(e.push(r.functionName+"Result = "),this.astGeneric(t.argument,e,r),e.push(";"),e.push("return "+r.functionName+"Result;")):(e.push("return "),this.astGeneric(t.argument,e,r),e.push(";")),e}},{key:"astLiteral",value:function(t,e,r){if(isNaN(t.value))throw this.astErrorOutput("Non-numeric literal not supported : "+t.value,t,r);return e.push(t.value),e}},{key:"astBinaryExpression",value:function(t,e,r){return e.push("("),this.astGeneric(t.left,e,r),e.push(t.operator),this.astGeneric(t.right,e,r),e.push(")"),e}},{key:"astIdentifierExpression",value:function(t,e,r){if("Identifier"!==t.type)throw this.astErrorOutput("IdentifierExpression - not an Identifier",t,r);switch(t.name){case"gpu_threadX":e.push("threadId.x");break;case"gpu_threadY":e.push("threadId.y");break;case"gpu_threadZ":e.push("threadId.z");break;case"gpu_outputX":e.push("uOutputDim.x");break;case"gpu_outputY":e.push("uOutputDim.y");break;case"gpu_outputZ":e.push("uOutputDim.z");break;default:if(this.constants&&this.constants.hasOwnProperty(t.name))e.push("constants_"+t.name);else{var n=r.getUserParamName(t.name);null!==n?e.push("user_"+n):e.push("user_"+t.name)}}return e}},{key:"astForStatement",value:function(t,e,r){if("ForStatement"!==t.type)throw this.astErrorOutput("Invalid for statment",t,r);if(t.test&&"BinaryExpression"===t.test.type){if(("Identifier"===t.test.right.type||"Literal"===t.test.right.type)&&"<"===t.test.operator&&this.isIdentifierConstant(t.test.right.name)===!1){if(this.loopMaxIterations||(console.warn("Warning: loopMaxIterations is not set! Using default of 1000 which may result in unintended behavior."),console.warn("Set loopMaxIterations or use a for loop of fixed length to silence this message.")),e.push("for ("),this.astGeneric(t.init,e,r),";"!==e[e.length-1]&&e.push(";"),this.astGeneric(t.test.left,e,r),e.push(t.test.operator),e.push("LOOP_MAX"),e.push(";"),this.astGeneric(t.update,e,r),e.push(")"),e.push("{\n"),e.push("if ("),this.astGeneric(t.test.left,e,r),e.push(t.test.operator),this.astGeneric(t.test.right,e,r),e.push(") {\n"),"BlockStatement"===t.body.type)for(var n=0;n<t.body.body.length;n++)this.astGeneric(t.body.body[n],e,r);else this.astGeneric(t.body,e,r);return e.push("} else {\n"),e.push("break;\n"),e.push("}\n"),e.push("}\n"),e}if(t.init.declarations){var i=JSON.parse(JSON.stringify(t.init.declarations)),s=t.update.argument;if(!Array.isArray(i)||i.length<1)throw console.log(this.jsFunctionString),new Error("Error: Incompatible for loop declaration");if(i.length>1){for(var o=null,a=0;a<i.length;a++){var u=i[a];u.id.name===s.name?(o=u,i.splice(a,1)):(e.push("var "),this.astGeneric(u,e,r),e.push(";"))}e.push("for (let "),this.astGeneric(o,e,r),e.push(";")}else e.push("for ("),this.astGeneric(t.init,e,r);return this.astGeneric(t.test,e,r),e.push(";"),this.astGeneric(t.update,e,r),e.push(")"),this.astGeneric(t.body,e,r),e}}throw this.astErrorOutput("Invalid for statement",t,r)}},{key:"astWhileStatement",value:function(t,e,r){if("WhileStatement"!==t.type)throw this.astErrorOutput("Invalid while statment",t,r);return e.push("for (let i = 0; i < LOOP_MAX; i++) {"),e.push("if ("),this.astGeneric(t.test,e,r),e.push(") {\n"),this.astGeneric(t.body,e,r),e.push("} else {\n"),e.push("break;\n"),e.push("}\n"),e.push("}\n"),e}},{key:"astAssignmentExpression",value:function(t,e,r){return this.astGeneric(t.left,e,r),e.push(t.operator),this.astGeneric(t.right,e,r),e}},{key:"astEmptyStatement",value:function(t,e,r){return e}},{key:"astBlockStatement",value:function(t,e,r){e.push("{\n");for(var n=0;n<t.body.length;n++)this.astGeneric(t.body[n],e,r);return e.push("}\n"),e}},{key:"astExpressionStatement",value:function(t,e,r){return this.astGeneric(t.expression,e,r),e.push(";\n"),e}},{key:"astVariableDeclaration",value:function(t,e,r){e.push("var ");for(var n=0;n<t.declarations.length;n++)n>0&&e.push(","),this.astGeneric(t.declarations[n],e,r);return e.push(";"),e}},{key:"astVariableDeclarator",value:function(t,e,r){return this.astGeneric(t.id,e,r),null!==t.init&&(e.push("="),this.astGeneric(t.init,e,r)),e}},{key:"astIfStatement",value:function(t,e,r){return e.push("if ("),
this.astGeneric(t.test,e,r),e.push(")"),"BlockStatement"===t.consequent.type?this.astGeneric(t.consequent,e,r):(e.push(" {\n"),this.astGeneric(t.consequent,e,r),e.push("\n}\n")),t.alternate&&(e.push("else "),"BlockStatement"===t.alternate.type?this.astGeneric(t.alternate,e,r):(e.push(" {\n"),this.astGeneric(t.alternate,e,r),e.push("\n}\n"))),e}},{key:"astBreakStatement",value:function(t,e,r){return e.push("break;\n"),e}},{key:"astContinueStatement",value:function(t,e,r){return e.push("continue;\n"),e}},{key:"astLogicalExpression",value:function(t,e,r){return e.push("("),this.astGeneric(t.left,e,r),e.push(t.operator),this.astGeneric(t.right,e,r),e.push(")"),e}},{key:"astUpdateExpression",value:function(t,e,r){return t.prefix?(e.push(t.operator),this.astGeneric(t.argument,e,r)):(this.astGeneric(t.argument,e,r),e.push(t.operator)),e}},{key:"astUnaryExpression",value:function(t,e,r){return t.prefix?(e.push(t.operator),this.astGeneric(t.argument,e,r)):(this.astGeneric(t.argument,e,r),e.push(t.operator)),e}},{key:"astThisExpression",value:function(t,e,r){return e.push("_this"),e}},{key:"astMemberExpression",value:function(t,e,r){if(t.computed)if("Identifier"===t.object.type)this.astGeneric(t.object,e,r),e.push("["),this.astGeneric(t.property,e,r),e.push("]");else{this.astGeneric(t.object,e,r);var n=e.pop();e.push("]["),this.astGeneric(t.property,e,r),e.push(n)}else{var i=this.astMemberExpressionUnroll(t);switch("Identifier"===t.property.type&&t.computed&&(i="user_"+i),0===i.indexOf("this")&&(i="_"+i),i){case"_this.output.x":e.push(this.output[0]);break;case"_this.output.y":e.push(this.output[1]);break;case"_this.output.z":e.push(this.output[2]);break;default:e.push(i)}}return e}},{key:"astSequenceExpression",value:function(t,e,r){for(var n=0;n<t.expressions.length;n++)n>0&&e.push(","),this.astGeneric(t.expressions,e,r);return e}},{key:"astCallExpression",value:function(t,e,r){if(t.callee){var n=this.astMemberExpressionUnroll(t.callee);r.calledFunctions.indexOf(n)<0&&r.calledFunctions.push(n),r.hasOwnProperty("funcName")||(r.calledFunctionsArguments[n]=[]);var i=[];r.calledFunctionsArguments[n].push(i),e.push(n),e.push("(");for(var s=0;s<t.arguments.length;++s){var o=t.arguments[s];if(s>0&&e.push(", "),this.astGeneric(o,e,r),"Identifier"===o.type){var a=r.paramNames.indexOf(o.name);a===-1?i.push(null):i.push({name:o.name,type:r.paramTypes[a]})}else i.push(null)}return e.push(")"),e}throw this.astErrorOutput("Unknown CallExpression",t,r)}},{key:"astArrayExpression",value:function(t,e,r){var n=t.elements.length;e.push("new Float32Array(");for(var i=0;i<n;++i){i>0&&e.push(", ");var s=t.elements[i];this.astGeneric(s,e,r)}return e.push(")"),e}},{key:"astDebuggerStatement",value:function(t,e,r){return e.push("debugger;"),e}}],[{key:"astFunctionPrototype",value:function(t,e,r){if(r.isRootKernel||r.isSubKernel)return e;e.push(r.returnType),e.push(" "),e.push(r.functionName),e.push("(");for(var n=0;n<r.paramNames.length;++n)n>0&&e.push(", "),e.push(r.paramTypes[n]),e.push(" "),e.push("user_"),e.push(r.paramNames[n]);return e.push(");\n"),e}}]),e}(a)},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=r(31),u=r(24);t.exports=function(t){function e(){return n(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return s(e,t),o(e,[{key:"validateOptions",value:function(){this.texSize=u.dimToTexSize({floatTextures:this.floatTextures,floatOutput:this.floatOutput},this.output,!0)}}]),e}(a)},function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();r(25);t.exports=function(){function t(){n(this,t)}return i(t,null,[{key:"validateKernelObj",value:function(t){if(null===t)throw"KernelObj being validated is NULL";if("string"==typeof t){try{t=JSON.parse(t)}catch(e){throw console.error(e),"Failed to convert KernelObj from JSON string"}if(null===t)throw"Invalid (NULL) KernelObj JSON string representation"}if(t.isKernelObj!==!0)throw"Failed missing isKernelObj flag check";return t}},{key:"loadKernelObj",value:function(t,e){t=validateKernelObj(t)}}]),t}()},function(t,e,r){"use strict";var n=r(24);t.exports=function(t,e){var r=e.toString();return new Function("return function "+t+" ("+n.getParamNamesFromString(r).join(", ")+") {"+n.getFunctionBodyFromString(r)+"}")()}},function(t,e){"use strict";function r(){return(Math.random()+1).toString(36).substr(2,24)}function n(t,e,r){return void 0===t&&(t=0),void 0===e&&(e=1),void 0===r&&(r=!1),r?Math.floor(n(t,e,!1)):Math.random()*(e-t)+t}function i(t,e){this.v2=null;var r,n,i,s,o;if(void 0===t&&(t=0),void 0===e&&(e=1),null===this.v2){do r=Math.random(),n=Math.random(),i=2*r-1,s=2*n-1,o=i*i+s*s;while(0===o||o>=1);return this.v2=s*Math.sqrt(-2*Math.log(o)/o),e*i*Math.sqrt(-2*Math.log(o)/o)+t}return s=this.v2,this.v2=null,e*s+t}function s(t){void 0===t&&(t=1);var e,r,n=0;for(e=0;e<t;e++)r=i(),n+=r*r;return n}function o(t){void 0===t&&(t=1);var e=Math.exp(-t),r=0,n=1;do r++,n*=Math.random();while(n>e);return r-1}function a(t,e){void 0===t&&(t=0),void 0===e&&(e=1);var r,n=i();do r=i();while(0===r);return t+e*n/r}function u(t){return Math.random()<t?1:0}function h(t){return function(){var e,r,n,i;for(i=[].slice.call(arguments),e=i.shift(),r=[],n=0;n<e;n++)r.push(t.apply(this,i));return r}}function p(t,e){e=e||10;var r,n,i,s=Math.max.apply(this,t),o=Math.min.apply(this,t);if(s===o)return[t.length];for(r=[],n=0;n<e;n++)r.push(0);for(n=0;n<t.length;n++)i=(t[n]-o)/(s-o),i*=e,i=Math.floor(i),i===e&&i--,r[i]++;return r}function l(t){return t[n(0,t.length,!0)]}e.randBase36String=r,e.runif=n,e.rnorm=i,e.rchisq=s,e.rpoisson=o,e.rcauchy=a,e.rbernoulli=u,e.histogram=p,e.rlist=l;var c=h(n);e.rvunif=c;var d=h(i);e.rvnorm=d;var f=h(s);e.rvchisq=f;var g=h(o);e.rvpoisson=g;var y=h(a);e.rvcauchy=y;var v=h(u);e.rvbernoulli=v;var m=h(l);e.rvlist=m},function(t,e,r){"use strict";var n=r(49),i=r(5),s=(new i.Logger,function(){function t(t){this._graph=t}return t.prototype.randomlyDeleteNodesPercentage=function(t){t>100&&(t=100);var e=Math.ceil(this._graph.nrNodes()*t/100);this.randomlyDeleteNodesAmount(e)},t.prototype.randomlyDeleteUndEdgesPercentage=function(t){t>100&&(t=100);var e=Math.ceil(this._graph.nrUndEdges()*t/100);this.randomlyDeleteUndEdgesAmount(e)},t.prototype.randomlyDeleteDirEdgesPercentage=function(t){t>100&&(t=100);var e=Math.ceil(this._graph.nrDirEdges()*t/100);this.randomlyDeleteDirEdgesAmount(e)},t.prototype.randomlyDeleteNodesAmount=function(t){if(t<0)throw"Cowardly refusing to remove a negative amount of nodes";if(0!==this._graph.nrNodes())for(var e=0,r=this._graph.pickRandomProperties(this._graph.getNodes(),t);e<r.length;e++)this._graph.deleteNode(this._graph.getNodes()[r[e]])},t.prototype.randomlyDeleteUndEdgesAmount=function(t){if(t<0)throw"Cowardly refusing to remove a negative amount of edges";if(0!==this._graph.nrUndEdges())for(var e=0,r=this._graph.pickRandomProperties(this._graph.getUndEdges(),t);e<r.length;e++)this._graph.deleteEdge(this._graph.getUndEdges()[r[e]])},t.prototype.randomlyDeleteDirEdgesAmount=function(t){if(t<0)throw"Cowardly refusing to remove a negative amount of edges";if(0!==this._graph.nrDirEdges())for(var e=0,r=this._graph.pickRandomProperties(this._graph.getDirEdges(),t);e<r.length;e++)this._graph.deleteEdge(this._graph.getDirEdges()[r[e]])},t.prototype.randomlyAddUndEdgesPercentage=function(t){var e=Math.ceil(this._graph.nrUndEdges()*t/100);this.randomlyAddEdgesAmount(e,{directed:!1})},t.prototype.randomlyAddDirEdgesPercentage=function(t){var e=Math.ceil(this._graph.nrDirEdges()*t/100);this.randomlyAddEdgesAmount(e,{directed:!0})},t.prototype.randomlyAddEdgesAmount=function(t,e){if(t<=0)throw new Error("Cowardly refusing to add a non-positive amount of edges");for(var r,n,i=!(!e||!e.directed)&&e.directed,s=i?"_d":"_u";t;){for(r=this._graph.getRandomNode();(n=this._graph.getRandomNode())===r;);var o=r.getID()+"_"+n.getID()+s;r.hasEdgeID(o)||(this._graph.addEdgeByID(o,r,n,{directed:i}),--t)}},t.prototype.randomlyAddNodesPercentage=function(t,e){var r=Math.ceil(this._graph.nrNodes()*t/100);this.randomlyAddNodesAmount(r,e)},t.prototype.randomlyAddNodesAmount=function(t,e){if(t<0)throw"Cowardly refusing to add a negative amount of nodes";for(var r={};t--;){var i=n.randBase36String();r[i]=this._graph.addNodeByID(i)}null!=e&&this.createEdgesByConfig(e,r)},t.prototype.createEdgesByConfig=function(t,e){var r,n,i;null!=t.und_degree||null!=t.dir_degree||null!=t.min_und_degree&&null!=t.max_und_degree||null!=t.min_dir_degree&&null!=t.max_dir_degree?(null!=(r=t.und_degree)?this.createRandomEdgesSpan(r,r,!1,e):null!=(n=t.min_und_degree)&&null!=(i=t.max_und_degree)&&this.createRandomEdgesSpan(n,i,!1,e),(r=t.dir_degree)?this.createRandomEdgesSpan(r,r,!0,e):null!=(n=t.min_dir_degree)&&null!=(i=t.max_dir_degree)&&this.createRandomEdgesSpan(n,i,!0,e)):(null!=t.probability_dir&&this.createRandomEdgesProb(t.probability_dir,!0,e),null!=t.probability_und&&this.createRandomEdgesProb(t.probability_und,!1,e))},t.prototype.createRandomEdgesProb=function(t,e,r){if(0>t||1<t)throw new Error("Probability out of range.");e=e||!1,r=r||this._graph.getNodes();var n,i,s,o=this._graph.getNodes(),a=e?"_d":"_u";for(n in r)for(i in o)if(n!==i&&Math.random()<=t){if(s=o[n].getID()+"_"+o[i].getID()+a,this._graph.getNodes()[n].hasEdgeID(s))continue;this._graph.addEdgeByID(s,o[n],o[i],{directed:e})}},t.prototype.createRandomEdgesSpan=function(t,e,r,n){if(t<0)throw new Error("Minimum degree cannot be negative.");if(e>=this._graph.nrNodes())throw new Error("Maximum degree exceeds number of reachable nodes.");if(t>e)throw new Error("Minimum degree cannot exceed maximum degree.");r=r||!1;var i,s,o,a,u,h,t=0|t,e=0|e,p=n||this._graph.getNodes(),l=this._graph.getNodes(),c=Object.keys(l),d=c.length,f=r?"_d":"_u";for(i in p)for(s=p[i],u=0,h=Math.random()*(e-t)+t|0;h;)if(u=d*Math.random()|0,o=l[c[u]],s!==o){if(a=s.getID()+"_"+o.getID()+f,s.hasEdgeID(a))continue;this._graph.addEdgeByID(a,s,o,{directed:r}),--h}},t}());e.SimplePerturber=s},function(t,e,r){"use strict";var n=r(4),i=function(){function t(t,e,r,n){this._graph=t,this._source=e,this._sink=r,this._state={residGraph:null,activeNodes:{},orphans:{},treeS:{},treeT:{},parents:{},path:[],tree:{}},this._config=n||this.prepareMCMFStandardConfig(),this._config.directed&&this.renameEdges(t),this._state.residGraph=this._graph,this._config.directed||(this._state.residGraph=this.convertToDirectedGraph(this._state.residGraph),this._source=this._state.residGraph.getNodeById(this._source.getID()),this._sink=this._state.residGraph.getNodeById(this._sink.getID()))}return t.prototype.calculateCycle=function(){var t={edges:[],edgeIDs:[],cost:0};this._state.treeS[this._source.getID()]=this._source,this._state.tree[this._source.getID()]="S",this._state.treeT[this._sink.getID()]=this._sink,this._state.tree[this._sink.getID()]="T",this._state.activeNodes[this._source.getID()]=this._source,this._state.activeNodes[this._sink.getID()]=this._sink;for(var e=0;;){if(this.grow(),!this._state.path.length)break;this.augmentation(),this.adoption(),++e}console.log("computing result");for(var r=Object.keys(this._state.treeS).length<Object.keys(this._state.treeT).length?this._state.treeS:this._state.treeT,n=Object.keys(r).length,i=Object.keys(r),s=0;s<n;s++){var o=i[s],a=this._graph.getNodeById(o);if(this._config.directed){for(var u=Object.keys(a.outEdges()),h=u.length,p=Object.keys(a.inEdges()),l=p.length,c=0;c<h;c++){var d=this._graph.getEdgeById(u[c]),f=d.getNodes().b;this._state.tree[f.getID()]!=this._state.tree[a.getID()]&&(t.edges.push(d),t.edgeIDs.push(d.getID()),t.cost+=d.getWeight())}for(var g=0;g<l;g++){var d=this._graph.getEdgeById(p[g]),f=d.getNodes().a;this.tree(f)!=this.tree(a)&&(t.edges.push(d),t.edgeIDs.push(d.getID()),t.cost+=d.getWeight())}}else for(var y=a.undEdges(),v=Object.keys(y).length,m=Object.keys(y),_=0;_<v;_++){var d=y[m[_]],f=d.getNodes().a.getID()==a.getID()?d.getNodes().b:d.getNodes().a;this._state.tree[f.getID()]!=this._state.tree[a.getID()]&&(t.edges.push(d),t.edgeIDs.push(d.getID()),t.cost+=d.getWeight())}}return console.log("Cost => "+t.cost),console.log("# cycles => "+e),t},t.prototype.renameEdges=function(t){for(var e=t.getDirEdges(),r=Object.keys(e),n=r.length,i=0;i<n;i++){var s=e[r[i]],o=s.getWeight();t.deleteEdge(s);var a=s.getNodes().a,u=s.getNodes().b,h={directed:!0,weighted:!0,weight:o};t.addEdgeByID(a.getID()+"_"+u.getID(),a,u,h)}},t.prototype.convertToDirectedGraph=function(t){for(var e=new n.BaseGraph(t._label+"_directed"),r=t.getNodes(),i=Object.keys(r),s=i.length,o=0;o<s;o++){var a=r[i[o]];e.addNodeByID(a.getID())}for(var u=t.getUndEdges(),h=Object.keys(u),p=h.length,o=0;o<p;o++){var l=u[h[o]],c=l.getNodes().a.getID(),d=l.getNodes().b.getID(),f={directed:!0,weighted:!0,weight:l.getWeight()};e.addEdgeByID(c+"_"+d,e.getNodeById(c),e.getNodeById(d),f),e.addEdgeByID(d+"_"+c,e.getNodeById(d),e.getNodeById(c),f)}return e},t.prototype.tree=function(t){var e="";return t.getID()in this._state.treeS?e="S":t.getID()in this._state.treeT?e="T":e},t.prototype.getPathToRoot=function(t){var e=[],r=t.getID();e.push(this._graph.getNodeById(r));for(var n=this._sink.getID(),i=this._source.getID();r!=n&&r!=i;){if(null==this._state.parents[r])return e;r=this._state.parents[r].getID(),e.push(this._graph.getNodeById(r))}return e},t.prototype.getBottleneckCapacity=function(){for(var t=0,t=this._state.residGraph.getEdgeById(this._state.path[0].getID()+"_"+this._state.path[1].getID()).getWeight(),e=this._state.path.length-1,r=0;r<e;r++){var n=this._state.path[r],i=this._state.path[r+1],s=this._state.residGraph.getEdgeById(n.getID()+"_"+i.getID());s.getWeight()<t&&(t=s.getWeight())}return t},t.prototype.grow=function(){for(var t=Object.keys(this._state.activeNodes).length,e=Object.keys(this._state.activeNodes);t;){for(var r=this._state.activeNodes[e[0]],n="S"==this._state.tree[r.getID()]?r.outEdges():r.inEdges(),i=Object.keys(n),s=i.length,o=0;o<s;o++){var a=n[i[o]],u="S"==this._state.tree[r.getID()]?a.getNodes().b:a.getNodes().a;if(!(a.getWeight()<=0))if(this._state.tree[u.getID()]){if(this._state.tree[u.getID()]!=this._state.tree[r.getID()]){var h,p=this.getPathToRoot(u),l=this.getPathToRoot(r),c=p[p.length-1];return"S"==this._state.tree[c.getID()]?(p=p.reverse(),h=p.concat(l)):(l=l.reverse(),h=l.concat(p)),void(this._state.path=h)}}else"S"==this._state.tree[r.getID()]?(this._state.treeS[u.getID()]=u,this._state.tree[u.getID()]="S"):(this._state.treeT[u.getID()]=u,this._state.tree[u.getID()]="T"),this._state.parents[u.getID()]=r,this._state.activeNodes[u.getID()]=u,e.push(u.getID()),++t}delete this._state.activeNodes[r.getID()],e.shift(),--t}this._state.path=[]},t.prototype.augmentation=function(){for(var t=this.getBottleneckCapacity(),e=0;e<this._state.path.length-1;e++){var r=this._state.path[e],n=this._state.path[e+1],i=this._state.residGraph.getEdgeById(r.getID()+"_"+n.getID()),s=this._state.residGraph.getEdgeById(n.getID()+"_"+r.getID());this._state.residGraph.getEdgeById(i.getID()).setWeight(i.getWeight()-t),this._state.residGraph.getEdgeById(s.getID()).setWeight(s.getWeight()+t),i=this._state.residGraph.getEdgeById(i.getID()),i.getWeight()||this._state.tree[r.getID()]==this._state.tree[n.getID()]&&("S"==this._state.tree[n.getID()]&&(delete this._state.parents[n.getID()],this._state.orphans[n.getID()]=n),"T"==this._state.tree[r.getID()]&&(delete this._state.parents[r.getID()],this._state.orphans[r.getID()]=r))}},t.prototype.adoption=function(){for(var t=Object.keys(this._state.orphans),e=t.length;e;){var r=this._state.orphans[t[0]];delete this._state.orphans[r.getID()],t.shift(),--e;for(var n="S"==this._state.tree[r.getID()]?r.inEdges():r.outEdges(),i=Object.keys(n),s=i.length,o=!1,a=0;a<s;a++){var u=n[i[a]],h="S"==this._state.tree[r.getID()]?u.getNodes().a:u.getNodes().b;if(this._state.tree[r.getID()]==this._state.tree[h.getID()]&&u.getWeight()){var p=this.getPathToRoot(h),l=p[p.length-1];if(l.getID()==this._sink.getID()||l.getID()==this._source.getID()){this._state.parents[r.getID()]=h,o=!0;break}}}if(!o){for(var a=0;a<s;a++){var u=n[i[a]],h="S"==this._state.tree[r.getID()]?u.getNodes().a:u.getNodes().b;if(this._state.tree[r.getID()]==this._state.tree[h.getID()]){if(u.getWeight()&&(this._state.activeNodes[h.getID()]=h),null==this._state.parents[h.getID()])continue;this._state.parents[h.getID()].getID()==r.getID()&&(this._state.orphans[h.getID()]=h,t.push(h.getID()),++e,delete this._state.parents[h.getID()])}}var c=this._state.tree[r.getID()];"S"==c?(delete this._state.treeS[r.getID()],delete this._state.tree[r.getID()]):"T"==c&&(delete this._state.treeT[r.getID()],delete this._state.tree[r.getID()]),delete this._state.activeNodes[r.getID()]}}},t.prototype.prepareMCMFStandardConfig=function(){return{directed:!0}},t}();e.MCMFBoykov=i},function(t,e,r){"use strict";var n=r(3);!function(t){t[t["in"]=0]="in",t[t.out=1]="out",t[t.und=2]="und",t[t.dir=3]="dir",t[t.all=4]="all"}(e.DegreeMode||(e.DegreeMode={}));var i=e.DegreeMode,s=function(){function t(){}return t.prototype.getCentralityMap=function(t,e,r){e=null==e||!!e,r=null==r?i.all:r;var s={};switch(r){case i["in"]:for(var o in t.getNodes()){var a=t.getNodeById(o);if(null!=a)if(e){s[o]=s[o]||0;for(var u in a.inEdges())s[o]+=a.inEdges()[u].getWeight()}else s[o]=a.inDegree()}break;case i.out:for(var o in t.getNodes()){var a=t.getNodeById(o);if(null!=a)if(e){s[o]=s[o]||0;for(var u in a.outEdges())s[o]+=a.outEdges()[u].getWeight()}else s[o]=a.outDegree()}break;case i.und:for(var o in t.getNodes()){var a=t.getNodeById(o);if(null!=a)if(e){s[o]=s[o]||0;for(var u in a.undEdges())s[o]+=a.undEdges()[u].getWeight()}else s[o]=a.degree()}break;case i.dir:for(var o in t.getNodes()){var a=t.getNodeById(o);if(null!=a)if(e){s[o]=s[o]||0;var h=n.mergeObjects([a.inEdges(),a.outEdges()]);for(var u in h)s[o]+=h[u].getWeight()}else s[o]=a.inDegree()+a.outDegree()}break;case i.all:for(var o in t.getNodes()){var a=t.getNodeById(o);if(null!=a)if(e){s[o]=s[o]||0;var h=n.mergeObjects([a.inEdges(),a.outEdges(),a.undEdges()]);for(var u in h)s[o]+=h[u].getWeight()}else s[o]=a.degree()+a.inDegree()+a.outDegree()}}return s},t.prototype.getHistorgram=function(t){return t.degreeDistribution()},t}();e.degreeCentrality=s},function(t,e,r){"use strict";var n=r(11),i=r(21),s=function(){function t(){}return t.prototype.getCentralityMapFW=function(t){for(var e=i.FloydWarshallArray(t),r=[],n=e.length,s=0;s<n;++s){for(var o=0,a=0;a<n;++a)e[s][a]!=Number.POSITIVE_INFINITY&&(o+=e[s][a]);r[s]=1/o}return r},t.prototype.getCentralityMap=function(t){var e=n.preparePFSStandardConfig(),r=0,i=function(t){r+=t.current.best+(isNaN(t.next.edge.getWeight())?1:t.next.edge.getWeight())},s=function(t){r-=e.result[t.next.node.getID()].distance-t.better_dist},o=e.callbacks.better_path.pop();e.callbacks.better_path.push(s),e.callbacks.better_path.push(o),e.callbacks.not_encountered.push(i);var a={};for(var u in t.getNodes()){var h=t.getNodeById(u);null!=h&&(r=0,n.PFS(t,h,e),a[u]=1/r)}return a},t}();e.closenessCentrality=s},function(t,e,r){"use strict";function n(t,e){var r;r=s.FloydWarshallAPSP(t)[1];var n=t.adjListArray(),o={};for(var a in n)o[a]=0;for(var u=r.length,h=0;h<u;++h)for(var p=0;p<u;++p)h==p||1==r[h][p].length&&r[h][p][0]==p||i(h,p,r,o,h);var l=0;for(var c in o)l+=o[c];for(var d in o)o[d]/=l;return o}function i(t,e,r,n,s){if(t==e)return 1;for(var o=0,a=0;a<r[t][e].length;a++)o+=i(r[t][e][a],e,r,n,s);return t!=s&&(n[t]+=o),o}var s=r(21);e.inBetweennessCentrality=n},function(t,e,r){"use strict";var n=r(3),i=r(56),s=function(){function t(){}return t.prototype.getCentralityMap=function(t,e){var r={},s=[],o=0,a={};for(var u in t.getNodes())r[u]=0;for(var u in t.getNodes()){a[u]=o;var h=t.getNodeById(u),p=n.mergeObjects([h.inEdges(),h.undEdges()]);s[o]=new Array;for(var l in p){var c=p[l];c.getNodes().a.getID()==h.getID()?(s[o].push(c.getNodes().b.getID()),r[c.getNodes().b.getID()]++):(s[o].push(c.getNodes().a.getID()),r[c.getNodes().a.getID()]++)}s[o].push(h.getID()),o++}o=0;var d={},f=[[]];for(var u in s){f[u]=Array.apply(null,Array(t.nrNodes())).map(Number.prototype.valueOf,0);var g=s[u].pop();null==d[g]&&(d[g]=o++),f[u][d[g]]=-1;for(var y in s[u]){var v=s[u][y];null==d[v]&&(d[v]=o++),f[u][d[v]]+=1/r[v]}}f[f.length-1]=Array.apply(null,Array(t.nrNodes())).map(Number.prototype.valueOf,1);var m=Array.apply(null,Array(t.nrNodes())).map(Number.prototype.valueOf,0);m[m.length-1]=1,m=i.gauss(f,m);var _={};for(var u in a)_[u]=m[o];return m},t}();e.pageRankDetCentrality=s},function(t,e){"use strict";function r(t,e,r){for(var n=[];t<e;t++)n.push(r);return n}function n(t,e){var n,s,o;for(n=0;n<t.length;n++)t[n].push(e[n]);var a=t.length;for(n=0;n<a;n++){var u=i(t[n][n]),h=n;for(s=n+1;s<a;s++)i(t[s][n])>u&&(u=i(t[s][n]),h=s);for(s=n;s<a+1;s++){var p=t[h][s];t[h][s]=t[n][s],t[n][s]=p}for(s=n+1;s<a;s++){var l=-t[s][n]/t[n][n];for(o=n;o<a+1;o++)n===o?t[s][o]=0:t[s][o]+=l*t[n][o]}}for(e=r(0,a,0),n=a-1;n>-1;n--)for(e[n]=t[n][a]/t[n][n],s=n-1;s>-1;s--)t[s][a]-=t[s][n]*e[n];return e}var i=Math.abs;e.gauss=n},function(t,e,r){"use strict";var n=r(3),i=function(){function t(){}return t.prototype.getCentralityMap=function(t,e,r,i,s){null==r&&(r=.1),null==s&&(s=1e3),null==i&&(i=125e-6);var o={},a={},u=t.nrNodes(),h={};for(var p in t.getNodes()){p=String(p);var l=t.getNodeById(p);h[p]={},h[p].deg=l.outDegree()+l.degree(),h[p].inc=[];var c=n.mergeObjects([l.inEdges(),l.undEdges()]);for(var d in c){var f=c[d],g=f.getNodes().a;f.getNodes().a.getID()==l.getID()&&(g=f.getNodes().b),h[p].inc.push(g.getID())}}for(var p in t.getNodes())p=String(p),o[p]=1/u,a[p]=1/u;for(var y=0;y<s;y++){var v=0;for(var p in t.getNodes()){p=String(p);var m=0,_=h[p].inc;for(var b in _){var x=String(_[b]);m+=a[x]/h[x].deg}o[p]=m*(1-r)+r/u,v+=Math.abs(o[p]-a[p])}if(v<=i)return o;a=n.clone(o)}return o},t}();e.pageRankCentrality=i}]);